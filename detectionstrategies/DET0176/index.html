
<!DOCTYPE html>
<html lang='en'>

<head>
    <script src=https://cmp.osano.com/AzyhULTdPkqmy4aDN/83f786b4-d60d-4938-b70a-73afd166380a/osano.js></script>
    <style>
        .osano-cm-widget{display: none;}
    </style>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62667723-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-62667723-1');
        </script>
        <meta name="google-site-verification" content="2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ"/>

        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1,shrink-to-fit=no'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel='shortcut icon' href='/theme/favicon.ico' type='image/x-icon'>
        <title>Drive-by Compromise — Behavior-based, Multi-platform Detection Strategy (T1189), Detection Strategy DET0176 | MITRE ATT&CK&reg;</title>
        <!-- USWDS CSS -->
        <!-- Bootstrap CSS -->
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap.min.css' />
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap-tourist.css' />
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap-select.min.css' />
        <!-- Fontawesome CSS -->
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/fontawesome.min.css"/>
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/brands.min.css"/>
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/solid.min.css"/>
            <link rel="stylesheet" href="/theme/style-attack.css"/>


</head>

<body>

    <div class="container-fluid attack-website-wrapper d-flex flex-column h-100">
        <div class="row sticky-top flex-grow-0 flex-shrink-1">
            <!-- header elements -->
            <header class="col px-0">
                    <nav class='navbar navbar-expand-lg navbar-dark position-static'>
        <a class='navbar-brand' href='/'><img src="/theme/images/mitre_attack_logo.png" class="attack-logo"></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse'
                aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
                <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
            <ul class='nav nav-tabs ml-auto'>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/matrices/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Matrices</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/matrices/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/matrices/mobile/">Mobile</a>
                <a class="dropdown-item" href="/matrices/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/tactics/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Tactics</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/tactics/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/tactics/mobile/">Mobile</a>
                <a class="dropdown-item" href="/tactics/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/techniques/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Techniques</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/techniques/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/techniques/mobile/">Mobile</a>
                <a class="dropdown-item" href="/techniques/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/mitigations" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Defenses</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                
<div class="dropright dropdown">
<a class="dropdown-item dropdown-toggle" href="/mitigations/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Mitigations</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/mitigations/enterprise/">Enterprise</a>
            <a class="dropdown-item" href="/mitigations/mobile/">Mobile</a>
            <a class="dropdown-item" href="/mitigations/ics/">ICS</a>
    </div>
</div>

                <a class="dropdown-item" href="/assets">Assets</a>
                
<div class="dropright dropdown">
<a class="dropdown-item dropdown-toggle" href="/detectionstrategies/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Detections</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/detectionstrategies/">Detection Strategies</a>
            <a class="dropdown-item" href="/analytics/">Analytics</a>
            <a class="dropdown-item" href="/datacomponents">Data Components</a>
    </div>
</div>

    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/groups" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>CTI</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/groups">Groups</a>
                <a class="dropdown-item" href="/software">Software</a>
                <a class="dropdown-item" href="/campaigns">Campaigns</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/resources/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Resources</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/resources/">Get Started</a>
                <a class="dropdown-item" href="/resources/learn-more-about-attack/">Learn More about ATT&CK</a>
                <a class="dropdown-item" href="/resources/attackcon/">ATT&CKcon</a>
                <a class="dropdown-item" href="/resources/attack-data-and-tools/">ATT&CK Data & Tools</a>
                <a class="dropdown-item" href="/resources/faq/">FAQ</a>
                <a class="dropdown-item" href="/resources/engage-with-attack/contact/">Engage with ATT&CK</a>
                <a class="dropdown-item" href="/resources/versions/">Version History</a>
                <a class="dropdown-item" href="/resources/updates/">Updates</a>
                <a class="dropdown-item" href="/resources/legal-and-branding/">Legal & Branding</a>
    </div>


                        </li>
                        <li class="nav-item">
                            <a href="/resources/engage-with-attack/benefactors/"  class="nav-link" ><b>Benefactors</b></a>
                        </li>
                        <li class="nav-item">
                            <a href="/resources/engage-with-attack/contribute/"  class="nav-link" ><b>Contribute</b></a>
                        </li>
                        <li class="nav-item">
                                <a href="https://medium.com/mitre-attack/" target="_blank" class="nav-link">
        <b>Blog</b>&nbsp;
        <img src="/theme/images/external-site.svg" alt="External site" class="external-icon" />
    </a>

                        </li>
                        <li class="nav-item">
                            <button id="search-button" class="btn search-button">Search <div id="search-icon" class="icon-button search-icon"></div></button>
                        </li>
            </ul>
        </div>
    </nav>

            </header>
        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- banner elements -->
            <div class="col px-0">
                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->
                <!-- !versions banner! -->
            </div>
        </div>
        <div class="row flex-grow-1 flex-shrink-0">
            <!-- main content elements -->
            <!--start-indexing-for-search-->

 
     
    <div class="sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3" id="v-tab" role="tablist" aria-orientation="vertical">
        <div class="resizer" id="resizer"></div>
<!--stop-indexing-for-search-->
<div id="sidebars"></div>
<!--start-indexing-for-search-->
    </div>

    
     
    <div class="tab-content col-xl-9 pt-4" id="v-tabContent">
        <div class="tab-pane fade show active" id="v-attckmatrix" role="tabpanel" aria-labelledby="v-attckmatrix-tab">


<ol class="breadcrumb">
  <li class="breadcrumb-item"><a href="/">Home</a></li>
  <li class="breadcrumb-item"><a href="/detectionstrategies/">Detection Strategies</a></li>
  <li class="breadcrumb-item">Drive-by Compromise — Behavior-based, Multi-platform Detection Strategy (T1189)</li>
</ol>

<div class="tab-pane fade show active" id="v-" role="tabpanel" aria-labelledby="v--tab">
</div>

<div class="row">
  <div class="col-xl-12">
    <div class="jumbotron jumbotron-fluid">
      <div class="container-fluid">
        <h1>
          Drive-by Compromise — Behavior-based, Multi-platform Detection Strategy (T1189)
        </h1>

        <div class="row">
          <div class="col-md-8">
            <h4>
              Technique Detected:&nbsp;
              <a href="/techniques/T1189">
                Drive-by Compromise | T1189
              </a>
            </h4>
          </div>
          <div class="col-md-4">
            <div class="card">
              <div class="card-body">
                <div class="card-data"><span class="h5 card-title">ID:</span> DET0176</div>
                <div class="row card-data">
                  <div class="col-md-12">
                    <span class="h5 card-title">Domains</span>: Enterprise
                  </div>
                </div>
                <div class="row card-data">
                  <div class="col-md-12">
                    <span class="h5 card-title">Analytics</span>: AN0498, AN0499, AN0500, AN0501
                  </div>
                </div>
                <div class="row card-data">
                  <div class="col-md-12">
                    <span class="h5 card-title">Version</span>: 1.0
                  </div>
                </div>
                <div class="row card-data">
                  <div class="col-md-12">
                    <span class="h5 card-title">Created</span>: 21 October 2025
                  </div>
                </div>
                <div class="row card-data">
                  <div class="col-md-12">
                    <span class="h5 card-title">Last Modified</span>: 21 October 2025
                  </div>
                </div>
              </div>
            </div>
            <div class="text-center pt-2 version-button live">
    <div class="live">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Permalink to this version of DET0176" 
           href="/versions/v18/detectionstrategies/DET0176/" data-test-ignore="true">Version Permalink</a>
    </div>
    <div class="permalink">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Go to the live version of DET0176" 
           href="/versions/v18/detectionstrategies/DET0176/" data-test-ignore="true">Live Version</a><!--do not change this line without also changing versions.py-->
    </div>
</div>

          </div>
        </div>

        <div id="analytics-tabs">
          <h2 class="pt-3" id="analytics">Analytics</h2>
          <ul class="nav nav-tabs mb-2" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" id="tab-Windows" data-toggle="tab"
                href="#pane-Windows" role="tab" aria-selected="true">
                Windows
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link " id="tab-Linux" data-toggle="tab"
                href="#pane-Linux" role="tab" aria-selected="true">
                Linux
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link " id="tab-macOS" data-toggle="tab"
                href="#pane-macOS" role="tab" aria-selected="true">
                macOS
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link " id="tab-Identity_Provider" data-toggle="tab"
                href="#pane-Identity_Provider" role="tab" aria-selected="true">
                Identity Provider
              </a>
            </li>
          </ul>
          <div class="tab-content card card-body p-3">
            <div class="tab-pane fade show active" id="pane-Windows"
              role="tabpanel" aria-labelledby="tab-Windows">
              <h4 class="pt-3" id="AN0498">AN0498</h4>
              <div>
                        <p>Correlated evidence of anomalous browser/network behavior (suspicious external resource fetches and script injection patterns) followed by atypical child processes, ephemeral execution contexts, memory modification or process injection, and unexpected file drops. Defender sees network requests to previously unseen/suspicious domains or resources + browser process spawning unusual children or loading unsigned modules + file writes or registry changes shortly after those requests.</p>

              </div>

              <h5 class="pt-3" id="AN0498-log-sources">Log Sources</h5>
              <div class="tables-mobile">
                <table class="table table-bordered table-alternate mt-2">
                  <thead>
                    <tr>
                      <th scope="col">Data Component</th>
                      <th scope="col">Name</th>
                      <th scope="col">Channel</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0067">
                          Logon Session Creation (DC0067)
                        </a>
                      </td>
                      <td>WinEventLog:Security</td>
                      <td>EventCode=4624, 4648</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0032">
                          Process Creation (DC0032)
                        </a>
                      </td>
                      <td>WinEventLog:Security</td>
                      <td>EventCode=4688</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0082">
                          Network Connection Creation (DC0082)
                        </a>
                      </td>
                      <td>WinEventLog:Sysmon</td>
                      <td>EventCode=3, 22</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0038">
                          Application Log Content (DC0038)
                        </a>
                      </td>
                      <td>WinEventLog:Application</td>
                      <td>Browser or plugin/application logs showing script errors, plugin enumerations, or unusual extension load events</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0020">
                          Process Modification (DC0020)
                        </a>
                      </td>
                      <td>etw:Microsoft-Windows-Kernel-Process</td>
                      <td>Memory Modification / Unmapped module load or suspicious RWX allocations in the process space of a browser process</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0039">
                          File Creation (DC0039)
                        </a>
                      </td>
                      <td>WinEventLog:Sysmon</td>
                      <td>EventCode=11</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0085">
                          Network Traffic Content (DC0085)
                        </a>
                      </td>
                      <td>NSM:Flow</td>
                      <td>http.request: HTTP requests and responses for specific script resources, unexpected content-types (application/octet-stream for script URLs), suspicious referrers, or obfuscated javascript resources</td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <h5 class="pt-3" id="AN0498-mutable-elements">Mutable Elements</h5>
              <div class="tables-mobile">
                <table class="table table-bordered table-alternate mt-2">
                  <thead>
                    <tr>
                      <th scope="col">Field</th>
                      <th scope="col">Description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>TimeWindow</td>
                      <td>Correlation time window between suspicious network fetch and subsequent process/file events. Tweak for environment latency and caching; default 2 minutes.</td>
                    </tr>
                    <tr>
                      <td>KnownGoodDomainsList</td>
                      <td>Allowlist of high-volume, benign domains used by corporate sites or CDNs to reduce false positives.</td>
                    </tr>
                    <tr>
                      <td>PayloadEntropyThreshold</td>
                      <td>Entropy threshold for downloaded script/binary content to surface likely obfuscated/packed payloads.</td>
                    </tr>
                    <tr>
                      <td>UserContext</td>
                      <td>Exclude or treat differently known administrative service accounts or build machines versus end-user contexts.</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="tab-pane fade " id="pane-Linux"
              role="tabpanel" aria-labelledby="tab-Linux">
              <h4 class="pt-3" id="AN0499">AN0499</h4>
              <div>
                        <p>Correlated evidence of browser or webview fetches to uncommon domains or mutated JS resources (proxy/NGFW logs + Zeek/HTTP logs) followed by unexpected interpreters or script engines executing (python, ruby, sh) spawned from browser processes or user sessions, rapid on-disk staging in /tmp, and outbound connections that deviate from baseline. Defender sees: uncommon resource fetch → short-lived child process executions from user browser context → file writes in temp directories → anomalous outbound C2-like connections.</p>

              </div>

              <h5 class="pt-3" id="AN0499-log-sources">Log Sources</h5>
              <div class="tables-mobile">
                <table class="table table-bordered table-alternate mt-2">
                  <thead>
                    <tr>
                      <th scope="col">Data Component</th>
                      <th scope="col">Name</th>
                      <th scope="col">Channel</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0032">
                          Process Creation (DC0032)
                        </a>
                      </td>
                      <td>auditd:SYSCALL</td>
                      <td>execve: execve calls where a browser/webview process is parent and child is interpreter (python, sh, ruby) or downloader (curl, wget)</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0038">
                          Application Log Content (DC0038)
                        </a>
                      </td>
                      <td>linux:syslog</td>
                      <td>Application or browser logs (webview errors, plugin enumerations) indicating suspicious script evaluation or plugin loads</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0085">
                          Network Traffic Content (DC0085)
                        </a>
                      </td>
                      <td>NSM:Flow</td>
                      <td>http::response: HTTP responses with suspicious content-type for scripts, long obfuscated javascript bodies, or redirects to exploit kit domains</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0039">
                          File Creation (DC0039)
                        </a>
                      </td>
                      <td>linux:Sysmon</td>
                      <td>New files in /tmp, /var/tmp, $HOME/.cache, executed within TimeWindow after browser HTTP fetch</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0082">
                          Network Connection Creation (DC0082)
                        </a>
                      </td>
                      <td>NSM:Connections</td>
                      <td>Outbound connections from newly spawned child processes or from the browser to uncommon endpoints or on anomalous ports</td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <h5 class="pt-3" id="AN0499-mutable-elements">Mutable Elements</h5>
              <div class="tables-mobile">
                <table class="table table-bordered table-alternate mt-2">
                  <thead>
                    <tr>
                      <th scope="col">Field</th>
                      <th scope="col">Description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>TempPathPatterns</td>
                      <td>Paths used for staging differ by distro and package manager; tune to include company-specific temp paths or exclude known benign build machines.</td>
                    </tr>
                    <tr>
                      <td>UserShellWhitelist</td>
                      <td>Whitelist known server/service accounts or CI/CD runners where shell executions are expected.</td>
                    </tr>
                    <tr>
                      <td>DomainRarityThreshold</td>
                      <td>Threshold for flagging domains based on internal popularity vs global rarity.</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="tab-pane fade " id="pane-macOS"
              role="tabpanel" aria-labelledby="tab-macOS">
              <h4 class="pt-3" id="AN0500">AN0500</h4>
              <div>
                        <p>Correlated evidence where Safari/Chrome/WebKit-based processes issue network requests for uncommon or obfuscated JS resources followed by spawning of script interpreters, launchd or ad-hoc binaries, unusual child processes, or dynamic library loads into browser processes. Defender sees: proxy/HTTP logs with suspicious resource content + unifiedlogs/ASL showing browser/plugin crashes or extension loads + process events indicating child process creation and file writes to /var/folders or /tmp shortly after the fetch.</p>

              </div>

              <h5 class="pt-3" id="AN0500-log-sources">Log Sources</h5>
              <div class="tables-mobile">
                <table class="table table-bordered table-alternate mt-2">
                  <thead>
                    <tr>
                      <th scope="col">Data Component</th>
                      <th scope="col">Name</th>
                      <th scope="col">Channel</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0038">
                          Application Log Content (DC0038)
                        </a>
                      </td>
                      <td>macos:unifiedlog</td>
                      <td>Logs from unifiedlogging that show browser crashes, plugin enumerations, extension installs or errors around the same time as suspicious network fetches</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0032">
                          Process Creation (DC0032)
                        </a>
                      </td>
                      <td>macos:unifiedlog</td>
                      <td>process_create: Process creation where parent is Safari/Google Chrome and child is script interpreter or signed-but-unusual helper binary</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0039">
                          File Creation (DC0039)
                        </a>
                      </td>
                      <td>macos:unifiedlog</td>
                      <td>New files written to /var/folders, /tmp, ~/Library/Caches, or ~/Downloads by browser context or its children</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0085">
                          Network Traffic Content (DC0085)
                        </a>
                      </td>
                      <td>NSM:Flow</td>
                      <td>HTTP/HTTPS requests for script resources flagged by content inspection (excessive obfuscation, eval usage, unusual redirects)</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0020">
                          Process Modification (DC0020)
                        </a>
                      </td>
                      <td>macos:unifiedlog</td>
                      <td>Anomalous dyld dynamic library loads or RWX memory mappings in browser process</td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <h5 class="pt-3" id="AN0500-mutable-elements">Mutable Elements</h5>
              <div class="tables-mobile">
                <table class="table table-bordered table-alternate mt-2">
                  <thead>
                    <tr>
                      <th scope="col">Field</th>
                      <th scope="col">Description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>SleepyUserThreshold</td>
                      <td>Volume thresholds for interactive user browsing vs. automated systems (e.g., shared kiosks) — tune to reduce FP in heavy-browsing employees.</td>
                    </tr>
                    <tr>
                      <td>ExtensionInstallPolicy</td>
                      <td>Policy setting that influences how extension installs are treated: strict policy reduces FP from known extension behavior.</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="tab-pane fade " id="pane-Identity_Provider"
              role="tabpanel" aria-labelledby="tab-Identity_Provider">
              <h4 class="pt-3" id="AN0501">AN0501</h4>
              <div>
                        <p>Post-compromise identity &amp; session anomalies that follow a drive-by compromise: token reuse from new/unfamiliar IPs, anomalous sign-in patterns for previously inactive users, unexpected consent/grant events, or provisioning changes. Defender sees an endpoint/browser compromise (network + endpoint signals) followed by unusual IdP events: new refresh token issuance, consent/consent-grant events, odd MFA bypass patterns, or unusual OAuth client registrations.</p>

              </div>

              <h5 class="pt-3" id="AN0501-log-sources">Log Sources</h5>
              <div class="tables-mobile">
                <table class="table table-bordered table-alternate mt-2">
                  <thead>
                    <tr>
                      <th scope="col">Data Component</th>
                      <th scope="col">Name</th>
                      <th scope="col">Channel</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0002">
                          User Account Authentication (DC0002)
                        </a>
                      </td>
                      <td>azure:signinlogs</td>
                      <td>SignIn: Sign-ins flagged as atypical (new geographic region, unfamiliar device id) shortly after correlated endpoint/browser compromise times</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0038">
                          Application Log Content (DC0038)
                        </a>
                      </td>
                      <td>m365:unified</td>
                      <td>Application Consent grants, new OAuth client registrations, or unusual admin-level activities executed by a user account shortly after suspected drive-by compromise</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0013">
                          User Account Metadata (DC0013)
                        </a>
                      </td>
                      <td>saas:auth</td>
                      <td>Refresh token issuance or refresh token usage from new IPs or user agents</td>
                    </tr>
                    <tr>
                      <td rowspan="1">
                        <a href="/datacomponents/DC0067">
                          Logon Session Creation (DC0067)
                        </a>
                      </td>
                      <td>AWS:CloudTrail</td>
                      <td>ConsoleLogin: If IdP backed by cloud provider, Console login from new IP/agent after correlated endpoint compromise</td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <h5 class="pt-3" id="AN0501-mutable-elements">Mutable Elements</h5>
              <div class="tables-mobile">
                <table class="table table-bordered table-alternate mt-2">
                  <thead>
                    <tr>
                      <th scope="col">Field</th>
                      <th scope="col">Description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>IdpAlertWindow</td>
                      <td>Time window to correlate IdP events to endpoint compromise alerts (default 30 minutes to 2 hours).</td>
                    </tr>
                    <tr>
                      <td>HighRiskCountryList</td>
                      <td>List of countries/IP zones considered high risk for sign-ins; used to tune geo-anomalies.</td>
                    </tr>
                    <tr>
                      <td>DeviceTrustLevel</td>
                      <td>Device trust scoring thresholds that influence whether a sign-in is considered suspicious.</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        
      </div>
    </div>
  </div>
</div>

        </div>
    </div>

            <!--stop-indexing-for-search-->
            <!-- search overlay for entire page -- not displayed inline -->
            <div class="overlay search" id="search-overlay" style="display: none;">
    <div class="overlay-inner">
        <!-- text input for searching -->
        <div class="search-header">
            <div class="search-input">
                <input type="text" id="search-input" placeholder="search">
            </div>
            <div class="search-icons">
                <div class="search-parsing-icon spinner-border" style="display: none" id="search-parsing-icon"></div>
                <div class="close-search-icon" id="close-search-icon">&times;</div>
            </div>
        </div>
        <!-- results and controls for loading more results -->
        <div id="search-body" class="search-body">
            <div class="results" id="search-results">
                <!-- content will be appended here on search -->
            </div>
            <div id="load-more-results" class="load-more-results">
                <button class="btn btn-default" id="load-more-results-button">load more results</button>
            </div>
        </div>
    </div>
</div>

        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- footer elements -->
            <footer class="col footer">
                <div class="container-fluid">
                    <div class="row row-footer">
                        <div class="col-2 col-sm-2 col-md-2">
                            <div class="footer-center-responsive my-auto">
                                <a href="https://www.mitre.org" target="_blank" rel="noopener" aria-label="MITRE">
                                    <img src="/theme/images/mitrelogowhiteontrans.gif" class="mitre-logo-wtrans">
                                </a>
                            </div>
                        </div>
                        <div class="col-2 col-sm-2 footer-responsive-break"></div>
                        <div class="footer-link-group">
                            <div class="row row-footer">
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/engage-with-attack/contact" class="footer-link">Contact Us</a></u>
                                </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/legal-and-branding/terms-of-use" class="footer-link">Terms of Use</a></u>
                                </div>
                                    <div class="px-3 col-footer">
                                        <u class="footer-link"><a href="/resources/legal-and-branding/privacy" class="footer-link">Privacy Policy</a></u>
                                    </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/changelog.html" class="footer-link" data-toggle="tooltip" data-placement="top" data-html="true" title="ATT&amp;CK content v18.1&#013;Website  v4.4.1">Website Changelog</a></u>
                                </div>
                                <div class="px-3">
                                    <u class="footer-link"><a href="/resources/legal-and-branding/privacy/#" class="footer-link" onclick="Osano.cm.showDrawer('osano-cm-dom-info-dialog-open')">Cookie Preferences</a></u>
                                </div>
                            </div>
                            <div class="row">
                                <small class="px-3">
                                    &copy;&nbsp;2015&nbsp;-&nbsp;2025, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.
                                </small>
                            </div>
                        </div>
                        <div class="w-100 p-2 footer-responsive-break"></div>
                            <div class="col pr-4">
                                <div class="footer-float-right-responsive-brand">
                                    <div class="row row-footer row-footer-icon">
                                        <div class="mb-1">
                                            <a href="https://x.com/MITREattack" class="btn btn-footer">
                                                <i class="fa-brands fa-x-twitter fa-lg"></i>
                                            </a>
                                            <a href="https://github.com/mitre-attack" class="btn btn-footer">
                                                <i class="fa-brands fa-github fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>


<!--stopindex-->

</div>
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.5.1.min.js"></script>
    <script src="/theme/scripts/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap-select.min.js"></script>
    <script src="/theme/scripts/bootstrap.bundle.min.js"></script>
    <script src="/theme/scripts/site.js"></script>
    <script src="/theme/scripts/settings.js"></script>
    <script src="/theme/scripts/search_bundle.js"></script>

<!--SCRIPTS-->
<script src="/theme/scripts/resizer.js"></script>

<!--SCRIPTS-->
<script src="/theme/scripts/sidebar-load-all.js"></script>
<script src="/theme/scripts/bootstrap-tourist.js"></script>
<script src="/theme/scripts/settings.js"></script>
<script src="/theme/scripts/analytics-tab-nav.js"></script>
<script src="/theme/scripts/tour/tour-relationships.js"></script>
</body>
</html>