
<!DOCTYPE html>
<html lang='en'>

<head>
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62667723-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-62667723-1');
        </script>
        <meta name="google-site-verification" content="2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ"/>

        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1,shrink-to-fit=no'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel='shortcut icon' href='/theme/favicon.ico' type='image/x-icon'>
        <title>BPFDoor, Software S1161 | MITRE ATT&CK&reg;</title>
        <!-- USWDS CSS -->
        <!-- Bootstrap CSS -->
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap.min.css' />
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap-tourist.css' />
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap-select.min.css' />
        <!-- Fontawesome CSS -->
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/fontawesome.min.css"/>
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/brands.min.css"/>
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/solid.min.css"/>
            <link rel="stylesheet" href="/theme/style-attack.css"/>


</head>

<body>

    <div class="container-fluid attack-website-wrapper d-flex flex-column h-100">
        <div class="row sticky-top flex-grow-0 flex-shrink-1">
            <!-- header elements -->
            <header class="col px-0">
                    <nav class='navbar navbar-expand-lg navbar-dark position-static'>
        <a class='navbar-brand' href='/'><img src="/theme/images/mitre_attack_logo.png" class="attack-logo"></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse'
                aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
                <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
            <ul class='nav nav-tabs ml-auto'>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/matrices/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Matrices</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/matrices/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/matrices/mobile/">Mobile</a>
                <a class="dropdown-item" href="/matrices/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/tactics/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Tactics</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/tactics/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/tactics/mobile/">Mobile</a>
                <a class="dropdown-item" href="/tactics/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/techniques/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Techniques</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/techniques/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/techniques/mobile/">Mobile</a>
                <a class="dropdown-item" href="/techniques/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/datasources" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Defenses</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/datasources">Data Sources</a>
                
<div class="dropright dropdown">
<a class="dropdown-item dropdown-toggle" href="/mitigations/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Mitigations</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/mitigations/enterprise/">Enterprise</a>
            <a class="dropdown-item" href="/mitigations/mobile/">Mobile</a>
            <a class="dropdown-item" href="/mitigations/ics/">ICS</a>
    </div>
</div>

                <a class="dropdown-item" href="/assets">Assets</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/groups" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>CTI</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/groups">Groups</a>
                <a class="dropdown-item" href="/software">Software</a>
                <a class="dropdown-item" href="/campaigns">Campaigns</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/resources/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Resources</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/resources/">Get Started</a>
                <a class="dropdown-item" href="/resources/learn-more-about-attack/">Learn More about ATT&CK</a>
                <a class="dropdown-item" href="/resources/attackcon/">ATT&CKcon</a>
                <a class="dropdown-item" href="/resources/attack-data-and-tools/">ATT&CK Data & Tools</a>
                <a class="dropdown-item" href="/resources/faq/">FAQ</a>
                <a class="dropdown-item" href="/resources/engage-with-attack/contact/">Engage with ATT&CK</a>
                <a class="dropdown-item" href="/resources/versions/">Version History</a>
                <a class="dropdown-item" href="/resources/updates/">Updates</a>
                <a class="dropdown-item" href="/resources/legal-and-branding/">Legal & Branding</a>
    </div>


                        </li>
                        <li class="nav-item">
                            <a href="/resources/engage-with-attack/benefactors/"  class="nav-link" ><b>Benefactors</b></a>
                        </li>
                        <li class="nav-item">
                                <a href="https://medium.com/mitre-attack/" target="_blank" class="nav-link">
        <b>Blog</b>&nbsp;
        <img src="/theme/images/external-site.svg" alt="External site" class="external-icon" />
    </a>

                        </li>
                        <li class="nav-item">
                            <button id="search-button" class="btn search-button">Search <div id="search-icon" class="icon-button search-icon"></div></button>
                        </li>
            </ul>
        </div>
    </nav>

            </header>
        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- banner elements -->
            <div class="col px-0">
                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->
                <!-- !versions banner! -->
            </div>
        </div>
        <div class="row flex-grow-1 flex-shrink-0">
            <!-- main content elements -->
            <!--start-indexing-for-search-->

 
     
    <div class="sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3" id="v-tab" role="tablist" aria-orientation="vertical">
        <div class="resizer" id="resizer"></div>
<!--stop-indexing-for-search-->
<div id="sidebars"></div>
<!--start-indexing-for-search-->
    </div>

    
     
    <div class="tab-content col-xl-9 pt-4" id="v-tabContent">
        <div class="tab-pane fade show active" id="v-attckmatrix" role="tabpanel" aria-labelledby="v-attckmatrix-tab">
    
    <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">Home</a></li>
    <li class="breadcrumb-item"><a href="/software/">Software</a></li>
    <li class="breadcrumb-item">BPFDoor</li>
    </ol>
    <div class="tab-pane fade show active" id="v-" role="tabpanel" aria-labelledby="v--tab"></div>
    <div class="row">
        <div class="col-xl-12">
            <div class="jumbotron jumbotron-fluid">
                <div class="container-fluid">
                    <h1>
                        BPFDoor
                    </h1>

                        <div class="row">
                            <div class="col-md-8">
                                    <div class="description-body">
                                                <p><a href="/software/S1161">BPFDoor</a> is a Linux based passive long-term backdoor used by China-based threat actors. First seen in 2021, <a href="/software/S1161">BPFDoor</a> is named after its usage of Berkley Packet Filter (BPF) to execute single task instructions. <a href="/software/S1161">BPFDoor</a> supports multiple protocols for communicating with a C2 including TCP, UDP, and ICMP and can start local or reverse shells that bypass firewalls using iptables.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span><span onclick=scrollToRef('scite-2') id="scite-ref-2-a" class="scite-citeref-number" title="Shaul Vilkomir-Preisman and Eliran Nissan. (2023, May 10). BPFDoor Malware Evolves – Stealthy Sniffing Backdoor Ups Its Game. Retrieved September 19, 2024."data-reference="Deep Instinct BPFDoor 2023"><sup><a href="https://www.deepinstinct.com/blog/bpfdoor-malware-evolves-stealthy-sniffing-backdoor-ups-its-game" target="_blank" data-hasqtip="1" aria-describedby="qtip-1">[2]</a></sup></span></p>

                                    </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body">
                                            <div id="card-id" class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">ID:&nbsp;</span>S1161
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="Names that have overlapping reference to a software entry and may refer to the same or similar software in threat intelligence reporting">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Associated Software</span>: JustForFun, Backdoor.Linux.BPFDOOR, Backdoor.Solaris.BPFDOOR.ZAJE
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="This software is commercial, custom closed source, or open source software intended to be used for malicious purposes by adversaries">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Type</span>: MALWARE
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="The system an adversary is operating within; could be an operating system or application">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Platforms</span>: Linux
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Version</span>: 1.1
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Created:&nbsp;</span>20 September 2024
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Last Modified:&nbsp;</span>03 January 2025
                                                </div>
                                            </div>
                                    </div>
                                </div>
                                    <div class="text-center pt-2 version-button live">
    <div class="live">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Permalink to this version of S1161" 
           href="/versions/v17/software/S1161/" data-test-ignore="true">Version Permalink</a>
    </div>
    <div class="permalink">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Go to the live version of S1161" 
           href="/versions/v17/software/S1161/" data-test-ignore="true">Live Version</a><!--do not change this line without also changing versions.py-->
    </div>
</div>

                            </div>
                        </div>

                            <h2 class="pt-3" id ="aliasDescription">Associated Software Descriptions</h2>
                            <div class="tables-mobile">
                            <table class="table table-bordered table-alternate mt-2">
                                <thead>
                                    <tr>
                                        <th scope="col">Name</th>
                                        <th scope="col">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                JustForFun
                                            </td>
                                            <td>
                                                        <p><span onclick=scrollToRef('scite-3') id="scite-ref-3-a" class="scite-citeref-number" title=" Jamie Harries. (2022, May 25). Hunting a Global Telecommunications Threat: DecisiveArchitect and Its Custom Implant JustForFun. Retrieved September 23, 2024."data-reference="Harries JustForFun 2022"><sup><a href="https://www.crowdstrike.com/blog/how-to-hunt-for-decisivearchitect-and-justforfun-implant/" target="_blank" data-hasqtip="2" aria-describedby="qtip-2">[3]</a></sup></span></p>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                Backdoor.Linux.BPFDOOR
                                            </td>
                                            <td>
                                                        <p><span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="Fernando Merces. (2023, July 13). Detecting BPFDoor Backdoor Variants Abusing BPF Filters. Retrieved September 23, 2024."data-reference="Merces BPFDOOR 2023"><sup><a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                Backdoor.Solaris.BPFDOOR.ZAJE
                                            </td>
                                            <td>
                                                        <p><span onclick=scrollToRef('scite-3') id="scite-ref-3-a" class="scite-citeref-number" title=" Jamie Harries. (2022, May 25). Hunting a Global Telecommunications Threat: DecisiveArchitect and Its Custom Implant JustForFun. Retrieved September 23, 2024."data-reference="Harries JustForFun 2022"><sup><a href="https://www.crowdstrike.com/blog/how-to-hunt-for-decisivearchitect-and-justforfun-implant/" target="_blank" data-hasqtip="2" aria-describedby="qtip-2">[3]</a></sup></span></p>

                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                            </div>

                                <!--stop-indexing-for-search-->
        <div class="dropdown h3 mt-3 float-right">
            <button class="btn btn-navy dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <b>ATT&amp;CK<sup>&reg;</sup> Navigator Layers</b>
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <h6 class="dropdown-header">Enterprise Layer</h6>
                    <a class="dropdown-item" href="/software/S1161/S1161-enterprise-layer.json" download target="_blank">download</a>
                    <!-- only show view on navigator link if layer link is defined -->
                        <a class="dropdown-item" href="#" id="view-layer-on-navigator-enterprise" target="_blank">view <img width="10" src="/theme/images/external-site-dark.jpeg"></a>
                        <script src="/theme/scripts/settings.js"></script>
                        <script>
                            if (window.location.protocol == "https:") { //view on navigator only works when this site is hosted on HTTPS
                                var layerURL = window.location.protocol + "//" + window.location.host + base_url + "software/S1161/S1161-enterprise-layer.json";
                                document.getElementById("view-layer-on-navigator-enterprise").href = "https://mitre-attack.github.io/attack-navigator//#layerURL=" + encodeURIComponent(layerURL);
                            } else { //hide button
                                document.getElementById("view-layer-on-navigator-enterprise").classList.add("d-none");
                            }
                        </script>
            </div>
        </div>
    <!--start-indexing-for-search-->

                            <h2 class="pt-3 mb-2" id="techniques">Techniques Used</h2>
<div class="tables-mobile">
<table class="table techniques-used background table-bordered">
    <thead>
        <tr>
            <th class="p-2" scope="col">Domain</th>
            <th class="p-2" colspan="2">ID</th>
            <th class="p-2" scope="col">Name</th>
            <th class="p-2" scope="col">Use</th>
        </tr>
    </thead>
    <tbody>
                        <tr class="sub technique noparent enterprise" id="enterprise">
                            <td>
                                    Enterprise
 
                            </td>
                            <td>
                                <a href="/techniques/T1059">T1059</a>
                            </td>
                            <td>
                                <a href="/techniques/T1059/004">.004</a>
                            </td>
                            <td>
                                <a href="/techniques/T1059">Command and Scripting Interpreter</a>: <a href="/techniques/T1059/004">Unix Shell</a>
                            </td>
                            <td>
                                        <p><a href="/software/S1161">BPFDoor</a> can create a reverse shell and supports vt100 emulator formatting.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span></p>

                            </td>
                        </tr>
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1480">T1480</a>
                    </td>
                    <td>
                        <a href="/techniques/T1480">Execution Guardrails</a>
                    </td>
                    <td>
                                <p><a href="/software/S1161">BPFDoor</a> creates a zero byte PID file at <code>/var/run/haldrund.pid</code>. <a href="/software/S1161">BPFDoor</a> uses this file to determine if it is already running on a system to ensure only one instance is executing at a time.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span> </p>

                    </td>
                </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1480/002">.002</a>
                        </td>
                        <td>
                            <a href="/techniques/T1480/002">Mutual Exclusion</a>
                        </td>
                        <td>
                                    <p>When executed, <a href="/software/S1161">BPFDoor</a> attempts to create and lock a runtime file, <code>/var/run/initd.lock</code>, and exits if it fails using the specified file, resulting in a makeshift mutex.<span onclick=scrollToRef('scite-2') id="scite-ref-2-a" class="scite-citeref-number" title="Shaul Vilkomir-Preisman and Eliran Nissan. (2023, May 10). BPFDoor Malware Evolves – Stealthy Sniffing Backdoor Ups Its Game. Retrieved September 19, 2024."data-reference="Deep Instinct BPFDoor 2023"><sup><a href="https://www.deepinstinct.com/blog/bpfdoor-malware-evolves-stealthy-sniffing-backdoor-ups-its-game" target="_blank" data-hasqtip="1" aria-describedby="qtip-1">[2]</a></sup></span></p>

                        </td>
                    </tr>
                        <tr class="sub technique noparent enterprise" id="enterprise">
                            <td>
                                    Enterprise
 
                            </td>
                            <td>
                                <a href="/techniques/T1564">T1564</a>
                            </td>
                            <td>
                                <a href="/techniques/T1564/011">.011</a>
                            </td>
                            <td>
                                <a href="/techniques/T1564">Hide Artifacts</a>: <a href="/techniques/T1564/011">Ignore Process Interrupts</a>
                            </td>
                            <td>
                                        <p><a href="/software/S1161">BPFDoor</a> set's it's process to ignore the following signals; <code>SIGHUP</code>, <code>SIGINT</code>, <code>SIGQUIT</code>, <code>SIGPIPE</code>, <code>SIGCHLD</code>, <code>SIGTTIN</code>, and <code>SIGTTOU</code>.<span onclick=scrollToRef('scite-2') id="scite-ref-2-a" class="scite-citeref-number" title="Shaul Vilkomir-Preisman and Eliran Nissan. (2023, May 10). BPFDoor Malware Evolves – Stealthy Sniffing Backdoor Ups Its Game. Retrieved September 19, 2024."data-reference="Deep Instinct BPFDoor 2023"><sup><a href="https://www.deepinstinct.com/blog/bpfdoor-malware-evolves-stealthy-sniffing-backdoor-ups-its-game" target="_blank" data-hasqtip="1" aria-describedby="qtip-1">[2]</a></sup></span></p>

                            </td>
                        </tr>
                        <tr class="sub technique noparent enterprise" id="enterprise">
                            <td>
                                    Enterprise
 
                            </td>
                            <td>
                                <a href="/techniques/T1562">T1562</a>
                            </td>
                            <td>
                                <a href="/techniques/T1562/003">.003</a>
                            </td>
                            <td>
                                <a href="/techniques/T1562">Impair Defenses</a>: <a href="/techniques/T1562/003">Impair Command History Logging</a>
                            </td>
                            <td>
                                        <p><a href="/software/S1161">BPFDoor</a> sets the <code>MYSQL_HISTFILE</code> and <code>HISTFILE</code> to <code>/dev/null</code> preventing the shell and MySQL from logging history in <code>/proc/&lt;PID&gt;/environ</code>.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span> </p>

                            </td>
                        </tr>
                        <tr class="sub technique enterprise" id="enterprise">
                            <td></td>
                            <td></td>
                            <td>
                                <a href="/techniques/T1562/004">.004</a>
                            </td>
                            <td>
                                <a href="/techniques/T1562">Impair Defenses</a>: <a href="/techniques/T1562/004">Disable or Modify System Firewall</a>
                            </td>
                            <td>
                                        <p><a href="/software/S1161">BPFDoor</a> starts a shell on a high TCP port starting at 42391 up to 43391, then changes the local <code>iptables</code> rules to redirect all packets from the attacker to the shell port.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span> </p>

                            </td>
                        </tr>                        
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1070">T1070</a>
                    </td>
                    <td>
                        <a href="/techniques/T1070">Indicator Removal</a>
                    </td>
                    <td>
                                <p><a href="/software/S1161">BPFDoor</a> clears the file location <code>/proc/&lt;PID&gt;/environ</code> removing all environment variables for the process.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span> </p>

                    </td>
                </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1070/004">.004</a>
                        </td>
                        <td>
                            <a href="/techniques/T1070/004">File Deletion</a>
                        </td>
                        <td>
                                    <p>After initial setup, <a href="/software/S1161">BPFDoor</a>'s original execution process deletes the dropped binary and exits.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span> </p>

                        </td>
                    </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1070/006">.006</a>
                        </td>
                        <td>
                            <a href="/techniques/T1070/006">Timestomp</a>
                        </td>
                        <td>
                                    <p><a href="/software/S1161">BPFDoor</a> uses the <code>utimes()</code> function to change the executable's timestamp.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span> </p>

                        </td>
                    </tr>
                        <tr class="sub technique noparent enterprise" id="enterprise">
                            <td>
                                    Enterprise
 
                            </td>
                            <td>
                                <a href="/techniques/T1036">T1036</a>
                            </td>
                            <td>
                                <a href="/techniques/T1036/009">.009</a>
                            </td>
                            <td>
                                <a href="/techniques/T1036">Masquerading</a>: <a href="/techniques/T1036/009">Break Process Trees</a>
                            </td>
                            <td>
                                        <p>After initial execution, <a href="/software/S1161">BPFDoor</a> forks itself and runs the fork with the <code>--init</code> flag, which allows it to execute secondary clean up operations. The parent process terminates leaving the forked process to be inherited by the legitimate process init.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span></p>

                            </td>
                        </tr>
                        <tr class="sub technique enterprise" id="enterprise">
                            <td></td>
                            <td></td>
                            <td>
                                <a href="/techniques/T1036/011">.011</a>
                            </td>
                            <td>
                                <a href="/techniques/T1036">Masquerading</a>: <a href="/techniques/T1036/011">Overwrite Process Arguments</a>
                            </td>
                            <td>
                                        <p><a href="/software/S1161">BPFDoor</a> overwrites the <code>argv[0]</code> value used by the Linux <code>/proc</code> filesystem to determine the command line and command name to display for each process. <a href="/software/S1161">BPFDoor</a> selects a name from 10 hardcoded names that resemble Linux system daemons, such as; <code>/sbin/udevd -d</code>, <code>dbus-daemon --system</code>, <code>avahi-daemon: chroot helper</code>, <code>/sbin/auditd -n</code>, and <code>/usr/lib/systemd/systemd-journald</code>.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span></p>

                            </td>
                        </tr>                        
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1027">T1027</a>
                    </td>
                    <td>
                        <a href="/techniques/T1027">Obfuscated Files or Information</a>
                    </td>
                    <td>
                                <p><a href="/software/S1161">BPFDoor</a> can require a password to activate the backdoor and uses RC4 encryption or static library encryption <code>libtomcrypt</code>.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span></p>

                    </td>
                </tr>
                        <tr class="sub technique noparent enterprise" id="enterprise">
                            <td>
                                    Enterprise
 
                            </td>
                            <td>
                                <a href="/techniques/T1205">T1205</a>
                            </td>
                            <td>
                                <a href="/techniques/T1205/002">.002</a>
                            </td>
                            <td>
                                <a href="/techniques/T1205">Traffic Signaling</a>: <a href="/techniques/T1205/002">Socket Filters</a>
                            </td>
                            <td>
                                        <p><a href="/software/S1161">BPFDoor</a> uses BPF bytecode to attach a filter to a network socket to view ICMP, UDP, or TCP packets coming through ports 22 (ssh), 80 (http), and 443 (https). When <a href="/software/S1161">BPFDoor</a>  finds a packet containing its "magic" bytes, it parses out two fields and forks itself. The parent process continues to monitor filtered traffic while the child process executes the instructions from the parsed fields.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023."data-reference="Sandfly BPFDoor 2022"><sup><a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span><span onclick=scrollToRef('scite-2') id="scite-ref-2-a" class="scite-citeref-number" title="Shaul Vilkomir-Preisman and Eliran Nissan. (2023, May 10). BPFDoor Malware Evolves – Stealthy Sniffing Backdoor Ups Its Game. Retrieved September 19, 2024."data-reference="Deep Instinct BPFDoor 2023"><sup><a href="https://www.deepinstinct.com/blog/bpfdoor-malware-evolves-stealthy-sniffing-backdoor-ups-its-game" target="_blank" data-hasqtip="1" aria-describedby="qtip-1">[2]</a></sup></span></p>

                            </td>
                        </tr>
    </tbody>
</table>
</div>




                                <h2 class="pt-3" id="references">References</h2>

        <div class="row">
            <div class="col">
                <ol>
                            
        <li>
            <span  id="scite-1" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-1" href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/" target="_blank">
                        The Sandfly Security Team. (2022, May 11). BPFDoor - An Evasive Linux Backdoor Technical Analysis. Retrieved September 29, 2023.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-2" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-2" href="https://www.deepinstinct.com/blog/bpfdoor-malware-evolves-stealthy-sniffing-backdoor-ups-its-game" target="_blank">
                        Shaul Vilkomir-Preisman and Eliran Nissan. (2023, May 10). BPFDoor Malware Evolves – Stealthy Sniffing Backdoor Ups Its Game. Retrieved September 19, 2024.
                    </a>
                </span>
            </span>
        </li>


                </ol>
            </div>
            <div class="col">
                    <ol start="3.0">
                                
        <li>
            <span  id="scite-3" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-3" href="https://www.crowdstrike.com/blog/how-to-hunt-for-decisivearchitect-and-justforfun-implant/" target="_blank">
                         Jamie Harries. (2022, May 25). Hunting a Global Telecommunications Threat: DecisiveArchitect and Its Custom Implant JustForFun. Retrieved September 23, 2024.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-4" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-4" href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html" target="_blank">
                        Fernando Merces. (2023, July 13). Detecting BPFDoor Backdoor Variants Abusing BPF Filters. Retrieved September 23, 2024.
                    </a>
                </span>
            </span>
        </li>


  
                    </ol>
            </div>             
        </div>


                </div>
            </div>
        </div>
    </div>

        </div>
    </div>

            <!--stop-indexing-for-search-->
            <!-- search overlay for entire page -- not displayed inline -->
            <div class="overlay search" id="search-overlay" style="display: none;">
    <div class="overlay-inner">
        <!-- text input for searching -->
        <div class="search-header">
            <div class="search-input">
                <input type="text" id="search-input" placeholder="search">
            </div>
            <div class="search-icons">
                <div class="search-parsing-icon spinner-border" style="display: none" id="search-parsing-icon"></div>
                <div class="close-search-icon" id="close-search-icon">&times;</div>
            </div>
        </div>
        <!-- results and controls for loading more results -->
        <div id="search-body" class="search-body">
            <div class="results" id="search-results">
                <!-- content will be appended here on search -->
            </div>
            <div id="load-more-results" class="load-more-results">
                <button class="btn btn-default" id="load-more-results-button">load more results</button>
            </div>
        </div>
    </div>
</div>

        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- footer elements -->
            <footer class="col footer">
                <div class="container-fluid">
                    <div class="row row-footer">
                        <div class="col-2 col-sm-2 col-md-2">
                            <div class="footer-center-responsive my-auto">
                                <a href="https://www.mitre.org" target="_blank" rel="noopener" aria-label="MITRE">
                                    <img src="/theme/images/mitrelogowhiteontrans.gif" class="mitre-logo-wtrans">
                                </a>
                            </div>
                        </div>
                        <div class="col-2 col-sm-2 footer-responsive-break"></div>
                        <div class="footer-link-group">
                            <div class="row row-footer">
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/engage-with-attack/contact" class="footer-link">Contact Us</a></u>
                                </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/legal-and-branding/terms-of-use" class="footer-link">Terms of Use</a></u>
                                </div>
                                    <div class="px-3 col-footer">
                                        <u class="footer-link"><a href="/resources/legal-and-branding/privacy" class="footer-link">Privacy Policy</a></u>
                                    </div>
                                <div class="px-3">
                                    <u class="footer-link"><a href="/resources/changelog.html" class="footer-link" data-toggle="tooltip" data-placement="top" data-html="true" title="ATT&amp;CK content v17.1&#013;Website  v4.2.3">Website Changelog</a></u>
                                </div>
                            </div>
                            <div class="row">
                                <small class="px-3">
                                    &copy;&nbsp;2015&nbsp;-&nbsp;2025, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.
                                </small>
                            </div>
                        </div>
                        <div class="w-100 p-2 footer-responsive-break"></div>
                            <div class="col pr-4">
                                <div class="footer-float-right-responsive-brand">
                                    <div class="row row-footer row-footer-icon">
                                        <div class="mb-1">
                                            <a href="https://twitter.com/MITREattack" class="btn btn-footer">
                                                <i class="fa-brands fa-x-twitter fa-lg"></i>
                                            </a>
                                            <a href="https://github.com/mitre-attack" class="btn btn-footer">
                                                <i class="fa-brands fa-github fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>


<!--stopindex-->

</div>
        <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.5.1.min.js"></script>
    <script src="/theme/scripts/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap-select.min.js"></script>
    <script src="/theme/scripts/bootstrap.bundle.min.js"></script>
    <script src="/theme/scripts/site.js"></script>
    <script src="/theme/scripts/settings.js"></script>
    <script src="/theme/scripts/search_bundle.js"></script>

<!--SCRIPTS-->
<script src="/theme/scripts/resizer.js"></script>

    <!--SCRIPTS-->
    <script src="/theme/scripts/sidebar-load-all.js"></script>
    <script src="/theme/scripts/bootstrap-tourist.js"></script>
    <script src="/theme/scripts/settings.js"></script>
    <script src="/theme/scripts/tour/tour-relationships.js"></script>
</body>
</html>