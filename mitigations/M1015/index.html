
<!DOCTYPE html>
<html lang='en'>

<head>
        <script src=https://cmp.osano.com/AzyhULTdPkqmy4aDN/83f786b4-d60d-4938-b70a-73afd166380a/osano.js></script>
    <style>
        .osano-cm-widget{display: none;}
    </style>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62667723-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-62667723-1');
        </script>
        <meta name="google-site-verification" content="2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ"/>

        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1,shrink-to-fit=no'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel='shortcut icon' href='/theme/favicon.ico' type='image/x-icon'>
        <title>Active Directory Configuration, Mitigation M1015 - Enterprise | MITRE ATT&CK&reg;</title>
        <!-- USWDS CSS -->
        <!-- Bootstrap CSS -->
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap.min.css' />
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap-tourist.css' />
        <link rel='stylesheet' href='/theme/style/vendors/bootstrap-select.min.css' />
        <!-- Fontawesome CSS -->
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/fontawesome.min.css"/>
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/brands.min.css"/>
        <link rel="stylesheet" href="/theme/style/vendors/fontawesome-6.5.1/css/solid.min.css"/>
            <link rel="stylesheet" href="/theme/style-attack.css"/>


</head>

<body>

    <div class="container-fluid attack-website-wrapper d-flex flex-column h-100">
        <div class="row sticky-top flex-grow-0 flex-shrink-1">
            <!-- header elements -->
            <header class="col px-0">
                    <nav class='navbar navbar-expand-lg navbar-dark position-static'>
        <a class='navbar-brand' href='/'><img src="/theme/images/mitre_attack_logo.png" class="attack-logo"></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse'
                aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
                <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
            <ul class='nav nav-tabs ml-auto'>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/matrices/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Matrices</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/matrices/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/matrices/mobile/">Mobile</a>
                <a class="dropdown-item" href="/matrices/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/tactics/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Tactics</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/tactics/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/tactics/mobile/">Mobile</a>
                <a class="dropdown-item" href="/tactics/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/techniques/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Techniques</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/techniques/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/techniques/mobile/">Mobile</a>
                <a class="dropdown-item" href="/techniques/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/datasources" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Defenses</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/datasources">Data Sources</a>
                
<div class="dropright dropdown">
<a class="dropdown-item dropdown-toggle" href="/mitigations/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Mitigations</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/mitigations/enterprise/">Enterprise</a>
            <a class="dropdown-item" href="/mitigations/mobile/">Mobile</a>
            <a class="dropdown-item" href="/mitigations/ics/">ICS</a>
    </div>
</div>

                <a class="dropdown-item" href="/assets">Assets</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/groups" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>CTI</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/groups">Groups</a>
                <a class="dropdown-item" href="/software">Software</a>
                <a class="dropdown-item" href="/campaigns">Campaigns</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/resources/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Resources</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/resources/">Get Started</a>
                <a class="dropdown-item" href="/resources/learn-more-about-attack/">Learn More about ATT&CK</a>
                <a class="dropdown-item" href="/resources/attackcon/">ATT&CKcon</a>
                <a class="dropdown-item" href="/resources/attack-data-and-tools/">ATT&CK Data & Tools</a>
                <a class="dropdown-item" href="/resources/faq/">FAQ</a>
                <a class="dropdown-item" href="/resources/engage-with-attack/contact/">Engage with ATT&CK</a>
                <a class="dropdown-item" href="/resources/versions/">Version History</a>
                <a class="dropdown-item" href="/resources/updates/">Updates</a>
                <a class="dropdown-item" href="/resources/legal-and-branding/">Legal & Branding</a>
    </div>


                        </li>
                        <li class="nav-item">
                            <a href="/resources/engage-with-attack/benefactors/"  class="nav-link" ><b>Benefactors</b></a>
                        </li>
                        <li class="nav-item">
                                <a href="https://medium.com/mitre-attack/" target="_blank" class="nav-link">
        <b>Blog</b>&nbsp;
        <img src="/theme/images/external-site.svg" alt="External site" class="external-icon" />
    </a>

                        </li>
                        <li class="nav-item">
                            <button id="search-button" class="btn search-button">Search <div id="search-icon" class="icon-button search-icon"></div></button>
                        </li>
            </ul>
        </div>
    </nav>

            </header>
        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- banner elements -->
            <div class="col px-0">
                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->
                <!-- !versions banner! -->
                    <div class="container-fluid banner-message">
                        

                    </div>
            </div>
        </div>
        <div class="row flex-grow-1 flex-shrink-0">
            <!-- main content elements -->
            <!--start-indexing-for-search-->

 
     
    <div class="sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3" id="v-tab" role="tablist" aria-orientation="vertical">
        <div class="resizer" id="resizer"></div>
<!--stop-indexing-for-search-->
<div id="sidebars"></div>
<!--start-indexing-for-search-->
    </div>

    
     
    <div class="tab-content col-xl-9 pt-4" id="v-tabContent">
        <div class="tab-pane fade show active" id="v-attckmatrix" role="tabpanel" aria-labelledby="v-attckmatrix-tab">
    
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Home</a></li>
        <li class="breadcrumb-item"><a href="/mitigations">Mitigations</a></li>
        <li class="breadcrumb-item">Active Directory Configuration</li>
    </ol>
    <div class="tab-pane fade show active" id="v-" role="tabpanel" aria-labelledby="v--tab"></div>
    <div class="row">
        <div class="col-xl-12">
            <div class="jumbotron jumbotron-fluid">
                <div class="container-fluid">
                    <h1>
                        Active Directory Configuration
                    </h1>

                        <div class="row">
                            <div class="col-md-8">
                                    <div class="description-body">
                                                <p>Implement robust Active Directory (AD) configurations using group policies to secure user accounts, control access, and minimize the attack surface. AD configurations enable centralized control over account settings, logon policies, and permissions, reducing the risk of unauthorized access and lateral movement within the network. This mitigation can be implemented through the following measures:</p><p>Account Configuration:</p><ul><li>Implementation: Use domain accounts instead of local accounts to leverage AD’s centralized management, including group policies, auditing, and access control.</li><li>Use Case: For IT staff managing shared resources, provision domain accounts that allow IT teams to log in centrally, reducing the risk of unmanaged, rogue local accounts on individual machines.</li></ul><p>Interactive Logon Restrictions:</p><ul><li>Implementation: Configure group policies to restrict interactive logons (e.g., direct physical or RDP logons) for service accounts or privileged accounts that do not require such access.</li><li>Use Case: Prevent service accounts, such as SQL Server accounts, from having interactive logon privileges. This reduces the risk of these accounts being leveraged for lateral movement if compromised.</li></ul><p>Remote Desktop Settings:</p><ul><li>Implementation: Limit Remote Desktop Protocol (RDP) access to specific, authorized accounts. Use group policies to enforce this, allowing only necessary users to establish RDP sessions.</li><li>Use Case: On sensitive servers (e.g., domain controllers or financial databases), restrict RDP access to administrative accounts only, while all other users are denied access.</li></ul><p>Dedicated Administrative Accounts:</p><ul><li>Implementation: Create domain-wide administrative accounts that are restricted from interactive logons, designed solely for high-level tasks (e.g., software installation, patching).</li><li>Use Case: Create separate administrative accounts for different purposes, such as one set of accounts for installations and another for managing repository access. This limits exposure and helps reduce attack vectors.</li></ul><p>Authentication Silos:</p><ul><li>Implementation: Configure Authentication Silos in AD, using group policies to create access zones with restrictions based on membership, such as the Protected Users security group. This restricts access to critical accounts and minimizes exposure to potential threats.</li><li>Use Case: Place high-risk or high-value accounts, such as executive or administrative accounts, in an Authentication Silo with extra controls, limiting their exposure to only necessary systems. This reduces the risk of credential misuse or abuse if these accounts are compromised.</li></ul><p><strong>Tools for Implementation</strong>:</p><ul><li>Active Directory Group Policies: Use Group Policy Management Console (GPMC) to configure, deploy, and enforce policies across AD environments.</li><li>PowerShell: Automate account configuration, logon restrictions, and policy application using PowerShell scripts.</li><li>AD Administrative Center: Manage Authentication Silos and configure high-level policies for critical user groups within AD.</li></ul>

                                    </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body">
                                            <div class="card-data"><span class="h5 card-title">ID:</span> M1015</div>
                                            <div class="card-data"><span class="h5 card-title">Version:</span> 1.2</div>
                                            <div class="card-data"><span class="h5 card-title">Created:&nbsp;</span>06 June 2019</div>
                                            <div class="card-data"><span class="h5 card-title">Last Modified:&nbsp;</span>10 December 2024</div>
                                    </div>
                                </div>
                                    <div class="text-center pt-2 version-button live">
    <div class="live">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Permalink to this version of M1015" 
           href="/versions/v17/mitigations/M1015/" data-test-ignore="true">Version Permalink</a>
    </div>
    <div class="permalink">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Go to the live version of M1015" 
           href="/versions/v17/mitigations/M1015/" data-test-ignore="true">Live Version</a><!--do not change this line without also changing versions.py-->
    </div>
</div>

                            </div>
                        </div>

                                <!--stop-indexing-for-search-->
        <div class="dropdown h3 mt-3 float-right">
            <button class="btn btn-navy dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <b>ATT&amp;CK<sup>&reg;</sup> Navigator Layers</b>
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <h6 class="dropdown-header">Enterprise Layer</h6>
                    <a class="dropdown-item" href="/mitigations/M1015/M1015-enterprise-layer.json" download target="_blank">download</a>
                    <!-- only show view on navigator link if layer link is defined -->
                        <a class="dropdown-item" href="#" id="view-layer-on-navigator-enterprise" target="_blank">view <img width="10" src="/theme/images/external-site-dark.jpeg"></a>
                        <script src="/theme/scripts/settings.js"></script>
                        <script>
                            if (window.location.protocol == "https:") { //view on navigator only works when this site is hosted on HTTPS
                                var layerURL = window.location.protocol + "//" + window.location.host + base_url + "mitigations/M1015/M1015-enterprise-layer.json";
                                document.getElementById("view-layer-on-navigator-enterprise").href = "https://mitre-attack.github.io/attack-navigator//#layerURL=" + encodeURIComponent(layerURL);
                            } else { //hide button
                                document.getElementById("view-layer-on-navigator-enterprise").classList.add("d-none");
                            }
                        </script>
            </div>
        </div>
    <!--start-indexing-for-search-->

                            <h2 class="pt-3 mb-2" id="techniques">Techniques Addressed by Mitigation</h2>
<div class="tables-mobile">
<table class="table techniques-used background table-bordered">
    <thead>
        <tr>
            <th class="p-2" scope="col">Domain</th>
            <th class="p-2" colspan="2">ID</th>
            <th class="p-2" scope="col">Name</th>
            <th class="p-2" scope="col">Use</th>
        </tr>
    </thead>
    <tbody>
                        <tr class="sub technique noparent enterprise" id="enterprise">
                            <td>
                                    Enterprise
 
                            </td>
                            <td>
                                <a href="/techniques/T1134">T1134</a>
                            </td>
                            <td>
                                <a href="/techniques/T1134/005">.005</a>
                            </td>
                            <td>
                                <a href="/techniques/T1134">Access Token Manipulation</a>: <a href="/techniques/T1134/005">SID-History Injection</a>
                            </td>
                            <td>
                                        <p>Clean up SID-History attributes after legitimate account migration is complete.</p><p>Consider applying SID Filtering to interforest trusts, such as forest trusts and external trusts, to exclude SID-History from requests to access domain resources. SID Filtering ensures that any authentication requests over a trust only contain SIDs of security principals from the trusted domain (i.e preventing the trusted domain from claiming a user has membership in groups outside of the domain).</p><p>SID Filtering of forest trusts is enabled by default, but may have been disabled in some cases to allow a child domain to transitively access forest trusts. SID Filtering of external trusts is automatically enabled on all created external trusts using Server 2003 or later domain controllers. <span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="Microsoft. (2014, November 19). Security Considerations for Trusts. Retrieved November 30, 2017."data-reference="Microsoft Trust Considerations Nov 2014"><sup><a href="https://technet.microsoft.com/library/cc755321.aspx" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span> <span onclick=scrollToRef('scite-2') id="scite-ref-2-a" class="scite-citeref-number" title="Microsoft. (n.d.). Configuring SID Filter Quarantining on External Trusts. Retrieved November 30, 2017."data-reference="Microsoft SID Filtering Quarantining Jan 2009"><sup><a href="https://technet.microsoft.com/library/cc794757.aspx" target="_blank" data-hasqtip="1" aria-describedby="qtip-1">[2]</a></sup></span> However note that SID Filtering is not automatically applied to legacy trusts or may have been deliberately disabled to allow inter-domain access to resources.</p><p>SID Filtering can be applied by: <span onclick=scrollToRef('scite-3') id="scite-ref-3-a" class="scite-citeref-number" title="Microsoft. (2012, September 11). Command-Line Reference - Netdom Trust. Retrieved November 30, 2017."data-reference="Microsoft Netdom Trust Sept 2012"><sup><a href="https://technet.microsoft.com/library/cc835085.aspx" target="_blank" data-hasqtip="2" aria-describedby="qtip-2">[3]</a></sup></span></p><ul><li><p>Disabling SIDHistory on forest trusts using the netdom tool (<code>netdom trust /domain: /EnableSIDHistory:no</code> on the domain controller)</p></li><li><p>Applying SID Filter Quarantining to external trusts using the netdom tool (<code>netdom trust <TrustingDomainName> /domain:<TrustedDomainName> /quarantine:yes</code> on the domain controller)</p></li><li><p>Applying SID Filtering to domain trusts within a single forest is not recommended as it is an unsupported configuration and can cause breaking changes. <span onclick=scrollToRef('scite-3') id="scite-ref-3-a" class="scite-citeref-number" title="Microsoft. (2012, September 11). Command-Line Reference - Netdom Trust. Retrieved November 30, 2017."data-reference="Microsoft Netdom Trust Sept 2012"><sup><a href="https://technet.microsoft.com/library/cc835085.aspx" target="_blank" data-hasqtip="2" aria-describedby="qtip-2">[3]</a></sup></span> <span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="Metcalf, S. (2015, August 7). Kerberos Golden Tickets are Now More Golden. Retrieved December 1, 2017."data-reference="AdSecurity Kerberos GT Aug 2015"><sup><a href="https://adsecurity.org/?p=1640" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span> If a domain within a forest is untrustworthy then it should not be a member of the forest. In this situation it is necessary to first split the trusted and untrusted domains into separate forests where SID Filtering can be applied to an interforest trust</p></li></ul>

                            </td>
                        </tr>
                        <tr class="sub technique noparent enterprise" id="enterprise">
                            <td>
                                    Enterprise
 
                            </td>
                            <td>
                                <a href="/techniques/T1606">T1606</a>
                            </td>
                            <td>
                                <a href="/techniques/T1606/002">.002</a>
                            </td>
                            <td>
                                <a href="/techniques/T1606">Forge Web Credentials</a>: <a href="/techniques/T1606/002">SAML Tokens</a>
                            </td>
                            <td>
                                        <p>For containing the impact of a previously forged SAML token, rotate the token-signing AD FS certificate in rapid succession twice, which will invalidate any tokens generated using the previous certificate.<span onclick=scrollToRef('scite-5') id="scite-ref-5-a" class="scite-citeref-number" title="Mandiant. (2021, January 19). Remediation and Hardening Strategies for Microsoft 365 to Defend Against UNC2452. Retrieved January 22, 2021."data-reference="Mandiant Defend UNC2452 White Paper"><sup><a href="https://www.mandiant.com/resources/blog/remediation-and-hardening-strategies-for-microsoft-365-to-defend-against-unc2452" target="_blank" data-hasqtip="4" aria-describedby="qtip-4">[5]</a></sup></span></p>

                            </td>
                        </tr>
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1003">T1003</a>
                    </td>
                    <td>
                        <a href="/techniques/T1003">OS Credential Dumping</a>
                    </td>
                    <td>
                                <p>Manage the access control list for "Replicating Directory Changes All" and other permissions associated with domain controller replication. <span onclick=scrollToRef('scite-6') id="scite-ref-6-a" class="scite-citeref-number" title="Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017."data-reference="AdSecurity DCSync Sept 2015"><sup><a href="https://adsecurity.org/?p=1729" target="_blank" data-hasqtip="5" aria-describedby="qtip-5">[6]</a></sup></span> <span onclick=scrollToRef('scite-7') id="scite-ref-7-a" class="scite-citeref-number" title="Microsoft. (n.d.). How to grant the "Replicating Directory Changes" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017."data-reference="Microsoft Replication ACL"><sup><a href="https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr" target="_blank" data-hasqtip="6" aria-describedby="qtip-6">[7]</a></sup></span> Consider adding users to the "Protected Users" Active Directory security group. This can help limit the caching of users' plaintext credentials.<span onclick=scrollToRef('scite-8') id="scite-ref-8-a" class="scite-citeref-number" title="Microsoft. (2016, October 12). Protected Users Security Group. Retrieved May 29, 2020."data-reference="Microsoft Protected Users Security Group"><sup><a href="https://docs.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group" target="_blank" data-hasqtip="7" aria-describedby="qtip-7">[8]</a></sup></span></p>

                    </td>
                </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1003/005">.005</a>
                        </td>
                        <td>
                            <a href="/techniques/T1003/005">Cached Domain Credentials</a>
                        </td>
                        <td>
                                    <p>Consider adding users to the "Protected Users" Active Directory security group. This can help limit the caching of users' plaintext credentials.<span onclick=scrollToRef('scite-8') id="scite-ref-8-a" class="scite-citeref-number" title="Microsoft. (2016, October 12). Protected Users Security Group. Retrieved May 29, 2020."data-reference="Microsoft Protected Users Security Group"><sup><a href="https://docs.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group" target="_blank" data-hasqtip="7" aria-describedby="qtip-7">[8]</a></sup></span></p>

                        </td>
                    </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1003/006">.006</a>
                        </td>
                        <td>
                            <a href="/techniques/T1003/006">DCSync</a>
                        </td>
                        <td>
                                    <p>Manage the access control list for "Replicating Directory Changes" and other permissions associated with domain controller replication.<span onclick=scrollToRef('scite-9') id="scite-ref-9-a" class="scite-citeref-number" title="Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017."data-reference="ADSecurity Mimikatz DCSync"><sup><a href="https://adsecurity.org/?p=1729" target="_blank" data-hasqtip="8" aria-describedby="qtip-8">[9]</a></sup></span><span onclick=scrollToRef('scite-7') id="scite-ref-7-a" class="scite-citeref-number" title="Microsoft. (n.d.). How to grant the "Replicating Directory Changes" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017."data-reference="Microsoft Replication ACL"><sup><a href="https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr" target="_blank" data-hasqtip="6" aria-describedby="qtip-6">[7]</a></sup></span></p>

                        </td>
                    </tr>
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1072">T1072</a>
                    </td>
                    <td>
                        <a href="/techniques/T1072">Software Deployment Tools</a>
                    </td>
                    <td>
                                <p>Ensure proper system and access isolation for critical network systems through use of group policy.</p>

                    </td>
                </tr>
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1649">T1649</a>
                    </td>
                    <td>
                        <a href="/techniques/T1649">Steal or Forge Authentication Certificates</a>
                    </td>
                    <td>
                                <p>Ensure certificate authorities (CA) are properly secured, including treating CA servers (and other resources hosting CA certificates) as tier 0 assets. Harden abusable CA settings and attributes.</p><p>For example, consider disabling the usage of AD CS certificate SANs within relevant authentication protocol settings to enforce strict user mappings and prevent certificates from authenticating as other identifies.<span onclick=scrollToRef('scite-10') id="scite-ref-10-a" class="scite-citeref-number" title="Schroeder, W. & Christensen, L. (2021, June 22). Certified Pre-Owned - Abusing Active Directory Certificate Services. Retrieved August 2, 2022."data-reference="SpecterOps Certified Pre Owned"><sup><a href="https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf" target="_blank" data-hasqtip="9" aria-describedby="qtip-9">[10]</a></sup></span> Also consider enforcing CA Certificate Manager approval for the templates that include SAN as an issuance requirement.</p>

                    </td>
                </tr>
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1558">T1558</a>
                    </td>
                    <td>
                        <a href="/techniques/T1558">Steal or Forge Kerberos Tickets</a>
                    </td>
                    <td>
                                <p>For containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.<span onclick=scrollToRef('scite-11') id="scite-ref-11-a" class="scite-citeref-number" title="UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020."data-reference="STIG krbtgt reset"><sup><a href="https://www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779" target="_blank" data-hasqtip="10" aria-describedby="qtip-10">[11]</a></sup></span></p>

                    </td>
                </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1558/001">.001</a>
                        </td>
                        <td>
                            <a href="/techniques/T1558/001">Golden Ticket</a>
                        </td>
                        <td>
                                    <p>For containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.<span onclick=scrollToRef('scite-11') id="scite-ref-11-a" class="scite-citeref-number" title="UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020."data-reference="STIG krbtgt reset"><sup><a href="https://www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779" target="_blank" data-hasqtip="10" aria-describedby="qtip-10">[11]</a></sup></span></p>

                        </td>
                    </tr>
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1552">T1552</a>
                    </td>
                    <td>
                        <a href="/techniques/T1552">Unsecured Credentials</a>
                    </td>
                    <td>
                                <p>Remove vulnerable Group Policy Preferences.<span onclick=scrollToRef('scite-12') id="scite-ref-12-a" class="scite-citeref-number" title="Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved January 28, 2015."data-reference="Microsoft MS14-025"><sup><a href="http://support.microsoft.com/kb/2962486" target="_blank" data-hasqtip="11" aria-describedby="qtip-11">[12]</a></sup></span></p>

                    </td>
                </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1552/006">.006</a>
                        </td>
                        <td>
                            <a href="/techniques/T1552/006">Group Policy Preferences</a>
                        </td>
                        <td>
                                    <p>Remove vulnerable Group Policy Preferences.<span onclick=scrollToRef('scite-12') id="scite-ref-12-a" class="scite-citeref-number" title="Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved January 28, 2015."data-reference="Microsoft MS14-025"><sup><a href="http://support.microsoft.com/kb/2962486" target="_blank" data-hasqtip="11" aria-describedby="qtip-11">[12]</a></sup></span></p>

                        </td>
                    </tr>
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1550">T1550</a>
                    </td>
                    <td>
                        <a href="/techniques/T1550">Use Alternate Authentication Material</a>
                    </td>
                    <td>
                                <p>Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.</p>

                    </td>
                </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1550/003">.003</a>
                        </td>
                        <td>
                            <a href="/techniques/T1550/003">Pass the Ticket</a>
                        </td>
                        <td>
                                    <p>To contain the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it.<span onclick=scrollToRef('scite-13') id="scite-ref-13-a" class="scite-citeref-number" title="Sean Metcalf. (2014, November 10). Kerberos & KRBTGT: Active Directory’s Domain Kerberos Service Account. Retrieved January 30, 2020."data-reference="ADSecurity Kerberos and KRBTGT"><sup><a href="https://adsecurity.org/?p=483" target="_blank" data-hasqtip="12" aria-describedby="qtip-12">[13]</a></sup></span> For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.<span onclick=scrollToRef('scite-11') id="scite-ref-11-a" class="scite-citeref-number" title="UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020."data-reference="STIG krbtgt reset"><sup><a href="https://www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779" target="_blank" data-hasqtip="10" aria-describedby="qtip-10">[11]</a></sup></span></p>

                        </td>
                    </tr>
                <tr class="technique enterprise" id="enterprise">
                    <td>
                            Enterprise
                    </td>
                    <td colspan="2">
                        <a href="/techniques/T1078">T1078</a>
                    </td>
                    <td>
                        <a href="/techniques/T1078">Valid Accounts</a>
                    </td>
                    <td>
                                <p>Disable legacy authentication, which does not support MFA, and require the use of modern authentication protocols instead.</p>

                    </td>
                </tr>
                    <tr class="sub technique enterprise" id="enterprise">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/techniques/T1078/004">.004</a>
                        </td>
                        <td>
                            <a href="/techniques/T1078/004">Cloud Accounts</a>
                        </td>
                        <td>
                                    <p>Disable legacy authentication, which does not support MFA, and require the use of modern authentication protocols instead. </p>

                        </td>
                    </tr>
    </tbody>
</table>
</div>


                                <h2 class="pt-3" id="references">References</h2>

        <div class="row">
            <div class="col">
                <ol>
                            
        <li>
            <span  id="scite-1" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-1" href="https://technet.microsoft.com/library/cc755321.aspx" target="_blank">
                        Microsoft. (2014, November 19). Security Considerations for Trusts. Retrieved November 30, 2017.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-2" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-2" href="https://technet.microsoft.com/library/cc794757.aspx" target="_blank">
                        Microsoft. (n.d.). Configuring SID Filter Quarantining on External Trusts. Retrieved November 30, 2017.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-3" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-3" href="https://technet.microsoft.com/library/cc835085.aspx" target="_blank">
                        Microsoft. (2012, September 11). Command-Line Reference - Netdom Trust. Retrieved November 30, 2017.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-4" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-4" href="https://adsecurity.org/?p=1640" target="_blank">
                        Metcalf, S. (2015, August 7). Kerberos Golden Tickets are Now More Golden. Retrieved December 1, 2017.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-5" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-5" href="https://www.mandiant.com/resources/blog/remediation-and-hardening-strategies-for-microsoft-365-to-defend-against-unc2452" target="_blank">
                        Mandiant. (2021, January 19). Remediation and Hardening Strategies for Microsoft 365 to Defend Against UNC2452. Retrieved January 22, 2021.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-6" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-6" href="https://adsecurity.org/?p=1729" target="_blank">
                        Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-7" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-7" href="https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr" target="_blank">
                        Microsoft. (n.d.). How to grant the "Replicating Directory Changes" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017.
                    </a>
                </span>
            </span>
        </li>


                </ol>
            </div>
            <div class="col">
                    <ol start="8.0">
                                
        <li>
            <span  id="scite-8" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-8" href="https://docs.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group" target="_blank">
                        Microsoft. (2016, October 12). Protected Users Security Group. Retrieved May 29, 2020.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-9" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-9" href="https://adsecurity.org/?p=1729" target="_blank">
                        Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-10" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-10" href="https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf" target="_blank">
                        Schroeder, W. & Christensen, L. (2021, June 22). Certified Pre-Owned - Abusing Active Directory Certificate Services. Retrieved August 2, 2022.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-11" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-11" href="https://www.stigviewer.com/stig/windows_server_2016/2019-12-12/finding/V-91779" target="_blank">
                        UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-12" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-12" href="http://support.microsoft.com/kb/2962486" target="_blank">
                        Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved January 28, 2015.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-13" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-13" href="https://adsecurity.org/?p=483" target="_blank">
                        Sean Metcalf. (2014, November 10). Kerberos & KRBTGT: Active Directory’s Domain Kerberos Service Account. Retrieved January 30, 2020.
                    </a>
                </span>
            </span>
        </li>


  
                    </ol>
            </div>             
        </div>

                </div>
            </div>
        </div>
    </div>

        </div>
    </div>

            <!--stop-indexing-for-search-->
            <!-- search overlay for entire page -- not displayed inline -->
            <div class="overlay search" id="search-overlay" style="display: none;">
    <div class="overlay-inner">
        <!-- text input for searching -->
        <div class="search-header">
            <div class="search-input">
                <input type="text" id="search-input" placeholder="search">
            </div>
            <div class="search-icons">
                <div class="search-parsing-icon spinner-border" style="display: none" id="search-parsing-icon"></div>
                <div class="close-search-icon" id="close-search-icon">&times;</div>
            </div>
        </div>
        <!-- results and controls for loading more results -->
        <div id="search-body" class="search-body">
            <div class="results" id="search-results">
                <!-- content will be appended here on search -->
            </div>
            <div id="load-more-results" class="load-more-results">
                <button class="btn btn-default" id="load-more-results-button">load more results</button>
            </div>
        </div>
    </div>
</div>

        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- footer elements -->
            <footer class="col footer">
                <div class="container-fluid">
                    <div class="row row-footer">
                        <div class="col-2 col-sm-2 col-md-2">
                            <div class="footer-center-responsive my-auto">
                                <a href="https://www.mitre.org" target="_blank" rel="noopener" aria-label="MITRE">
                                    <img src="/theme/images/mitrelogowhiteontrans.gif" class="mitre-logo-wtrans">
                                </a>
                            </div>
                        </div>
                        <div class="col-2 col-sm-2 footer-responsive-break"></div>
                        <div class="footer-link-group">
                            <div class="row row-footer">
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/engage-with-attack/contact" class="footer-link">Contact Us</a></u>
                                </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/legal-and-branding/terms-of-use" class="footer-link">Terms of Use</a></u>
                                </div>
                                    <div class="px-3 col-footer">
                                        <u class="footer-link"><a href="/resources/legal-and-branding/privacy" class="footer-link">Privacy Policy</a></u>
                                    </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/changelog.html" class="footer-link" data-toggle="tooltip" data-placement="top" data-html="true" title="ATT&amp;CK content v17.1&#013;Website  v4.2.3">Website Changelog</a></u>
                                </div>
                                <div class="px-3">
                                    <u class="footer-link"><a href="/resources/legal-and-branding/privacy/#" class="footer-link" onclick="Osano.cm.showDrawer('osano-cm-dom-info-dialog-open')">Cookie Preferences</a></u>
                                </div>
                            </div>
                            <div class="row">
                                <small class="px-3">
                                    &copy;&nbsp;2015&nbsp;-&nbsp;2025, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.
                                </small>
                            </div>
                        </div>
                        <div class="w-100 p-2 footer-responsive-break"></div>
                            <div class="col pr-4">
                                <div class="footer-float-right-responsive-brand">
                                    <div class="row row-footer row-footer-icon">
                                        <div class="mb-1">
                                            <a href="https://x.com/MITREattack" class="btn btn-footer">
                                                <i class="fa-brands fa-x-twitter fa-lg"></i>
                                            </a>
                                            <a href="https://github.com/mitre-attack" class="btn btn-footer">
                                                <i class="fa-brands fa-github fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>


<!--stopindex-->

</div>
        <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.5.1.min.js"></script>
    <script src="/theme/scripts/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap-select.min.js"></script>
    <script src="/theme/scripts/bootstrap.bundle.min.js"></script>
    <script src="/theme/scripts/site.js"></script>
    <script src="/theme/scripts/settings.js"></script>
    <script src="/theme/scripts/search_bundle.js"></script>

<!--SCRIPTS-->
<script src="/theme/scripts/resizer.js"></script>

    <!--SCRIPTS-->
    <script src="/theme/scripts/sidebar-load-all.js"></script>
</body>
</html>