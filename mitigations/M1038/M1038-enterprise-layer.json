{"description": "Enterprise techniques used by Execution Prevention, ATT&CK mitigation M1038 v1.1", "name": "Execution Prevention (M1038)", "domain": "enterprise-attack", "versions": {"layer": "4.2", "attack": "9", "navigator": "4.3"}, "techniques": [{"score": 1, "techniqueID": "T1548", "showSubtechniques": true, "comment": "System settings can prevent applications from running that haven't been downloaded from legitimate repositories which may help mitigate some of these issues. Not allowing unsigned applications from being run may also mitigate some risk."}, {"score": 1, "techniqueID": "T1548.004", "showSubtechniques": true, "comment": "System settings can prevent applications from running that haven't been downloaded through the Apple Store which may help mitigate some of these issues. Not allowing unsigned applications from being run may also mitigate some risk."}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.004", "showSubtechniques": true, "comment": "Identify and block potentially malicious software that may be executed through the Winlogon helper process by using application control (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) that are capable of auditing and/or blocking unknown DLLs."}, {"score": 1, "techniqueID": "T1547.006", "showSubtechniques": true, "comment": "Application control and software restriction tools, such as SELinux, KSPP, grsecurity MODHARDEN, and Linux kernel tuning can aid in restricting kernel module loading.(Citation: Kernel.org Restrict Kernel Module)(Citation: Wikibooks Grsecurity)(Citation: Kernel Self Protection Project)(Citation: Increasing Linux kernel integrity)(Citation: LKM loading kernel restrictions) Since macOS High Sierra 10.13, Secure Kernel Extension Loading (SKEL) can also be used to restrict the loading of kernel modules.(Citation: Apple TN2459 Kernel Extensions)"}, {"score": 1, "techniqueID": "T1176", "showSubtechniques": false, "comment": "Set a browser extension allow or deny list as appropriate for your security policy. (Citation: Technospot Chrome Extensions GP)"}, {"score": 1, "techniqueID": "T1059", "showSubtechniques": true, "comment": "Use application control where appropriate."}, {"score": 1, "techniqueID": "T1059.002", "showSubtechniques": true, "comment": "Use application control where appropriate."}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "Use application control where appropriate."}, {"score": 1, "techniqueID": "T1059.004", "showSubtechniques": true, "comment": "Use application control where appropriate."}, {"score": 1, "techniqueID": "T1059.005", "showSubtechniques": true, "comment": "Use application control where appropriate."}, {"score": 1, "techniqueID": "T1059.006", "showSubtechniques": true, "comment": "Denylist Python where not required."}, {"score": 1, "techniqueID": "T1059.007", "showSubtechniques": true, "comment": "Denylist scripting where appropriate."}, {"score": 1, "techniqueID": "T1059.008", "showSubtechniques": true, "comment": "TACACS+ can keep control over which commands administrators are permitted to use through the configuration of authentication and command authorization. (Citation: Cisco IOS Software Integrity Assurance - TACACS)"}, {"score": 1, "techniqueID": "T1609", "showSubtechniques": false, "comment": "Use read-only containers and minimal images when possible to prevent the execution of commands."}, {"score": 1, "techniqueID": "T1611", "showSubtechniques": false, "comment": "Use read-only containers and minimal images when possible to prevent the running of commands."}, {"techniqueID": "T1546", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1546.002", "showSubtechniques": true, "comment": "Block .scr files from being executed from non-standard locations."}, {"score": 1, "techniqueID": "T1546.006", "showSubtechniques": true, "comment": "Allow applications via known hashes."}, {"score": 1, "techniqueID": "T1546.008", "showSubtechniques": true, "comment": "Adversaries can replace accessibility features binaries with alternate binaries to execute this technique. Identify and block potentially malicious software executed through accessibility features functionality by using application control (Citation: Beechey 2010) tools, like Windows Defender Application Control(Citation: Microsoft Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"}, {"score": 1, "techniqueID": "T1546.009", "showSubtechniques": true, "comment": "Adversaries install new AppCertDLL binaries to execute this technique. Identify and block potentially malicious software executed through AppCertDLLs functionality by using application control (Citation: Beechey 2010) tools, like Windows Defender Application Control(Citation: Microsoft Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"}, {"score": 1, "techniqueID": "T1546.010", "showSubtechniques": true, "comment": "Adversaries can install new AppInit DLLs binaries to execute this technique. Identify and block potentially malicious software executed through AppInit DLLs functionality by using application control (Citation: Beechey 2010) tools, like Windows Defender Application Control(Citation: Microsoft Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"}, {"score": 1, "techniqueID": "T1068", "showSubtechniques": false, "comment": "Consider blocking the execution of known vulnerable drivers that adversaries may exploit to execute code in kernel mode. Validate driver block rules in audit mode to ensure stability prior to production deployment.(Citation: Microsoft Driver Block Rules)"}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.003", "showSubtechniques": true, "comment": "Limit or restrict program execution using anti-virus software. On MacOS, allowlist programs that are allowed to have the plist tag. All other programs should be considered suspicious."}, {"score": 1, "techniqueID": "T1564.006", "showSubtechniques": true, "comment": "Use application control to mitigate installation and use of unapproved virtualization software."}, {"score": 1, "techniqueID": "T1574", "showSubtechniques": true, "comment": "Adversaries may use new payloads to execute this technique. Identify and block potentially malicious software executed through hijacking by using application control solutions also capable of blocking libraries loaded by legitimate software."}, {"score": 1, "techniqueID": "T1574.001", "showSubtechniques": true, "comment": "Adversaries may use new DLLs to execute this technique. Identify and block potentially malicious software executed through search order hijacking by using application control solutions capable of blocking DLLs loaded by legitimate software."}, {"score": 1, "techniqueID": "T1574.006", "showSubtechniques": true, "comment": "Adversaries may use new payloads to execute this technique. Identify and block potentially malicious software executed through hijacking by using application control solutions also capable of blocking libraries loaded by legitimate software."}, {"score": 1, "techniqueID": "T1574.007", "showSubtechniques": true, "comment": "Adversaries will likely need to place new binaries in locations to be executed through this weakness. Identify and block potentially malicious software executed path interception by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.(Citation: SANS Application Whitelisting)(Citation: Microsoft Windows Defender Application Control)(Citation: Windows Commands JPCERT)(Citation: NSA MS AppLocker)(Citation: Microsoft Application Lockdown)(Citation: Microsoft Using Software Restriction )"}, {"score": 1, "techniqueID": "T1574.008", "showSubtechniques": true, "comment": "Adversaries will likely need to place new binaries in locations to be executed through this weakness. Identify and block potentially malicious software executed path interception by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.(Citation: SANS Application Whitelisting)(Citation: Microsoft Windows Defender Application Control)(Citation: Windows Commands JPCERT)(Citation: NSA MS AppLocker)(Citation: Microsoft Application Lockdown)(Citation: Microsoft Using Software Restriction )"}, {"score": 1, "techniqueID": "T1574.009", "showSubtechniques": true, "comment": "Adversaries will likely need to place new binaries in locations to be executed through this weakness. Identify and block potentially malicious software executed path interception by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.(Citation: SANS Application Whitelisting)(Citation: Microsoft Windows Defender Application Control)(Citation: Windows Commands JPCERT)(Citation: NSA MS AppLocker)(Citation: Microsoft Application Lockdown)(Citation: Microsoft Using Software Restriction )"}, {"score": 1, "techniqueID": "T1574.012", "showSubtechniques": true, "comment": "Identify and block potentially malicious unmanaged COR_PROFILER profiling DLLs  by using application control solutions like AppLocker that are capable of auditing and/or blocking unapproved DLLs.(Citation: Beechey 2010)(Citation: Windows Commands JPCERT)(Citation: NSA MS AppLocker)"}, {"score": 1, "techniqueID": "T1036", "showSubtechniques": true, "comment": "Use tools that restrict program execution via application control by attributes other than file name for common operating system utilities that are needed."}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "Use tools that restrict program execution via application control by attributes other than file name for common operating system utilities that are needed."}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "Identify and block potentially malicious software executed that may be executed through this technique by using application control (Citation: Beechey 2010) tools, like Windows Defender Application Control(Citation: Microsoft Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"}, {"score": 1, "techniqueID": "T1219", "showSubtechniques": false, "comment": "Use application control to mitigate installation and use of unapproved software that can be used for remote access."}, {"score": 1, "techniqueID": "T1129", "showSubtechniques": false, "comment": "Identify and block potentially malicious software executed through this technique by using application control tools capable of preventing unknown DLLs from being loaded."}, {"score": 1, "techniqueID": "T1218", "showSubtechniques": true, "comment": "Consider using application control to prevent execution of binaries that are susceptible to abuse and not required for a given system or network."}, {"score": 1, "techniqueID": "T1218.001", "showSubtechniques": true, "comment": "Consider using application control to prevent execution of hh.exe if it is not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1218.002", "showSubtechniques": true, "comment": "Identify and block potentially malicious and unknown .cpl files by using application control (Citation: Beechey 2010) tools, like Windows Defender Application Control(Citation: Microsoft Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"}, {"score": 1, "techniqueID": "T1218.003", "showSubtechniques": true, "comment": "Consider using application control configured to block execution of CMSTP.exe if it is not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1218.004", "showSubtechniques": true, "comment": "Use application control configured to block execution of InstallUtil.exe if it is not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1218.005", "showSubtechniques": true, "comment": "Use application control configured to block execution of mshta.exe if it is not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1218.008", "showSubtechniques": true, "comment": "Use application control configured to block execution of Odbcconf.exe if it is not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1218.009", "showSubtechniques": true, "comment": "Block execution of Regsvcs.exe and Regasm.exe if they are not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1218.012", "showSubtechniques": true, "comment": "Use application control configured to block execution of verclsid.exe if it is not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1216", "showSubtechniques": true, "comment": "Certain signed scripts that can be used to execute other programs may not be necessary within a given environment. Use application control configured to block execution of these scripts if they are not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1216.001", "showSubtechniques": true, "comment": "Certain signed scripts that can be used to execute other programs may not be necessary within a given environment. Use application control configured to block execution of these scripts if they are not required for a given system or network to prevent potential misuse by adversaries."}, {"score": 1, "techniqueID": "T1553", "showSubtechniques": true, "comment": "System settings can prevent applications from running that haven't been downloaded through the Apple Store (or other legitimate repositories) which can help mitigate some of these issues. Also enable application control solutions such as AppLocker and/or Device Guard to block the loading of malicious content."}, {"score": 1, "techniqueID": "T1553.001", "showSubtechniques": true, "comment": "System settings can prevent applications from running that haven't been downloaded through the Apple Store which can help mitigate some of these issues. "}, {"score": 1, "techniqueID": "T1553.003", "showSubtechniques": true, "comment": "Enable application control solutions such as AppLocker and/or Device Guard to block the loading of malicious SIP DLLs."}, {"score": 1, "techniqueID": "T1553.005", "showSubtechniques": true, "comment": "Consider blocking container file types at web and/or email gateways. Consider unregistering container file extensions in Windows File Explorer.(Citation: Dormann Dangers of VHD 2019)"}, {"score": 1, "techniqueID": "T1080", "showSubtechniques": false, "comment": "Identify potentially malicious software that may be used to taint content or may result from it and audit and/or block the unknown programs by using application control (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)"}, {"score": 1, "techniqueID": "T1127", "showSubtechniques": false, "comment": "Certain developer utilities should be blocked or restricted if not required."}, {"score": 1, "techniqueID": "T1204", "showSubtechniques": true, "comment": "Application control may be able to prevent the running of executables masquerading as other files."}, {"score": 1, "techniqueID": "T1204.002", "showSubtechniques": true, "comment": "Application control may be able to prevent the running of executables masquerading as other files."}, {"score": 1, "techniqueID": "T1220", "showSubtechniques": false, "comment": "If msxsl.exe is unnecessary, then block its execution to prevent abuse by adversaries."}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Execution Prevention", "color": "#66b1ff"}]}