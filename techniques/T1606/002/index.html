
<!DOCTYPE html>
<html lang='en'>

<head>
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62667723-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-62667723-1');
        </script>
        <meta name="google-site-verification" content="2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ"/>

        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1,shrink-to-fit=no'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel='shortcut icon' href='/theme/favicon.ico' type='image/x-icon'>
        <title>Forge Web Credentials: SAML Tokens, Sub-technique T1606.002 - Enterprise | MITRE ATT&CK&reg;</title>
        <!-- USWDS CSS -->
        <!-- Bootstrap CSS -->
        <link rel='stylesheet' href='/theme/style/bootstrap.min.css' />
        <link rel='stylesheet' href='/theme/style/bootstrap-tourist.css' />
        <link rel='stylesheet' href='/theme/style/bootstrap-select.min.css' />
        <!-- Fontawesome CSS -->
        <link rel="stylesheet" href="/theme/style/fontawesome-6.5.1/css/fontawesome.min.css"/>
        <link rel="stylesheet" href="/theme/style/fontawesome-6.5.1/css/brands.min.css"/>
        <link rel="stylesheet" href="/theme/style/fontawesome-6.5.1/css/solid.min.css"/>
        <link rel="stylesheet" type="text/css" href="/theme/style.min.css?40237523">

</head>

<body>

    <div class="container-fluid attack-website-wrapper d-flex flex-column h-100">
        <div class="row sticky-top flex-grow-0 flex-shrink-1">
            <!-- header elements -->
            <header class="col px-0">
                    <nav class='navbar navbar-expand-lg navbar-dark position-static'>
        <a class='navbar-brand' href='/'><img src="/theme/images/mitre_attack_logo.png" class="attack-logo"></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse'
                aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
                <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
            <ul class='nav nav-tabs ml-auto'>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/matrices/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Matrices</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/matrices/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/matrices/mobile/">Mobile</a>
                <a class="dropdown-item" href="/matrices/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/tactics/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Tactics</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/tactics/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/tactics/mobile/">Mobile</a>
                <a class="dropdown-item" href="/tactics/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/techniques/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Techniques</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/techniques/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/techniques/mobile/">Mobile</a>
                <a class="dropdown-item" href="/techniques/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/datasources" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Defenses</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/datasources">Data Sources</a>
                
<div class="dropright dropdown">
<a class="dropdown-item dropdown-toggle" href="/mitigations/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Mitigations</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/mitigations/enterprise/">Enterprise</a>
            <a class="dropdown-item" href="/mitigations/mobile/">Mobile</a>
            <a class="dropdown-item" href="/mitigations/ics/">ICS</a>
    </div>
</div>

                <a class="dropdown-item" href="/assets">Assets</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/groups" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>CTI</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/groups">Groups</a>
                <a class="dropdown-item" href="/software">Software</a>
                <a class="dropdown-item" href="/campaigns">Campaigns</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/resources/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Resources</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/resources/">Get Started</a>
                <a class="dropdown-item" href="/resources/learn-more-about-attack/">Learn More about ATT&CK</a>
                <a class="dropdown-item" href="/resources/attackcon/">ATT&CKcon</a>
                <a class="dropdown-item" href="/resources/attack-data-and-tools/">ATT&CK Data & Tools</a>
                <a class="dropdown-item" href="/resources/faq/">FAQ</a>
                <a class="dropdown-item" href="/resources/engage-with-attack/contact/">Engage with ATT&CK</a>
                <a class="dropdown-item" href="/resources/versions/">Version History</a>
                <a class="dropdown-item" href="/resources/legal-and-branding/">Legal & Branding</a>
    </div>


                        </li>
                        <li class="nav-item">
                            <a href="/resources/engage-with-attack/benefactors/"  class="nav-link" ><b>Benefactors</b></a>
                        </li>
                        <li class="nav-item">
                                <a href="https://medium.com/mitre-attack/" target="_blank" class="nav-link">
        <b>Blog</b>&nbsp;
        <img src="/theme/images/external-site.svg" alt="External site" class="external-icon" />
    </a>

                        </li>
                        <li class="nav-item">
                            <button id="search-button" class="btn search-button">Search <div id="search-icon" class="icon-button search-icon"></div></button>
                        </li>
            </ul>
        </div>
    </nav>

            </header>
        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- banner elements -->
            <div class="col px-0">
                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->
                <!-- !versions banner! -->
                    <div class="container-fluid banner-message">
                        ATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA. Register for in-person participation <a href='https://www.mitre.org/events/attackcon-5'>here</a>. Stay tuned for virtual registration!
                    </div>
            </div>
        </div>
        <div class="row flex-grow-1 flex-shrink-0">
            <!-- main content elements -->
            <!--start-indexing-for-search-->

 
     
    <div class="sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3" id="v-tab" role="tablist" aria-orientation="vertical">
        <div class="resizer" id="resizer"></div>
<!--stop-indexing-for-search-->
<div id="sidebars"></div>
<!--start-indexing-for-search-->
    </div>

    
     
    <div class="tab-content col-xl-9 pt-4" id="v-tabContent">
        <div class="tab-pane fade show active" id="v-attckmatrix" role="tabpanel" aria-labelledby="v-attckmatrix-tab">
    
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Home</a></li>
            <li class="breadcrumb-item"><a href="/techniques/enterprise">Techniques</a></li>
            <li class="breadcrumb-item"><a href="/techniques/enterprise">Enterprise</a></li>
            <li class="breadcrumb-item"><a href="/techniques/T1606">Forge Web Credentials</a></li>
        <li class="breadcrumb-item">SAML Tokens</li>
    </ol>
    <div class="tab-pane fade show active" id="v-" role="tabpanel" aria-labelledby="v--tab"></div>
    <div class="row">
        <div class="col-xl-12">
            <div class="jumbotron jumbotron-fluid">
                <div class="container-fluid">
                    <h1 id="">
                            <span id="subtechnique-parent-name">Forge Web Credentials:</span>
                        SAML Tokens
                    </h1>

                        <div class="row">
                            <div class="col-md-8">
                                    <!--stop-indexing-for-search-->
                                    <div class="card-block pb-2">
                                        <div class="card">
                                            <div class="card-header collapsed" id="subtechniques-card-header" data-toggle="collapse" data-target="#subtechniques-card-body" aria-expanded="false" aria-controls="subtechniques-card-body">
                                                    <h5 class="mb-0" id ="sub-techniques">Other sub-techniques of Forge Web Credentials (2)</h5>
                                            </div>
                                            <div id="subtechniques-card-body" class="card-body p-0 collapse" aria-labelledby="subtechniques-card-header">
                                                <table class="table table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">ID</th>
                                                            <th scope="col">Name</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/techniques/T1606/001/" class="subtechnique-table-item" data-subtechnique_id="T1606.001"> T1606.001 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/techniques/T1606/001/" class="subtechnique-table-item" data-subtechnique_id="T1606.001"> Web Cookies </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td class="active">
                                                                        T1606.002
                                                                    </td>
                                                                    <td class="active">
                                                                        SAML Tokens
                                                                    </td>
                                                            </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <!--start-indexing-for-search-->

                                    <div class="description-body">
                                                <p>An adversary may forge SAML tokens with any permissions claims and lifetimes if they possess a valid SAML token-signing certificate.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="Lambert, J. (2020, December 13). Important steps for customers to protect themselves from recent nation-state cyberattacks. Retrieved December 17, 2020."data-reference="Microsoft SolarWinds Steps"><sup><a href="https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span> The default lifetime of a SAML token is one hour, but the validity period can be specified in the <code>NotOnOrAfter</code> value of the <code>conditions ...</code> element in a token. This value can be changed using the <code>AccessTokenLifetime</code> in a <code>LifetimeTokenPolicy</code>.<span onclick=scrollToRef('scite-2') id="scite-ref-2-a" class="scite-citeref-number" title="Microsoft. (2020, December 14). Configurable token lifetimes in Microsoft Identity Platform. Retrieved December 22, 2020."data-reference="Microsoft SAML Token Lifetimes"><sup><a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-configurable-token-lifetimes" target="_blank" data-hasqtip="1" aria-describedby="qtip-1">[2]</a></sup></span> Forged SAML tokens enable adversaries to authenticate across services that use SAML 2.0 as an SSO (single sign-on) mechanism.<span onclick=scrollToRef('scite-3') id="scite-ref-3-a" class="scite-citeref-number" title="Reiner, S. (2017, November 21). Golden SAML: Newly Discovered Attack Technique Forges Authentication to Cloud Apps. Retrieved December 17, 2020."data-reference="Cyberark Golden SAML"><sup><a href="https://www.cyberark.com/resources/threat-research-blog/golden-saml-newly-discovered-attack-technique-forges-authentication-to-cloud-apps" target="_blank" data-hasqtip="2" aria-describedby="qtip-2">[3]</a></sup></span></p><p>An adversary may utilize <a href="/techniques/T1552/004">Private Keys</a> to compromise an organization's token-signing certificate to create forged SAML tokens. If the adversary has sufficient permissions to establish a new federation trust with their own Active Directory Federation Services (AD FS) server, they may instead generate their own trusted token-signing certificate.<span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 17, 2020."data-reference="Microsoft SolarWinds Customer Guidance"><sup><a href="https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span> This differs from <a href="/techniques/T1528">Steal Application Access Token</a> and other similar behaviors in that the tokens are new and forged by the adversary, rather than stolen or intercepted from legitimate users.</p><p>An adversary may gain administrative Azure AD privileges if a SAML token is forged which claims to represent a highly privileged account. This may lead to <a href="/techniques/T1550">Use Alternate Authentication Material</a>, which may bypass multi-factor and other authentication protection mechanisms.<span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 17, 2020."data-reference="Microsoft SolarWinds Customer Guidance"><sup><a href="https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p>

                                    </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body">
                                            <div class="row card-data" id="card-id">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">ID:&nbsp;</span>T1606.002
                                                </div>
                                            </div>
                                        <!--stop-indexing-for-search-->
                                        <div class="row card-data">
                                            <div class="col-md-1 px-0 text-center"></div>
                                            <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Sub-technique of:&nbsp;</span>
                                                    <a href="/techniques/T1606">T1606</a>
                                            </div>
                                        </div>
                                        <!--start-indexing-for-search-->
                                            <div id="card-tactics" class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="The tactic objectives that the (sub-)technique can be used to accomplish">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Tactic:</span>
                                                        <a href="/tactics/TA0006">Credential Access</a>                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="The system an adversary is operating within; could be an operating system or application">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Platforms:&nbsp;</span>Azure AD, Google Workspace, IaaS, Office 365, SaaS, Windows
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Contributors:&nbsp;</span>Blake Strom, Microsoft 365 Defender; Jack Burns, HubSpot; Oleg Kolesnikov, Securonix
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Version:&nbsp;</span>1.3
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Created:&nbsp;</span>17 December 2020
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Last Modified:&nbsp;</span>01 March 2024
                                                </div>
                                            </div>
                                    </div>
                                </div>
                                    <div class="text-center pt-2 version-button live">
    <div class="live">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Permalink to this version of T1606.002" 
           href="/versions/v15/techniques/T1606/002/" data-test-ignore="true">Version Permalink</a>
    </div>
    <div class="permalink">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Go to the live version of T1606.002" 
           href="/versions/v15/techniques/T1606/002/" data-test-ignore="true">Live Version</a><!--do not change this line without also changing versions.py-->
    </div>
</div>

                            </div>
                        </div>
                            <h2 class="pt-3" id ="examples">Procedure Examples</h2>
                            <div class="tables-mobile">
                            <table class="table table-bordered table-alternate mt-2">
                                <thead>
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">Name</th>
                                        <th scope="col">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                <a href="/software/S0677"> S0677 </a>
                                            </td>
                                            <td>
                                                <a href="/software/S0677"> AADInternals </a>
                                            </td>
                                            <td>
                                                            <p><a href="/software/S0677">AADInternals</a> can be used to create SAML tokens using the AD Federated Services token signing certificate.<span onclick=scrollToRef('scite-5') id="scite-ref-5-a" class="scite-citeref-number" title="Dr. Nestori Syynimaa. (2018, October 25). AADInternals. Retrieved February 18, 2022."data-reference="AADInternals Documentation"><sup><a href="https://o365blog.com/aadinternals" target="_blank" data-hasqtip="4" aria-describedby="qtip-4">[5]</a></sup></span></p>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <a href="/campaigns/C0024"> C0024 </a>
                                            </td>
                                            <td>
                                                <a href="/campaigns/C0024"> SolarWinds Compromise </a>
                                            </td>
                                            <td>
                                                            <p>During the <a href="https://attack.mitre.org/campaigns/C0024">SolarWinds Compromise</a>, <a href="/groups/G0016">APT29</a> created tokens using compromised SAML signing certificates.<span onclick=scrollToRef('scite-6') id="scite-ref-6-a" class="scite-citeref-number" title="MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 30, 2020."data-reference="Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks"><sup><a href="https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/" target="_blank" data-hasqtip="5" aria-describedby="qtip-5">[6]</a></sup></span><span onclick=scrollToRef('scite-7') id="scite-ref-7-a" class="scite-citeref-number" title="Secureworks CTU. (n.d.). IRON RITUAL. Retrieved February 24, 2022."data-reference="Secureworks IRON RITUAL Profile"><sup><a href="https://www.secureworks.com/research/threat-profiles/iron-ritual" target="_blank" data-hasqtip="6" aria-describedby="qtip-6">[7]</a></sup></span></p>

                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                            </div>
                            <h2 class="pt-3" id ="mitigations">Mitigations</h2>
                            <div class="tables-mobile">
                                <table class="table table-bordered table-alternate mt-2">
                                    <thead>
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Mitigation</th>
                                            <th scope="col">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                <td>
                                                    <a href="/mitigations/M1015"> M1015 </a>
                                                </td>
                                                <td>
                                                    <a href="/mitigations/M1015"> Active Directory Configuration </a>
                                                </td>
                                                <td>
                                                                <p>For containing the impact of a previously forged SAML token, rotate the token-signing AD FS certificate in rapid succession twice, which will invalidate any tokens generated using the previous certificate.<span onclick=scrollToRef('scite-8') id="scite-ref-8-a" class="scite-citeref-number" title="Mandiant. (2021, January 19). Remediation and Hardening Strategies for Microsoft 365 to Defend Against UNC2452. Retrieved January 22, 2021."data-reference="Mandiant Defend UNC2452 White Paper"><sup><a href="https://www.mandiant.com/resources/blog/remediation-and-hardening-strategies-for-microsoft-365-to-defend-against-unc2452" target="_blank" data-hasqtip="7" aria-describedby="qtip-7">[8]</a></sup></span></p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/mitigations/M1047"> M1047 </a>
                                                </td>
                                                <td>
                                                    <a href="/mitigations/M1047"> Audit </a>
                                                </td>
                                                <td>
                                                                <p>Enable advanced auditing on AD FS. Check the success and failure audit options in the AD FS Management snap-in. Enable Audit Application Generated events on the AD FS farm via Group Policy Object.<span onclick=scrollToRef('scite-9') id="scite-ref-9-a" class="scite-citeref-number" title="Bierstock, D., Baker, A. (2019, March 21). I am AD FS and So Can You. Retrieved December 17, 2020."data-reference="FireEye ADFS"><sup><a href="https://www.troopers.de/troopers19/agenda/fpxwmn/" target="_blank" data-hasqtip="8" aria-describedby="qtip-8">[9]</a></sup></span></p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/mitigations/M1026"> M1026 </a>
                                                </td>
                                                <td>
                                                    <a href="/mitigations/M1026"> Privileged Account Management </a>
                                                </td>
                                                <td>
                                                                <p>Restrict permissions and access to the AD FS server to only originate from privileged access workstations.<span onclick=scrollToRef('scite-9') id="scite-ref-9-a" class="scite-citeref-number" title="Bierstock, D., Baker, A. (2019, March 21). I am AD FS and So Can You. Retrieved December 17, 2020."data-reference="FireEye ADFS"><sup><a href="https://www.troopers.de/troopers19/agenda/fpxwmn/" target="_blank" data-hasqtip="8" aria-describedby="qtip-8">[9]</a></sup></span></p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/mitigations/M1018"> M1018 </a>
                                                </td>
                                                <td>
                                                    <a href="/mitigations/M1018"> User Account Management </a>
                                                </td>
                                                <td>
                                                                <p>Ensure that user accounts with administrative rights follow best practices, including use of privileged access workstations, Just in Time/Just Enough Administration (JIT/JEA), and strong authentication. Reduce the number of users that are members of highly privileged Directory Roles.<span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 17, 2020."data-reference="Microsoft SolarWinds Customer Guidance"><sup><a href="https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p>

                                                </td>
                                            </tr>
                                    </tbody>
                                </table>
                                </div>
                            <h2 class="pt-3" id="detection">Detection</h2>
                                <div class="tables-mobile">
<table class="table datasources-table table-bordered">
    <thead>
        <tr>
            <th class="p-2" scope="col">ID</th>
            <th class="p-2 nowrap" scope="col">Data Source</th>
            <th class="p-2 nowrap" scope="col">Data Component</th>
            <th class="p-2" scope="col">Detects</th>
        </tr>
    </thead>
    <tbody>
            <tr class="datasource" id="uses-DS0028">
                <td>
                    <a href="/datasources/DS0028">DS0028</a>
                </td>
                <td class="nowrap">
                    <a href="/datasources/DS0028">Logon Session</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0028/#Logon%20Session%20Creation">Logon Session Creation</a>
                </td>
                    <td>
                                <p>Monitor for logins using SAML tokens which do not have corresponding 4769 and 1200 events in the domain.<span onclick=scrollToRef('scite-10') id="scite-ref-10-a" class="scite-citeref-number" title="Sygnia. (2020, December). Detection and Hunting of Golden SAML Attack. Retrieved January 6, 2021."data-reference="Sygnia Golden SAML"><sup><a href="https://www.sygnia.co/golden-saml-advisory" target="_blank" data-hasqtip="9" aria-describedby="qtip-9">[10]</a></sup></span> These logins may occur on any on-premises resources as well as from any cloud environment that trusts the certificate.<span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 17, 2020."data-reference="Microsoft SolarWinds Customer Guidance"><sup><a href="https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p>

                    </td>
            </tr>
                    <tr class="datacomponent datasource" id="uses-DS0028-Logon Session Metadata">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/datasources/DS0028/#Logon%20Session%20Metadata">Logon Session Metadata</a>
                        </td>
                            <td>
                                        <p>Consider modifying SAML responses to include custom elements for each service provider. Monitor these custom elements in service provider access logs to detect any anomalous requests.<span onclick=scrollToRef('scite-10') id="scite-ref-10-a" class="scite-citeref-number" title="Sygnia. (2020, December). Detection and Hunting of Golden SAML Attack. Retrieved January 6, 2021."data-reference="Sygnia Golden SAML"><sup><a href="https://www.sygnia.co/golden-saml-advisory" target="_blank" data-hasqtip="9" aria-describedby="qtip-9">[10]</a></sup></span></p>

                            </td>
                    </tr>
            <tr class="datasource" id="uses-DS0009">
                <td>
                    <a href="/datasources/DS0009">DS0009</a>
                </td>
                <td class="nowrap">
                    <a href="/datasources/DS0009">Process</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0009/#Process%20Creation">Process Creation</a>
                </td>
                    <td>
                                <p>This search looks for arguments to certutil.exe indicating the manipulation or extraction of Certificate. This certificate can then be used to sign new authentication tokens specially inside Federated environments such as Windows ADFS.</p><p>Analytic 1 - Certutil.exe Certificate Extraction</p><p><code> (source="<em>WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="</em>WinEventLog:Security" EventCode="4688") AND Image= "C:\Windows\System32\certutil.exe" AND CommandLine= "<em> -exportPFX </em>") </code></p>

                    </td>
            </tr>
            <tr class="datasource" id="uses-DS0002">
                <td>
                    <a href="/datasources/DS0002">DS0002</a>
                </td>
                <td class="nowrap">
                    <a href="/datasources/DS0002">User Account</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0002/#User%20Account%20Authentication">User Account Authentication</a>
                </td>
                    <td>
                                <p>Monitor for user authentication attempts, when requesting access tokens to services, that failed because of Conditional Access Policies (CAP). Some SAML tokens features, such as the location of a user, may not be as easy to claim.</p>

                    </td>
            </tr>
            <tr class="datasource" id="uses-DS0006">
                <td>
                    <a href="/datasources/DS0006">DS0006</a>
                </td>
                <td class="nowrap">
                    <a href="/datasources/DS0006">Web Credential</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0006/#Web%20Credential%20Creation">Web Credential Creation</a>
                </td>
                    <td>
                                <p>Monitor for creation of access tokens using SAML tokens which do not have corresponding 4769 and 1200 events in the domain.<span onclick=scrollToRef('scite-10') id="scite-ref-10-a" class="scite-citeref-number" title="Sygnia. (2020, December). Detection and Hunting of Golden SAML Attack. Retrieved January 6, 2021."data-reference="Sygnia Golden SAML"><sup><a href="https://www.sygnia.co/golden-saml-advisory" target="_blank" data-hasqtip="9" aria-describedby="qtip-9">[10]</a></sup></span></p>

                    </td>
            </tr>
                    <tr class="datacomponent datasource" id="uses-DS0006-Web Credential Usage">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/datasources/DS0006/#Web%20Credential%20Usage">Web Credential Usage</a>
                        </td>
                            <td>
                                        <p>Monitor for the use of access tokens to access services such as email that were created using SAML tokens which do not have corresponding 1202 events (i.e. "The Federation Service validated a new credential") in the domain.<span onclick=scrollToRef('scite-10') id="scite-ref-10-a" class="scite-citeref-number" title="Sygnia. (2020, December). Detection and Hunting of Golden SAML Attack. Retrieved January 6, 2021."data-reference="Sygnia Golden SAML"><sup><a href="https://www.sygnia.co/golden-saml-advisory" target="_blank" data-hasqtip="9" aria-describedby="qtip-9">[10]</a></sup></span></p>

                            </td>
                    </tr>
    </tbody>
</table>
</div>


                            <h2 class="pt-3" id="references">References</h2>

        <div class="row">
            <div class="col">
                <ol>
                            
        <li>
            <span  id="scite-1" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-1" href="https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/" target="_blank">
                        Lambert, J. (2020, December 13). Important steps for customers to protect themselves from recent nation-state cyberattacks. Retrieved December 17, 2020.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-2" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-2" href="https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-configurable-token-lifetimes" target="_blank">
                        Microsoft. (2020, December 14). Configurable token lifetimes in Microsoft Identity Platform. Retrieved December 22, 2020.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-3" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-3" href="https://www.cyberark.com/resources/threat-research-blog/golden-saml-newly-discovered-attack-technique-forges-authentication-to-cloud-apps" target="_blank">
                        Reiner, S. (2017, November 21). Golden SAML: Newly Discovered Attack Technique Forges Authentication to Cloud Apps. Retrieved December 17, 2020.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-4" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-4" href="https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/" target="_blank">
                        MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 17, 2020.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-5" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-5" href="https://o365blog.com/aadinternals" target="_blank">
                        Dr. Nestori Syynimaa. (2018, October 25). AADInternals. Retrieved February 18, 2022.
                    </a>
                </span>
            </span>
        </li>


                </ol>
            </div>
            <div class="col">
                    <ol start="6.0">
                                
        <li>
            <span  id="scite-6" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-6" href="https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/" target="_blank">
                        MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 30, 2020.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-7" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-7" href="https://www.secureworks.com/research/threat-profiles/iron-ritual" target="_blank">
                        Secureworks CTU. (n.d.). IRON RITUAL. Retrieved February 24, 2022.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-8" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-8" href="https://www.mandiant.com/resources/blog/remediation-and-hardening-strategies-for-microsoft-365-to-defend-against-unc2452" target="_blank">
                        Mandiant. (2021, January 19). Remediation and Hardening Strategies for Microsoft 365 to Defend Against UNC2452. Retrieved January 22, 2021.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-9" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-9" href="https://www.troopers.de/troopers19/agenda/fpxwmn/" target="_blank">
                        Bierstock, D., Baker, A. (2019, March 21). I am AD FS and So Can You. Retrieved December 17, 2020.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-10" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-10" href="https://www.sygnia.co/golden-saml-advisory" target="_blank">
                        Sygnia. (2020, December). Detection and Hunting of Golden SAML Attack. Retrieved January 6, 2021.
                    </a>
                </span>
            </span>
        </li>


  
                    </ol>
            </div>             
        </div>


                </div>
            </div>
        </div>
    </div>
    
        </div>
    </div>

            <!--stop-indexing-for-search-->
            <!-- search overlay for entire page -- not displayed inline -->
            <div class="overlay search" id="search-overlay" style="display: none;">
    <div class="overlay-inner">
        <!-- text input for searching -->
        <div class="search-header">
            <div class="search-input">
                <input type="text" id="search-input" placeholder="search">
            </div>
            <div class="search-icons">
                <div class="search-parsing-icon spinner-border" style="display: none" id="search-parsing-icon"></div>
                <div class="close-search-icon" id="close-search-icon">&times;</div>
            </div>
        </div>
        <!-- results and controls for loading more results -->
        <div id="search-body" class="search-body">
            <div class="results" id="search-results">
                <!-- content will be appended here on search -->
            </div>
            <div id="load-more-results" class="load-more-results">
                <button class="btn btn-default" id="load-more-results-button">load more results</button>
            </div>
        </div>
    </div>
</div>

        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- footer elements -->
            <footer class="col footer">
                <div class="container-fluid">
                    <div class="row row-footer">
                        <div class="col-2 col-sm-2 col-md-2">
                            <div class="footer-center-responsive my-auto">
                                <a href="https://www.mitre.org" target="_blank" rel="noopener" aria-label="MITRE">
                                    <img src="/theme/images/mitrelogowhiteontrans.gif" class="mitre-logo-wtrans">
                                </a>
                            </div>
                        </div>
                        <div class="col-2 col-sm-2 footer-responsive-break"></div>
                        <div class="footer-link-group">
                            <div class="row row-footer">
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/engage-with-attack/contact" class="footer-link">Contact Us</a></u>
                                </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/legal-and-branding/terms-of-use" class="footer-link">Terms of Use</a></u>
                                </div>
                                    <div class="px-3 col-footer">
                                        <u class="footer-link"><a href="/resources/legal-and-branding/privacy" class="footer-link">Privacy Policy</a></u>
                                    </div>
                                <div class="px-3">
                                    <u class="footer-link"><a href="/resources/changelog.html" class="footer-link" data-toggle="tooltip" data-placement="top" data-html="true" title="ATT&amp;CK content v15.1&#013;Website  v4.1.6">Website Changelog</a></u>
                                </div>
                            </div>
                            <div class="row">
                                <small class="px-3">
                                    &copy;&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.
                                </small>
                            </div>
                        </div>
                        <div class="w-100 p-2 footer-responsive-break"></div>
                            <div class="col pr-4">
                                <div class="footer-float-right-responsive-brand">
                                    <div class="row row-footer row-footer-icon">
                                        <div class="mb-1">
                                            <a href="https://twitter.com/MITREattack" class="btn btn-footer">
                                                <i class="fa-brands fa-x-twitter fa-lg"></i>
                                            </a>
                                            <a href="https://github.com/mitre-attack" class="btn btn-footer">
                                                <i class="fa-brands fa-github fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>


<!--stopindex-->

</div>
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.5.1.min.js"></script>
    <script src="/theme/scripts/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap-select.min.js"></script>
    <script src="/theme/scripts/bootstrap.bundle.min.js"></script>
    <script src="/theme/scripts/site.js?529"></script>
    <script src="/theme/scripts/settings.js?543"></script>
    <script src="/theme/scripts/search_bundle.js"></script>

<!--SCRIPTS-->
<script src="/theme/scripts/resizer.js"></script>

<!--SCRIPTS-->
<script src="/theme/scripts/bootstrap-tourist.js"></script>
<script src="/theme/scripts/settings.js"></script>
    <script src="/theme/scripts/tour/tour-subtechniques.js"></script>
<script src="/theme/scripts/sidebar-load-all.js"></script>
</body>
</html>