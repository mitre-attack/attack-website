<!DOCTYPE html>
<html>
    <head>
        <title>ATT&CK Changes</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf8">
        <style type="text/css">
            table.diff {font-family:Courier; border:medium;}
            .diff_header {background-color:#e0e0e0}
            td.diff_header {text-align:right}
            .diff_next {background-color:#c0c0c0}
            .diff_add {background-color:#aaffaa}
            .diff_chg {background-color:#ffff77}
            .diff_sub {background-color:#ffaaaa}
        </style>
    </head>
    <body>
<h1>ATT&CK Changes Between v8.1 and v8.2</h1><h2>Key</h2>
<ul>
<li>New objects: ATT&amp;CK objects which are only present in the new release.</li>
<li>Major version changes: ATT&amp;CK objects that have a major version change. (e.g. 1.0 → 2.0)</li>
<li>Minor version changes: ATT&amp;CK objects that have a minor version change. (e.g. 1.0 → 1.1)</li>
<li>Other version changes: ATT&amp;CK objects that have a version change of any other kind. (e.g. 1.0 → 1.2)</li>
<li>Patches: ATT&amp;CK objects that have been patched while keeping the version the same. (e.g., 1.0 → 1.0 but something like a typo, a URL, or some metadata was fixed)</li>
<li>Object revocations: ATT&amp;CK objects which are revoked by a different object.</li>
<li>Object deprecations: ATT&amp;CK objects which are deprecated and no longer in use, and not replaced.</li>
<li>Object deletions: ATT&amp;CK objects which are no longer found in the STIX data.</li>
</ul><table class=diff summary=Legends>
    <tr>
        <td>
            <table border= summary=Colors>
                <tr><th>Colors for description field</th></tr>
                <tr><td class=diff_add>Added</td></tr>
                <tr><td class=diff_chg>Changed</td></tr>
                <tr><td class=diff_sub>Deleted</td></tr>
            </table>
        </td>
    </tr>
</table>
<h2>Additional formats</h2>
<p>These ATT&CK Navigator layer files can be uploaded to ATT&CK Navigator manually.</p>
<ul>
    <li><a href="/versions/v17/docs/changelogs/v8.1-v8.2/layer-enterprise.json">Enterprise changes</a></li>
    <li><a href="/versions/v17/docs/changelogs/v8.1-v8.2/layer-mobile.json">Mobile changes</a></li>
    <li><a href="/versions/v17/docs/changelogs/v8.1-v8.2/layer-ics.json">ICS changes</a></li>
</ul>
<p>This JSON file contains the machine readble output used to create this page: <a href="/versions/v17/docs/changelogs/v8.1-v8.2/changelog.json">changelog.json</a></p>
<h2>Techniques</h2><h3>enterprise-attack</h3><details><summary>New Techniques</summary><hr><h4>[T1484.002] Domain Policy Modification: Domain Trust Modification</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: Adversaries may add new domain trusts or modify the properties of existing domain trusts to evade defenses and/or elevate privileges. Domain trust details, such as whether or not a domain is federated, allow authentication and authorization properties to apply between domains for the purpose of accessing shared resources.(Citation: Microsoft - Azure AD Federation) These trust objects may include accounts, credentials, and other authentication material applied to servers, tokens, and domains.

Manipulating the domain trusts may allow an adversary to escalate privileges and/or evade defenses by modifying settings to add objects which they control. For example, this may be used to forge [SAML Tokens](https://attack.mitre.org/techniques/T1606/002), without the need to compromise the signing certificate to forge new credentials. Instead, an adversary can manipulate domain trusts to add their own signing certificate.</p><hr><h4>[T1606] Forge Web Credentials</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: Adversaries may forge credential materials that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies, tokens, or other materials to authenticate and authorize user access.

Adversaries may generate these credential materials in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539), [Steal Application Access Token](https://attack.mitre.org/techniques/T1528), and other similar behaviors in that the credentials are new and forged by the adversary, rather than stolen or intercepted from legitimate users. The generation of web credentials often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values.(Citation: GitHub AWS-ADFS-Credential-Generator)

Once forged, adversaries may use these web credentials to access resources (ex: [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)(Citation: Microsoft SolarWinds Customer Guidance)</p><hr><h4>[T1484.001] Domain Policy Modification: Group Policy Modification</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: Adversaries may modify Group Policy Objects (GPOs) to subvert the intended discretionary access controls for a domain, usually with the intention of escalating privileges on the domain. Group policy allows for centralized management of user and computer settings in Active Directory (AD). GPOs are containers for group policy settings made up of files stored within a predicable network path <code>\\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\Policies\</code>.(Citation: TechNet Group Policy Basics)(Citation: ADSecurity GPO Persistence 2016) 

Like other objects in AD, GPOs have access controls associated with them. By default all user accounts in the domain have permission to read GPOs. It is possible to delegate GPO access control permissions, e.g. write access, to specific users or groups in the domain.

Malicious GPO modifications can be used to implement many other malicious behaviors such as [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001), [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105), [Create Account](https://attack.mitre.org/techniques/T1136), [Service Execution](https://attack.mitre.org/techniques/T1035),  and more.(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions)(Citation: Mandiant M Trends 2016)(Citation: Microsoft Hacking Team Breach) Since GPOs can control so many user and machine settings in the AD environment, there are a great number of potential attacks that can stem from this GPO abuse.(Citation: Wald0 Guide to GPOs)

For example, publicly available scripts such as <code>New-GPOImmediateTask</code> can be leveraged to automate the creation of a malicious [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) by modifying GPO settings, in this case modifying <code>&lt;GPO_PATH&gt;\Machine\Preferences\ScheduledTasks\ScheduledTasks.xml</code>.(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions) In some cases an adversary might modify specific user rights like SeEnableDelegationPrivilege, set in <code>&lt;GPO_PATH&gt;\MACHINE\Microsoft\Windows NT\SecEdit\GptTmpl.inf</code>, to achieve a subtle AD backdoor with complete control of the domain because the user account under the adversary's control would then be able to modify GPOs.(Citation: Harmj0y SeEnableDelegationPrivilege Right)</p><hr><h4>[T1606.002] Forge Web Credentials: SAML Tokens</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: An adversary may forge SAML tokens with any permissions claims and lifetimes if they possess a valid SAML token-signing certificate.(Citation: Microsoft SolarWinds Steps) The default lifetime of a SAML token is one hour, but the validity period can be specified in the <code>NotOnOrAfter</code> value of the <code>conditions ...</code> element in a token. This value can be changed using the <code>AccessTokenLifetime</code> in a <code>LifetimeTokenPolicy</code>.(Citation: Microsoft SAML Token Lifetimes) Forged SAML tokens enable adversaries to authenticate across services that use SAML 2.0 as an SSO (single sign-on) mechanism.(Citation: Cyberark Golden SAML)

An adversary may utilize [Private Keys](https://attack.mitre.org/techniques/T1552/004) to compromise an organization's token-signing certificate to create forged SAML tokens. If the adversary has sufficient permissions to establish a new federation trust with their own Active Directory Federation Services (AD FS) server, they may instead generate their own trusted token-signing certificate.(Citation: Microsoft SolarWinds Customer Guidance) This differs from [Steal Application Access Token](https://attack.mitre.org/techniques/T1528) and other similar behaviors in that the tokens are new and forged by the adversary, rather than stolen or intercepted from legitimate users.

An adversary may gain administrative Azure AD privileges if a SAML token is forged which claims to represent a highly privileged account. This may lead to [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Microsoft SolarWinds Customer Guidance)</p><hr><h4>[T1606.001] Forge Web Credentials: Web Cookies</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: Adversaries may forge web cookies that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies to authenticate and authorize user access.

Adversaries may generate these cookies in order to gain access to web resources. This differs from [Steal Web Session Cookie](https://attack.mitre.org/techniques/T1539) and other similar behaviors in that the cookies are new and forged by the adversary, rather than stolen or intercepted from legitimate users. Most common web applications have standardized and documented cookie values that can be generated using provided tools or interfaces.(Citation: Pass The Cookie) The generation of web cookies often requires secret values, such as passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), or other cryptographic seed values.

Once forged, adversaries may use these web cookies to access resources ([Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)), which may bypass multi-factor and other authentication protection mechanisms.(Citation: Volexity SolarWinds)(Citation: Pass The Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)</p></details><details><summary>Major Version Changes</summary><hr><h4>[T1484] Domain Policy Modification</h4><p><b>Current version</b>: 2.0</p><p><b>Version changed from</b>: 1.1 → 2.0</p>
    <table class="diff" id="difflib_chg_to4__top"
           cellspacing="0" cellpadding="0" rules="groups" >
        <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
        <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
        <thead><tr><th class="diff_next"><br /></th><th colspan="2" class="diff_header">Old Description</th><th class="diff_next"><br /></th><th colspan="2" class="diff_header">New Description</th></tr></thead>
        <tbody>
            <tr><td class="diff_next" id="difflib_chg_to4__0"><a href="#difflib_chg_to4__top">t</a></td><td class="diff_header" id="from4_1">1</td><td nowrap="nowrap"><span class="diff_sub">Adversaries&nbsp;may&nbsp;modify&nbsp;Group&nbsp;Policy&nbsp;Objects&nbsp;(GPOs)&nbsp;to&nbsp;subver</span></td><td class="diff_next"><a href="#difflib_chg_to4__top">t</a></td><td class="diff_header" id="to4_1">1</td><td nowrap="nowrap"><span class="diff_add">Adversaries&nbsp;may&nbsp;modify&nbsp;the&nbsp;configuration&nbsp;settings&nbsp;of&nbsp;a&nbsp;domai</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">t&nbsp;the&nbsp;intended&nbsp;discretionary&nbsp;access&nbsp;controls&nbsp;for&nbsp;a&nbsp;domain,&nbsp;u</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">n&nbsp;to&nbsp;evade&nbsp;defenses&nbsp;and/or&nbsp;escalate&nbsp;privileges&nbsp;in&nbsp;domain&nbsp;env</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">sually&nbsp;with&nbsp;the&nbsp;intention&nbsp;of&nbsp;escalating&nbsp;privileges&nbsp;on&nbsp;the&nbsp;do</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">ironments.&nbsp;Domains&nbsp;provide&nbsp;a&nbsp;centralized&nbsp;means&nbsp;of&nbsp;managing&nbsp;h</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">main.&nbsp;Group&nbsp;policy&nbsp;allows&nbsp;for&nbsp;centralized&nbsp;management&nbsp;of&nbsp;user</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">ow&nbsp;computer&nbsp;resources&nbsp;(ex:&nbsp;computers,&nbsp;user&nbsp;accounts)&nbsp;can&nbsp;act</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&nbsp;and&nbsp;computer&nbsp;settings&nbsp;in&nbsp;Active&nbsp;Directory&nbsp;(AD).&nbsp;GPOs&nbsp;are&nbsp;co</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">,&nbsp;and&nbsp;interact&nbsp;with&nbsp;each&nbsp;other,&nbsp;on&nbsp;a&nbsp;network.&nbsp;The&nbsp;policy&nbsp;of&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ntainers&nbsp;for&nbsp;group&nbsp;policy&nbsp;settings&nbsp;made&nbsp;up&nbsp;of&nbsp;files&nbsp;stored&nbsp;w</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">the&nbsp;domain&nbsp;also&nbsp;includes&nbsp;configuration&nbsp;settings&nbsp;that&nbsp;may&nbsp;app</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ithin&nbsp;a&nbsp;predicable&nbsp;network&nbsp;path&nbsp;&lt;code&gt;\\&amp;lt;DOMAIN&amp;gt;\SYSVO</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">ly&nbsp;between&nbsp;domains&nbsp;in&nbsp;a&nbsp;multi-domain/forest&nbsp;environment.&nbsp;Mod</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">L\&amp;lt;DOMAIN&amp;gt;\Policies\&lt;/code&gt;.(Citation:&nbsp;TechNet&nbsp;Group&nbsp;P</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">ifications&nbsp;to&nbsp;domain&nbsp;settings&nbsp;may&nbsp;include&nbsp;altering&nbsp;domain&nbsp;Gr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">olicy&nbsp;Basics)(Citation:&nbsp;ADSecurity&nbsp;GPO&nbsp;Persistence&nbsp;2016)&nbsp;&nbsp;&nbsp;L</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">oup&nbsp;Policy&nbsp;Objects&nbsp;(GPOs)&nbsp;or&nbsp;changing&nbsp;trust&nbsp;settings&nbsp;for&nbsp;dom</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ike&nbsp;other&nbsp;objects&nbsp;in&nbsp;AD,&nbsp;GPOs&nbsp;have&nbsp;access&nbsp;controls&nbsp;associate</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">ains,&nbsp;including&nbsp;federation&nbsp;trusts.&nbsp;&nbsp;With&nbsp;sufficient&nbsp;permissi</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">d&nbsp;with&nbsp;them.&nbsp;By&nbsp;default&nbsp;all&nbsp;user&nbsp;accounts&nbsp;in&nbsp;the&nbsp;domain&nbsp;have</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">ons,&nbsp;adversaries&nbsp;can&nbsp;modify&nbsp;domain&nbsp;policy&nbsp;settings.&nbsp;Since&nbsp;do</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&nbsp;permission&nbsp;to&nbsp;read&nbsp;GPOs.&nbsp;It&nbsp;is&nbsp;possible&nbsp;to&nbsp;delegate&nbsp;GPO&nbsp;acc</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">main&nbsp;configuration&nbsp;settings&nbsp;control&nbsp;many&nbsp;of&nbsp;the&nbsp;interactions</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ess&nbsp;control&nbsp;permissions,&nbsp;e.g.&nbsp;write&nbsp;access,&nbsp;to&nbsp;specific&nbsp;user</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">&nbsp;within&nbsp;the&nbsp;Active&nbsp;Directory&nbsp;(AD)&nbsp;environment,&nbsp;there&nbsp;are&nbsp;a&nbsp;g</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">s&nbsp;or&nbsp;groups&nbsp;in&nbsp;the&nbsp;domain.&nbsp;&nbsp;Malicious&nbsp;GPO&nbsp;modifications&nbsp;can&nbsp;</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">reat&nbsp;number&nbsp;of&nbsp;potential&nbsp;attacks&nbsp;that&nbsp;can&nbsp;stem&nbsp;from&nbsp;this&nbsp;abu</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">be&nbsp;used&nbsp;to&nbsp;implement&nbsp;many&nbsp;other&nbsp;malicious&nbsp;behaviors&nbsp;such&nbsp;as&nbsp;</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">se.&nbsp;Examples&nbsp;of&nbsp;such&nbsp;abuse&nbsp;include&nbsp;modifying&nbsp;GPOs&nbsp;to&nbsp;push&nbsp;a&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">[Scheduled&nbsp;Task/Job](https://attack.mitre.org/techniques/T10</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">malicious&nbsp;[Scheduled&nbsp;Task](https://attack.mitre.org/techniqu</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">53),&nbsp;[Disable&nbsp;or&nbsp;Modify&nbsp;Tools](https://attack.mitre.org/tech</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">es/T1053/005)&nbsp;to&nbsp;computers&nbsp;throughout&nbsp;the&nbsp;domain&nbsp;environment</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">niques/T1562/001),&nbsp;[Ingress&nbsp;Tool&nbsp;Transfer](https://attack.mi</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">(Citation:&nbsp;ADSecurity&nbsp;GPO&nbsp;Persistence&nbsp;2016)(Citation:&nbsp;Wald0&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">tre.org/techniques/T1105),&nbsp;[Create&nbsp;Account](https://attack.m</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">Guide&nbsp;to&nbsp;GPOs)(Citation:&nbsp;Harmj0y&nbsp;Abusing&nbsp;GPO&nbsp;Permissions)&nbsp;or</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">itre.org/techniques/T1136),&nbsp;[Service&nbsp;Execution](https://atta</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">&nbsp;modifying&nbsp;domain&nbsp;trusts&nbsp;to&nbsp;include&nbsp;an&nbsp;adversary&nbsp;controlled&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ck.mitre.org/techniques/T1035),&nbsp;&nbsp;and&nbsp;more.(Citation:&nbsp;ADSecur</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">domain&nbsp;where&nbsp;they&nbsp;can&nbsp;control&nbsp;access&nbsp;tokens&nbsp;that&nbsp;will&nbsp;subseq</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ity&nbsp;GPO&nbsp;Persistence&nbsp;2016)(Citation:&nbsp;Wald0&nbsp;Guide&nbsp;to&nbsp;GPOs)(Cit</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">uently&nbsp;be&nbsp;accepted&nbsp;by&nbsp;victim&nbsp;domain&nbsp;resources.(Citation:&nbsp;Mic</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ation:&nbsp;Harmj0y&nbsp;Abusing&nbsp;GPO&nbsp;Permissions)(Citation:&nbsp;Mandiant&nbsp;M</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">rosoft&nbsp;-&nbsp;Customer&nbsp;Guidance&nbsp;on&nbsp;Recent&nbsp;Nation-State&nbsp;Cyber&nbsp;Atta</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&nbsp;Trends&nbsp;2016)(Citation:&nbsp;Microsoft&nbsp;Hacking&nbsp;Team&nbsp;Breach)&nbsp;Since</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">cks)&nbsp;Adversaries&nbsp;can&nbsp;also&nbsp;change&nbsp;configuration&nbsp;settings&nbsp;with</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&nbsp;GPOs&nbsp;can&nbsp;control&nbsp;so&nbsp;many&nbsp;user&nbsp;and&nbsp;machine&nbsp;settings&nbsp;in&nbsp;the&nbsp;A</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">in&nbsp;the&nbsp;AD&nbsp;environment&nbsp;to&nbsp;implement&nbsp;a&nbsp;[Rogue&nbsp;Domain&nbsp;Controlle</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">D&nbsp;environment,&nbsp;there&nbsp;are&nbsp;a&nbsp;great&nbsp;number&nbsp;of&nbsp;potential&nbsp;attacks</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">r](https://attack.mitre.org/techniques/T1207).&nbsp;&nbsp;Adversaries&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&nbsp;that&nbsp;can&nbsp;stem&nbsp;from&nbsp;this&nbsp;GPO&nbsp;abuse.(Citation:&nbsp;Wald0&nbsp;Guide&nbsp;to</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">may&nbsp;temporarily&nbsp;modify&nbsp;domain&nbsp;policy,&nbsp;carry&nbsp;out&nbsp;a&nbsp;malicious&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&nbsp;GPOs)&nbsp;&nbsp;For&nbsp;example,&nbsp;publicly&nbsp;available&nbsp;scripts&nbsp;such&nbsp;as&nbsp;&lt;cod</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">action(s),&nbsp;and&nbsp;then&nbsp;revert&nbsp;the&nbsp;change&nbsp;to&nbsp;remove&nbsp;suspicious&nbsp;i</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">e&gt;New-GPOImmediateTask&lt;/code&gt;&nbsp;can&nbsp;be&nbsp;leveraged&nbsp;to&nbsp;automate&nbsp;t</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">ndicators.</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">he&nbsp;creation&nbsp;of&nbsp;a&nbsp;malicious&nbsp;[Scheduled&nbsp;Task/Job](https://atta</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ck.mitre.org/techniques/T1053)&nbsp;by&nbsp;modifying&nbsp;GPO&nbsp;settings,&nbsp;in</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&nbsp;this&nbsp;case&nbsp;modifying&nbsp;&lt;code&gt;&amp;lt;GPO_PATH&amp;gt;\Machine\Preferen</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">ces\ScheduledTasks\ScheduledTasks.xml&lt;/code&gt;.(Citation:&nbsp;Wald</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">0&nbsp;Guide&nbsp;to&nbsp;GPOs)(Citation:&nbsp;Harmj0y&nbsp;Abusing&nbsp;GPO&nbsp;Permissions)&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">In&nbsp;some&nbsp;cases&nbsp;an&nbsp;adversary&nbsp;might&nbsp;modify&nbsp;specific&nbsp;user&nbsp;rights</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&nbsp;like&nbsp;SeEnableDelegationPrivilege,&nbsp;set&nbsp;in&nbsp;&lt;code&gt;&amp;lt;GPO_PATH</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">&amp;gt;\MACHINE\Microsoft\Windows&nbsp;NT\SecEdit\GptTmpl.inf&lt;/code&gt;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">,&nbsp;to&nbsp;achieve&nbsp;a&nbsp;subtle&nbsp;AD&nbsp;backdoor&nbsp;with&nbsp;complete&nbsp;control&nbsp;of&nbsp;t</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">he&nbsp;domain&nbsp;because&nbsp;the&nbsp;user&nbsp;account&nbsp;under&nbsp;the&nbsp;adversary's&nbsp;con</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">trol&nbsp;would&nbsp;then&nbsp;be&nbsp;able&nbsp;to&nbsp;modify&nbsp;GPOs.(Citation:&nbsp;Harmj0y&nbsp;Se</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">EnableDelegationPrivilege&nbsp;Right)&nbsp;</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap">&nbsp;</td></tr>
        </tbody>
    </table><p><b>New Mitigations</b>:</p><ul>  <li>M1026: Privileged Account Management</li></ul><p><b>Dropped Mitigations</b>:</p><ul>  <li>T1484: Group Policy Modification Mitigation</li></ul><details><summary>Details</summary><table style='border: 1px solid black;border-collapse: collapse;'><caption>dictionary_item_removed</caption><thead><tr><th style='border: 1px solid black;border-collapse: collapse;'>STIX Field</th><th style='border: 1px solid black;border-collapse: collapse;'>Old value</th><th style='border: 1px solid black;border-collapse: collapse;'>New Value</th></tr></thead><tbody><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_contributors</td><td style='border: 1px solid black;border-collapse: collapse;'>['Itamar Mizrahi, Cymptom', 'Tristan Bennett, Seamless Intelligence']</td><td style='border: 1px solid black;border-collapse: collapse;'></td></tr></tbody></table><table style='border: 1px solid black;border-collapse: collapse;'><caption>values_changed</caption><thead><tr><th style='border: 1px solid black;border-collapse: collapse;'>STIX Field</th><th style='border: 1px solid black;border-collapse: collapse;'>Old value</th><th style='border: 1px solid black;border-collapse: collapse;'>New Value</th></tr></thead><tbody><tr><td style='border: 1px solid black;border-collapse: collapse;'>modified</td><td style='border: 1px solid black;border-collapse: collapse;'>2020-03-26 21:17:41.231000+00:00</td><td style='border: 1px solid black;border-collapse: collapse;'>2021-01-11 19:48:37.680000+00:00</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>name</td><td style='border: 1px solid black;border-collapse: collapse;'>Group Policy Modification</td><td style='border: 1px solid black;border-collapse: collapse;'>Domain Policy Modification</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>description</td><td style='border: 1px solid black;border-collapse: collapse;'>Adversaries may modify Group Policy Objects (GPOs) to subvert the intended discretionary access controls for a domain, usually with the intention of escalating privileges on the domain. Group policy allows for centralized management of user and computer settings in Active Directory (AD). GPOs are containers for group policy settings made up of files stored within a predicable network path <code>\\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\Policies\</code>.(Citation: TechNet Group Policy Basics)(Citation: ADSecurity GPO Persistence 2016) 

Like other objects in AD, GPOs have access controls associated with them. By default all user accounts in the domain have permission to read GPOs. It is possible to delegate GPO access control permissions, e.g. write access, to specific users or groups in the domain.

Malicious GPO modifications can be used to implement many other malicious behaviors such as [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001), [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105), [Create Account](https://attack.mitre.org/techniques/T1136), [Service Execution](https://attack.mitre.org/techniques/T1035),  and more.(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions)(Citation: Mandiant M Trends 2016)(Citation: Microsoft Hacking Team Breach) Since GPOs can control so many user and machine settings in the AD environment, there are a great number of potential attacks that can stem from this GPO abuse.(Citation: Wald0 Guide to GPOs)

For example, publicly available scripts such as <code>New-GPOImmediateTask</code> can be leveraged to automate the creation of a malicious [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) by modifying GPO settings, in this case modifying <code>&lt;GPO_PATH&gt;\Machine\Preferences\ScheduledTasks\ScheduledTasks.xml</code>.(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions) In some cases an adversary might modify specific user rights like SeEnableDelegationPrivilege, set in <code>&lt;GPO_PATH&gt;\MACHINE\Microsoft\Windows NT\SecEdit\GptTmpl.inf</code>, to achieve a subtle AD backdoor with complete control of the domain because the user account under the adversary's control would then be able to modify GPOs.(Citation: Harmj0y SeEnableDelegationPrivilege Right)
</td><td style='border: 1px solid black;border-collapse: collapse;'>Adversaries may modify the configuration settings of a domain to evade defenses and/or escalate privileges in domain environments. Domains provide a centralized means of managing how computer resources (ex: computers, user accounts) can act, and interact with each other, on a network. The policy of the domain also includes configuration settings that may apply between domains in a multi-domain/forest environment. Modifications to domain settings may include altering domain Group Policy Objects (GPOs) or changing trust settings for domains, including federation trusts.

With sufficient permissions, adversaries can modify domain policy settings. Since domain configuration settings control many of the interactions within the Active Directory (AD) environment, there are a great number of potential attacks that can stem from this abuse. Examples of such abuse include modifying GPOs to push a malicious [Scheduled Task](https://attack.mitre.org/techniques/T1053/005) to computers throughout the domain environment(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide to GPOs)(Citation: Harmj0y Abusing GPO Permissions) or modifying domain trusts to include an adversary controlled domain where they can control access tokens that will subsequently be accepted by victim domain resources.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks) Adversaries can also change configuration settings within the AD environment to implement a [Rogue Domain Controller](https://attack.mitre.org/techniques/T1207).

Adversaries may temporarily modify domain policy, carry out a malicious action(s), and then revert the change to remove suspicious indicators.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[1]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>TechNet Group Policy Basics</td><td style='border: 1px solid black;border-collapse: collapse;'>ADSecurity GPO Persistence 2016</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[1]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>srachui. (2012, February 13). Group Policy Basics – Part 1: Understanding the Structure of a Group Policy Object. Retrieved March 5, 2019.</td><td style='border: 1px solid black;border-collapse: collapse;'>Metcalf, S. (2016, March 14). Sneaky Active Directory Persistence #17: Group Policy. Retrieved March 5, 2019.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[1]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://blogs.technet.microsoft.com/musings_of_a_technical_tam/2012/02/13/group-policy-basics-part-1-understanding-the-structure-of-a-group-policy-object/</td><td style='border: 1px solid black;border-collapse: collapse;'>https://adsecurity.org/?p=2716</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[2]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>ADSecurity GPO Persistence 2016</td><td style='border: 1px solid black;border-collapse: collapse;'>Wald0 Guide to GPOs</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[2]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Metcalf, S. (2016, March 14). Sneaky Active Directory Persistence #17: Group Policy. Retrieved March 5, 2019.</td><td style='border: 1px solid black;border-collapse: collapse;'>Robbins, A. (2018, April 2). A Red Teamer’s Guide to GPOs and OUs. Retrieved March 5, 2019.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[2]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://adsecurity.org/?p=2716</td><td style='border: 1px solid black;border-collapse: collapse;'>https://wald0.com/?p=179</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[3]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Wald0 Guide to GPOs</td><td style='border: 1px solid black;border-collapse: collapse;'>Harmj0y Abusing GPO Permissions</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[3]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Robbins, A. (2018, April 2). A Red Teamer’s Guide to GPOs and OUs. Retrieved March 5, 2019.</td><td style='border: 1px solid black;border-collapse: collapse;'>Schroeder, W. (2016, March 17). Abusing GPO Permissions. Retrieved March 5, 2019.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[3]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://wald0.com/?p=179</td><td style='border: 1px solid black;border-collapse: collapse;'>http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[4]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Harmj0y Abusing GPO Permissions</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[4]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Schroeder, W. (2016, March 17). Abusing GPO Permissions. Retrieved March 5, 2019.</td><td style='border: 1px solid black;border-collapse: collapse;'>MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 30, 2020.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[4]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/</td><td style='border: 1px solid black;border-collapse: collapse;'>https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[5]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Mandiant M Trends 2016</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft - Azure Sentinel ADFSDomainTrustMods</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[5]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Mandiant. (2016, February 25). Mandiant M-Trends 2016. Retrieved March 5, 2019.</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft. (2020, December). Azure Sentinel Detections. Retrieved December 30, 2020.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[5]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://www.fireeye.com/content/dam/fireeye-www/current-threats/pdfs/rpt-mtrends-2016.pdf</td><td style='border: 1px solid black;border-collapse: collapse;'>https://github.com/Azure/Azure-Sentinel/blob/master/Detections/AuditLogs/ADFSDomainTrustMods.yaml</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[6]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft Hacking Team Breach</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft 365 Defender Solorigate</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[6]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft Secure Team. (2016, June 1). Hacking Team Breach: A Cyber Jurassic Park. Retrieved March 5, 2019.</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft 365 Defender Team. (2020, December 28). Using Microsoft 365 Defender to protect against Solorigate. Retrieved January 7, 2021.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[6]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://www.microsoft.com/security/blog/2016/06/01/hacking-team-breach-a-cyber-jurassic-park/</td><td style='border: 1px solid black;border-collapse: collapse;'>https://www.microsoft.com/security/blog/2020/12/28/using-microsoft-365-defender-to-coordinate-protection-against-solorigate/</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[7]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Harmj0y SeEnableDelegationPrivilege Right</td><td style='border: 1px solid black;border-collapse: collapse;'>Sygnia Golden SAML</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[7]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Schroeder, W. (2017, January 10). The Most Dangerous User Right You (Probably) Have Never Heard Of. Retrieved March 5, 2019.</td><td style='border: 1px solid black;border-collapse: collapse;'>Sygnia. (2020, December). Detection and Hunting of Golden SAML Attack. Retrieved January 6, 2021.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[7]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>http://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/</td><td style='border: 1px solid black;border-collapse: collapse;'>https://www.sygnia.co/golden-saml-advisory</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_detection</td><td style='border: 1px solid black;border-collapse: collapse;'>It is possible to detect GPO modifications by monitoring directory service changes using Windows event logs. Several events may be logged for such GPO modifications, including:

* Event ID 5136 - A directory service object was modified
* Event ID 5137 - A directory service object was created
* Event ID 5138 - A directory service object was undeleted
* Event ID 5139 - A directory service object was moved
* Event ID 5141 - A directory service object was deleted


GPO abuse will often be accompanied by some other behavior such as [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), which will have events associated with it to detect. Subsequent permission value modifications, like those to SeEnableDelegationPrivilege, can also be searched for in events associated with privileges assigned to new logons (Event ID 4672) and assignment of user rights (Event ID 4704). </td><td style='border: 1px solid black;border-collapse: collapse;'>It may be possible to detect domain policy modifications using Windows event logs. Group policy modifications, for example, may be logged under a variety of Windows event IDs for modifying, creating, undeleting, moving, and deleting directory service objects (Event ID 5136, 5137, 5138, 5139, 5141 respectively). Monitor for modifications to domain trust settings, such as when a user or application modifies the federation settings on the domain or updates domain authentication from Managed to Federated via ActionTypes <code>Set federation settings on domain</code> and <code>Set domain authentication</code>.(Citation: Microsoft - Azure Sentinel ADFSDomainTrustMods)(Citation: Microsoft 365 Defender Solorigate) This may also include monitoring for Event ID 307 which can be correlated to relevant Event ID 510 with the same Instance ID for change details.(Citation: Sygnia Golden SAML)(Citation: CISA SolarWinds Cloud Detection)

Consider monitoring for commands/cmdlets and command-line arguments that may be leveraged to modify domain policy settings.(Citation: Microsoft - Update or Repair Federated domain) Some domain policy modifications, such as changes to federation settings, are likely to be rare.(Citation: Microsoft 365 Defender Solorigate)</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_version</td><td style='border: 1px solid black;border-collapse: collapse;'>1.1</td><td style='border: 1px solid black;border-collapse: collapse;'>2.0</td></tr></tbody></table><table style='border: 1px solid black;border-collapse: collapse;'><caption>iterable_item_added</caption><thead><tr><th style='border: 1px solid black;border-collapse: collapse;'>STIX Field</th><th style='border: 1px solid black;border-collapse: collapse;'>Old value</th><th style='border: 1px solid black;border-collapse: collapse;'>New Value</th></tr></thead><tbody><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references</td><td style='border: 1px solid black;border-collapse: collapse;'></td><td style='border: 1px solid black;border-collapse: collapse;'>{'source_name': 'CISA SolarWinds Cloud Detection', 'description': 'CISA. (2021, January 8). Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments. Retrieved January 8, 2021.', 'url': 'https://us-cert.cisa.gov/ncas/alerts/aa21-008a'}</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references</td><td style='border: 1px solid black;border-collapse: collapse;'></td><td style='border: 1px solid black;border-collapse: collapse;'>{'source_name': 'Microsoft - Update or Repair Federated domain', 'description': 'Microsoft. (2020, September 14). Update or repair the settings of a federated domain in Office 365, Azure, or Intune. Retrieved December 30, 2020.', 'url': 'https://docs.microsoft.com/en-us/office365/troubleshoot/active-directory/update-federated-domain-office-365'}</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_data_sources</td><td style='border: 1px solid black;border-collapse: collapse;'></td><td style='border: 1px solid black;border-collapse: collapse;'>PowerShell logs</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_data_sources</td><td style='border: 1px solid black;border-collapse: collapse;'></td><td style='border: 1px solid black;border-collapse: collapse;'>Process command-line parameters</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_data_sources</td><td style='border: 1px solid black;border-collapse: collapse;'></td><td style='border: 1px solid black;border-collapse: collapse;'>Process monitoring</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_data_sources</td><td style='border: 1px solid black;border-collapse: collapse;'></td><td style='border: 1px solid black;border-collapse: collapse;'>Azure activity logs</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_platforms</td><td style='border: 1px solid black;border-collapse: collapse;'></td><td style='border: 1px solid black;border-collapse: collapse;'>Azure AD</td></tr></tbody></table></details></details><details><summary>Minor Version Changes</summary><hr><h4>[T1098.001] Account Manipulation: Additional Cloud Credentials</h4><p><b>Current version</b>: 2.1</p><p><b>Version changed from</b>: 2.0 → 2.1</p>
    <table class="diff" id="difflib_chg_to3__top"
           cellspacing="0" cellpadding="0" rules="groups" >
        <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
        <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
        <thead><tr><th class="diff_next"><br /></th><th colspan="2" class="diff_header">Old Description</th><th class="diff_next"><br /></th><th colspan="2" class="diff_header">New Description</th></tr></thead>
        <tbody>
            <tr><td class="diff_next" id="difflib_chg_to3__0"><a href="#difflib_chg_to3__top">t</a></td><td class="diff_header" id="from3_1">1</td><td nowrap="nowrap">Adversaries&nbsp;may&nbsp;add&nbsp;adversary-controlled&nbsp;credentials&nbsp;to&nbsp;a&nbsp;cl</td><td class="diff_next"><a href="#difflib_chg_to3__top">t</a></td><td class="diff_header" id="to3_1">1</td><td nowrap="nowrap">Adversaries&nbsp;may&nbsp;add&nbsp;adversary-controlled&nbsp;credentials&nbsp;to&nbsp;a&nbsp;cl</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">oud&nbsp;account&nbsp;to&nbsp;maintain&nbsp;persistent&nbsp;access&nbsp;to&nbsp;victim&nbsp;accounts</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">oud&nbsp;account&nbsp;to&nbsp;maintain&nbsp;persistent&nbsp;access&nbsp;to&nbsp;victim&nbsp;accounts</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">&nbsp;and&nbsp;instances&nbsp;within&nbsp;the&nbsp;environment.&nbsp;&nbsp;Adversaries&nbsp;may&nbsp;add&nbsp;</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">&nbsp;and&nbsp;instances&nbsp;within&nbsp;the&nbsp;environment.&nbsp;&nbsp;Adversaries&nbsp;may&nbsp;add&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">credentials&nbsp;for&nbsp;Azure&nbsp;<span class="diff_chg">Service&nbsp;Principals&nbsp;in&nbsp;addition&nbsp;to&nbsp;exis</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">credentials&nbsp;for&nbsp;<span class="diff_add">Service&nbsp;Principals&nbsp;and&nbsp;Applications&nbsp;in&nbsp;addit</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_chg">ting&nbsp;legitimate&nbsp;credentials(Citation:&nbsp;Create&nbsp;Azure&nbsp;Service&nbsp;P</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">ion&nbsp;to&nbsp;existing&nbsp;legitimate&nbsp;credentials&nbsp;in&nbsp;</span>Azure&nbsp;<span class="diff_chg">AD</span>.(Citation</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_chg">rincipal)&nbsp;to&nbsp;victim&nbsp;Azure&nbsp;accounts</span>.(Citation:&nbsp;<span class="diff_chg">Blue&nbsp;Cloud&nbsp;</span>of<span class="diff_chg">&nbsp;</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">:&nbsp;<span class="diff_chg">Micros</span>of<span class="diff_chg">t&nbsp;SolarWinds&nbsp;Customer&nbsp;Guidance</span>)(Citation:&nbsp;Blue&nbsp;Clo</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_chg">Death</span>)(Citation:&nbsp;Blue&nbsp;Cloud&nbsp;of&nbsp;Death&nbsp;Video)&nbsp;<span class="diff_chg">Azure&nbsp;Service&nbsp;Pr</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">ud&nbsp;of&nbsp;Death<span class="diff_add">)(Citation:&nbsp;Blue&nbsp;Cloud&nbsp;of&nbsp;Death</span>&nbsp;Video)&nbsp;<span class="diff_chg">These&nbsp;cred</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_chg">incipals&nbsp;support</span>&nbsp;both&nbsp;password<span class="diff_sub">&nbsp;and&nbsp;certificate&nbsp;credential</span>s.(</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_chg">entials&nbsp;include</span>&nbsp;both&nbsp;<span class="diff_add">x509&nbsp;keys&nbsp;and&nbsp;</span>passwords.(Citation:&nbsp;<span class="diff_add">Micr</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">Citation:&nbsp;W<span class="diff_chg">hy&nbsp;AAD&nbsp;Service&nbsp;Principals</span>)&nbsp;With&nbsp;sufficient&nbsp;permis</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_add">osoft&nbsp;Solar</span>W<span class="diff_chg">inds&nbsp;Customer&nbsp;Guidance</span>)&nbsp;With&nbsp;sufficient&nbsp;permissi</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">sions,&nbsp;there&nbsp;are&nbsp;a&nbsp;variety&nbsp;of&nbsp;ways&nbsp;to&nbsp;add&nbsp;credentials&nbsp;includ</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">ons,&nbsp;there&nbsp;are&nbsp;a&nbsp;variety&nbsp;of&nbsp;ways&nbsp;to&nbsp;add&nbsp;credentials&nbsp;includin</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">ing&nbsp;the&nbsp;Azure&nbsp;Portal,&nbsp;Azure&nbsp;command&nbsp;line&nbsp;interface,&nbsp;and&nbsp;Azur</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">g&nbsp;the&nbsp;Azure&nbsp;Portal,&nbsp;Azure&nbsp;command&nbsp;line&nbsp;interface,&nbsp;and&nbsp;Azure&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">e&nbsp;or&nbsp;Az&nbsp;<span class="diff_sub">[</span>PowerShell<span class="diff_sub">](https://attack.mitre.org/techniques/T10</span></td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">or&nbsp;Az&nbsp;PowerShell&nbsp;modules.(Citation:&nbsp;Demystifying&nbsp;Azure&nbsp;AD&nbsp;Se</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_sub">59/001)</span>&nbsp;modules.(Citation:&nbsp;Demystifying&nbsp;Azure&nbsp;AD&nbsp;Service&nbsp;Pri</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">rvice&nbsp;Principals)&nbsp;&nbsp;<span class="diff_chg">In&nbsp;in</span>f<span class="diff_chg">rastructure-as-a-service&nbsp;(IaaS)&nbsp;env</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">ncipals)&nbsp;&nbsp;<span class="diff_chg">A</span>f<span class="diff_chg">ter</span>&nbsp;gaining&nbsp;access&nbsp;through&nbsp;[Cloud&nbsp;Accounts](http</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap"><span class="diff_chg">ironments,&nbsp;after</span>&nbsp;gaining&nbsp;access&nbsp;through&nbsp;[Cloud&nbsp;Accounts](htt</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">s://attack.mitre.org/techniques/T1078/004),&nbsp;adversaries&nbsp;may&nbsp;</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">ps://attack.mitre.org/techniques/T1078/004),&nbsp;adversaries&nbsp;may</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">generate&nbsp;or&nbsp;import&nbsp;their&nbsp;own&nbsp;SSH&nbsp;keys&nbsp;using&nbsp;either&nbsp;the&nbsp;&lt;code</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">&nbsp;generate&nbsp;or&nbsp;import&nbsp;their&nbsp;own&nbsp;SSH&nbsp;keys&nbsp;using&nbsp;either&nbsp;the&nbsp;&lt;cod</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">&gt;CreateKeyPair&lt;/code&gt;&nbsp;or&nbsp;&lt;code&gt;ImportKeyPair&lt;/code&gt;&nbsp;API&nbsp;in&nbsp;A</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">e&gt;CreateKeyPair&lt;/code&gt;&nbsp;or&nbsp;&lt;code&gt;ImportKeyPair&lt;/code&gt;&nbsp;API&nbsp;in&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">WS&nbsp;or&nbsp;the&nbsp;&lt;code&gt;gcloud&nbsp;compute&nbsp;os-login&nbsp;ssh-keys&nbsp;add&lt;/code&gt;&nbsp;</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">AWS&nbsp;or&nbsp;the&nbsp;&lt;code&gt;gcloud&nbsp;compute&nbsp;os-login&nbsp;ssh-keys&nbsp;add&lt;/code&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">command&nbsp;in&nbsp;GCP.(Citation:&nbsp;GCP&nbsp;SSH&nbsp;Key&nbsp;Add)&nbsp;This&nbsp;allows&nbsp;persi</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">&nbsp;command&nbsp;in&nbsp;GCP.(Citation:&nbsp;GCP&nbsp;SSH&nbsp;Key&nbsp;Add)&nbsp;This&nbsp;allows&nbsp;pers</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">stent&nbsp;access&nbsp;to&nbsp;instances&nbsp;within&nbsp;the&nbsp;cloud&nbsp;environment&nbsp;witho</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">istent&nbsp;access&nbsp;to&nbsp;instances&nbsp;within&nbsp;the&nbsp;cloud&nbsp;environment&nbsp;with</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">ut&nbsp;further&nbsp;usage&nbsp;of&nbsp;the&nbsp;compromised&nbsp;cloud&nbsp;accounts.(Citation</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">out&nbsp;further&nbsp;usage&nbsp;of&nbsp;the&nbsp;compromised&nbsp;cloud&nbsp;accounts.(Citatio</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">:&nbsp;Expel&nbsp;IO&nbsp;Evil&nbsp;in&nbsp;AWS)(Citation:&nbsp;Expel&nbsp;Behind&nbsp;the&nbsp;Scenes)</td><td class="diff_next"></td><td class="diff_header">></td><td nowrap="nowrap">n:&nbsp;Expel&nbsp;IO&nbsp;Evil&nbsp;in&nbsp;AWS)(Citation:&nbsp;Expel&nbsp;Behind&nbsp;the&nbsp;Scenes)</td></tr>
        </tbody>
    </table><details><summary>Details</summary><table style='border: 1px solid black;border-collapse: collapse;'><caption>values_changed</caption><thead><tr><th style='border: 1px solid black;border-collapse: collapse;'>STIX Field</th><th style='border: 1px solid black;border-collapse: collapse;'>Old value</th><th style='border: 1px solid black;border-collapse: collapse;'>New Value</th></tr></thead><tbody><tr><td style='border: 1px solid black;border-collapse: collapse;'>modified</td><td style='border: 1px solid black;border-collapse: collapse;'>2020-10-05 16:43:27.024000+00:00</td><td style='border: 1px solid black;border-collapse: collapse;'>2020-12-18 14:57:07.625000+00:00</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>description</td><td style='border: 1px solid black;border-collapse: collapse;'>Adversaries may add adversary-controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment.

Adversaries may add credentials for Azure Service Principals in addition to existing legitimate credentials(Citation: Create Azure Service Principal) to victim Azure accounts.(Citation: Blue Cloud of Death)(Citation: Blue Cloud of Death Video) Azure Service Principals support both password and certificate credentials.(Citation: Why AAD Service Principals) With sufficient permissions, there are a variety of ways to add credentials including the Azure Portal, Azure command line interface, and Azure or Az [PowerShell](https://attack.mitre.org/techniques/T1059/001) modules.(Citation: Demystifying Azure AD Service Principals)

After gaining access through [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004), adversaries may generate or import their own SSH keys using either the <code>CreateKeyPair</code> or <code>ImportKeyPair</code> API in AWS or the <code>gcloud compute os-login ssh-keys add</code> command in GCP.(Citation: GCP SSH Key Add) This allows persistent access to instances within the cloud environment without further usage of the compromised cloud accounts.(Citation: Expel IO Evil in AWS)(Citation: Expel Behind the Scenes)</td><td style='border: 1px solid black;border-collapse: collapse;'>Adversaries may add adversary-controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment.

Adversaries may add credentials for Service Principals and Applications in addition to existing legitimate credentials in Azure AD.(Citation: Microsoft SolarWinds Customer Guidance)(Citation: Blue Cloud of Death)(Citation: Blue Cloud of Death Video) These credentials include both x509 keys and passwords.(Citation: Microsoft SolarWinds Customer Guidance) With sufficient permissions, there are a variety of ways to add credentials including the Azure Portal, Azure command line interface, and Azure or Az PowerShell modules.(Citation: Demystifying Azure AD Service Principals)

In infrastructure-as-a-service (IaaS) environments, after gaining access through [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004), adversaries may generate or import their own SSH keys using either the <code>CreateKeyPair</code> or <code>ImportKeyPair</code> API in AWS or the <code>gcloud compute os-login ssh-keys add</code> command in GCP.(Citation: GCP SSH Key Add) This allows persistent access to instances within the cloud environment without further usage of the compromised cloud accounts.(Citation: Expel IO Evil in AWS)(Citation: Expel Behind the Scenes)</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[1]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Create Azure Service Principal</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft SolarWinds Customer Guidance</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[1]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft. (2020, January 8). Create an Azure service principal with Azure CLI. Retrieved January 19, 2020.</td><td style='border: 1px solid black;border-collapse: collapse;'>MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 17, 2020.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[1]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://docs.microsoft.com/en-us/cli/azure/create-an-azure-service-principal-azure-cli?toc=%2Fazure%2Fazure-resource-manager%2Ftoc.json&view=azure-cli-latest</td><td style='border: 1px solid black;border-collapse: collapse;'>https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[4]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Why AAD Service Principals</td><td style='border: 1px solid black;border-collapse: collapse;'>Demystifying Azure AD Service Principals</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[4]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Microsoft. (2019, September 23). Azure Superpowers Lab Manual. Retrieved January 19, 2020.</td><td style='border: 1px solid black;border-collapse: collapse;'>Bellavance, Ned. (2019, July 16). Demystifying Azure AD Service Principals. Retrieved January 19, 2020.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[4]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://github.com/microsoft/AzureSuperpowers/blob/master/docs/AzureSuperpowers.md#why-aad-service-principals</td><td style='border: 1px solid black;border-collapse: collapse;'>https://nedinthecloud.com/2019/07/16/demystifying-azure-ad-service-principals/</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[5]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Demystifying Azure AD Service Principals</td><td style='border: 1px solid black;border-collapse: collapse;'>GCP SSH Key Add</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[5]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Bellavance, Ned. (2019, July 16). Demystifying Azure AD Service Principals. Retrieved January 19, 2020.</td><td style='border: 1px solid black;border-collapse: collapse;'>Google. (n.d.). gcloud compute os-login ssh-keys add. Retrieved October 1, 2020.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[5]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://nedinthecloud.com/2019/07/16/demystifying-azure-ad-service-principals/</td><td style='border: 1px solid black;border-collapse: collapse;'>https://cloud.google.com/sdk/gcloud/reference/compute/os-login/ssh-keys/add</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[6]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>GCP SSH Key Add</td><td style='border: 1px solid black;border-collapse: collapse;'>Expel IO Evil in AWS</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[6]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>Google. (n.d.). gcloud compute os-login ssh-keys add. Retrieved October 1, 2020.</td><td style='border: 1px solid black;border-collapse: collapse;'>A. Randazzo, B. Manahan and S. Lipton. (2020, April 28). Finding Evil in AWS. Retrieved June 25, 2020.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[6]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://cloud.google.com/sdk/gcloud/reference/compute/os-login/ssh-keys/add</td><td style='border: 1px solid black;border-collapse: collapse;'>https://expel.io/blog/finding-evil-in-aws/</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[7]['source_name']</td><td style='border: 1px solid black;border-collapse: collapse;'>Expel IO Evil in AWS</td><td style='border: 1px solid black;border-collapse: collapse;'>Expel Behind the Scenes</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[7]['description']</td><td style='border: 1px solid black;border-collapse: collapse;'>A. Randazzo, B. Manahan and S. Lipton. (2020, April 28). Finding Evil in AWS. Retrieved June 25, 2020.</td><td style='border: 1px solid black;border-collapse: collapse;'>S. Lipton, L. Easterly, A. Randazzo and J. Hencinski. (2020, July 28). Behind the scenes in the Expel SOC: Alert-to-fix in AWS. Retrieved October 1, 2020.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references[7]['url']</td><td style='border: 1px solid black;border-collapse: collapse;'>https://expel.io/blog/finding-evil-in-aws/</td><td style='border: 1px solid black;border-collapse: collapse;'>https://expel.io/blog/behind-the-scenes-expel-soc-alert-aws/</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_detection</td><td style='border: 1px solid black;border-collapse: collapse;'>Monitor Azure Activity Logs for service principal modifications. Monitor for the usage of APIs that create or import SSH keys, particularly by unexpected users or accounts such as the root account.

Monitor for use of credentials at unusual times or to unusual systems or services. This may also correlate with other suspicious activity.</td><td style='border: 1px solid black;border-collapse: collapse;'>Monitor Azure Activity Logs for Service Principal and Application modifications. Monitor for the usage of APIs that create or import SSH keys, particularly by unexpected users or accounts such as the root account.

Monitor for use of credentials at unusual times or to unusual systems or services. This may also correlate with other suspicious activity.</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;'>x_mitre_version</td><td style='border: 1px solid black;border-collapse: collapse;'>2.0</td><td style='border: 1px solid black;border-collapse: collapse;'>2.1</td></tr></tbody></table><table style='border: 1px solid black;border-collapse: collapse;'><caption>iterable_item_removed</caption><thead><tr><th style='border: 1px solid black;border-collapse: collapse;'>STIX Field</th><th style='border: 1px solid black;border-collapse: collapse;'>Old value</th><th style='border: 1px solid black;border-collapse: collapse;'>New Value</th></tr></thead><tbody><tr><td style='border: 1px solid black;border-collapse: collapse;'>external_references</td><td style='border: 1px solid black;border-collapse: collapse;'>{'source_name': 'Expel Behind the Scenes', 'description': 'S. Lipton, L. Easterly, A. Randazzo and J. Hencinski. (2020, July 28). Behind the scenes in the Expel SOC: Alert-to-fix in AWS. Retrieved October 1, 2020.', 'url': 'https://expel.io/blog/behind-the-scenes-expel-soc-alert-aws/'}</td><td style='border: 1px solid black;border-collapse: collapse;'></td></tr></tbody></table></details></details><h2>Software</h2><h3>enterprise-attack</h3><details><summary>New Software</summary><hr><h4>[S0552] AdFind</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: [AdFind](https://attack.mitre.org/software/S0552) is a free command-line query tool that can be used for gathering information from Active Directory.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk and Trickbot January 2019)</p><hr><h4>[S0521] BloodHound</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: [BloodHound](https://attack.mitre.org/software/S0521) is an Active Directory (AD) reconnaissance tool that can reveal hidden relationships and identify attack paths within an AD environment.(Citation: GitHub Bloodhound)(Citation: CrowdStrike BloodHound April 2018)(Citation: FoxIT Wocao December 2019)</p><hr><h4>[S0565] Raindrop</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: [Raindrop](https://attack.mitre.org/software/S0565) is a loader used by [UNC2452](https://attack.mitre.org/groups/G0118) that was discovered on some victim machines during investigations related to the 2020 SolarWinds cyber intrusion. It was discovered in January 2021 and was likely used since at least May 2020.(Citation: Symantec RAINDROP January 2021)(Citation: Microsoft Deep Dive Solorigate January 2021)</p><hr><h4>[S0559] Sunburst</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: [Sunburst](https://attack.mitre.org/software/S0559) is a trojanized DLL designed to fit within the SolarWinds Orion software update framework. It was used by [UNC2452](https://attack.mitre.org/groups/G0118) since at least February 2020.(Citation: SolarWinds Sunburst Sunspot Update January 2021)(Citation: Microsoft Deep Dive Solorigate January 2021)</p><hr><h4>[S0562] Sunspot</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: [Sunspot](https://attack.mitre.org/software/S0562) is an implant that injected the [Sunburst](https://attack.mitre.org/software/S0559) backdoor into the SolarWinds Orion software update framework. It was used by [UNC2452](https://attack.mitre.org/groups/G0118) since at least February 2020.(Citation: CrowdStrike SUNSPOT Implant January 2021) </p><hr><h4>[S0560] Teardrop</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: [Teardrop](https://attack.mitre.org/software/S0560) is a memory-only dropper that was discovered on some victim machines during investigations related to the 2020 SolarWinds cyber intrusion. It was likely used by [UNC2452](https://attack.mitre.org/groups/G0118) since at least May 2020.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Microsoft Deep Dive Solorigate January 2021)</p></details><h2>Groups</h2><h3>enterprise-attack</h3><details><summary>New Groups</summary><hr><h4>[G0118] UNC2452</h4><p><b>Current version</b>: 1.0</p><p><b>Description</b>: [UNC2452](https://attack.mitre.org/groups/G0118) is a suspected Russian state-sponsored threat group responsible for the 2020 SolarWinds software supply chain intrusion.(Citation: FireEye SUNBURST Backdoor December 2020) Victims of this campaign include government, consulting, technology, telecom, and other organizations in North America, Europe, Asia, and the Middle East.(Citation: FireEye SUNBURST Backdoor December 2020) The group also compromised at least one think tank by late 2019.(Citation: Volexity SolarWinds)</p></details>
            </body>
        </html>
        