{"description": "Enterprise techniques used by Kapeka, ATT&CK software S1190 (v1.0)", "name": "Kapeka (S1190)", "domain": "enterprise-attack", "versions": {"layer": "4.5", "attack": "17", "navigator": "5.1.0"}, "techniques": [{"techniqueID": "T1071", "showSubtechniques": true}, {"techniqueID": "T1071.001", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) utilizes HTTP for command and control.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": true}, {"techniqueID": "T1059", "showSubtechniques": true}, {"techniqueID": "T1059.003", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) allows for arbitrary Windows command execution.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": true}, {"techniqueID": "T1132", "showSubtechniques": true}, {"techniqueID": "T1132.001", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) utilizes JSON objects to send and receive information from command and control nodes.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": true}, {"techniqueID": "T1140", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) utilizes obfuscated JSON structures for various data storage and configuration management items.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": false}, {"techniqueID": "T1070", "showSubtechniques": true}, {"techniqueID": "T1070.009", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) will clear registry values used for persistent configuration storage when uninstalled.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": true}, {"techniqueID": "T1036", "showSubtechniques": true}, {"techniqueID": "T1036.008", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) masquerades as a Microsoft Word Add-In file, with the extension `.wll`, but is a malicious DLL file.(Citation: Microsoft KnuckleTouch 2024)(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": true}, {"techniqueID": "T1112", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) writes persistent configuration information to the victim host registry.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": false}, {"techniqueID": "T1106", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) utilizes WinAPI calls to gather victim system information.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": false}, {"techniqueID": "T1027", "showSubtechniques": true}, {"techniqueID": "T1027.013", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) utilizes AES-256 (CBC mode), XOR, and RSA-2048 encryption schemas for various configuration and other objects.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": true}, {"techniqueID": "T1090", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) can identify system proxy settings via `WinHttpGetIEProxyConfigForCurrentUser()` during initialization and utilize these settings for subsequent command and control operations.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": false}, {"techniqueID": "T1012", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) queries registry values for stored configuration information.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": false}, {"techniqueID": "T1053", "showSubtechniques": true}, {"techniqueID": "T1053.005", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) persists via scheduled tasks.(Citation: Microsoft KnuckleTouch 2024)(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": true}, {"techniqueID": "T1218", "showSubtechniques": true}, {"techniqueID": "T1218.011", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) is a Windows DLL file executed via ordinal by `rundll32.exe`.(Citation: Microsoft KnuckleTouch 2024)(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": true}, {"techniqueID": "T1082", "comment": "[Kapeka](https://attack.mitre.org/software/S1190) utilizes WinAPI calls and registry queries to gather system information.(Citation: WithSecure Kapeka 2024)", "score": 1, "color": "#66b1ff", "showSubtechniques": false}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Kapeka", "color": "#66b1ff"}]}