
<!DOCTYPE html>
<html lang='en'>

<head>
        <script src=https://cmp.osano.com/AzyhULTdPkqmy4aDN/83f786b4-d60d-4938-b70a-73afd166380a/osano.js></script>
    <style>
        .osano-cm-widget{display: none;}
    </style>
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62667723-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-62667723-1');
        </script>
        <meta name="google-site-verification" content="2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ"/>

        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1,shrink-to-fit=no'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel='shortcut icon' href='/versions/v18/theme/favicon.ico' type='image/x-icon'>
        <title>Modify Authentication Process: Hybrid Identity, Sub-technique T1556.007 - Enterprise | MITRE ATT&CK&reg;</title>
        <!-- USWDS CSS -->
        <!-- Bootstrap CSS -->
        <link rel='stylesheet' href='/versions/v18/theme/style/vendors/bootstrap.min.css' />
        <link rel='stylesheet' href='/versions/v18/theme/style/vendors/bootstrap-tourist.css' />
        <link rel='stylesheet' href='/versions/v18/theme/style/vendors/bootstrap-select.min.css' />
        <!-- Fontawesome CSS -->
        <link rel="stylesheet" href="/versions/v18/theme/style/vendors/fontawesome-6.5.1/css/fontawesome.min.css"/>
        <link rel="stylesheet" href="/versions/v18/theme/style/vendors/fontawesome-6.5.1/css/brands.min.css"/>
        <link rel="stylesheet" href="/versions/v18/theme/style/vendors/fontawesome-6.5.1/css/solid.min.css"/>
            <link rel="stylesheet" href="/versions/v18/theme/style-attack.css"/>


</head>

<body>

    <div class="container-fluid attack-website-wrapper d-flex flex-column h-100">
        <div class="row sticky-top flex-grow-0 flex-shrink-1">
            <!-- header elements -->
            <header class="col px-0">
                    <nav class='navbar navbar-expand-lg navbar-dark position-static'>
        <a class='navbar-brand' href='/versions/v18/'><img src="/versions/v18/theme/images/mitre_attack_logo.png" class="attack-logo"></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse'
                aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
                <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
            <ul class='nav nav-tabs ml-auto'>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v18/matrices/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Matrices</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v18/matrices/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/versions/v18/matrices/mobile/">Mobile</a>
                <a class="dropdown-item" href="/versions/v18/matrices/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v18/tactics/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Tactics</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v18/tactics/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/versions/v18/tactics/mobile/">Mobile</a>
                <a class="dropdown-item" href="/versions/v18/tactics/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v18/techniques/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Techniques</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v18/techniques/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/versions/v18/techniques/mobile/">Mobile</a>
                <a class="dropdown-item" href="/versions/v18/techniques/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v18/mitigations" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Defenses</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                
<div class="dropright dropdown">
<a class="dropdown-item dropdown-toggle" href="/versions/v18/mitigations/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Mitigations</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/versions/v18/mitigations/enterprise/">Enterprise</a>
            <a class="dropdown-item" href="/versions/v18/mitigations/mobile/">Mobile</a>
            <a class="dropdown-item" href="/versions/v18/mitigations/ics/">ICS</a>
    </div>
</div>

                <a class="dropdown-item" href="/versions/v18/assets">Assets</a>
                
<div class="dropright dropdown">
<a class="dropdown-item dropdown-toggle" href="/versions/v18/detectionstrategies/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Detections</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/versions/v18/detectionstrategies/">Detection Strategies</a>
            <a class="dropdown-item" href="/versions/v18/analytics/">Analytics</a>
            <a class="dropdown-item" href="/versions/v18/datacomponents">Data Components</a>
    </div>
</div>

    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v18/groups" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>CTI</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v18/groups">Groups</a>
                <a class="dropdown-item" href="/versions/v18/software">Software</a>
                <a class="dropdown-item" href="/versions/v18/campaigns">Campaigns</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/resources/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Resources</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/resources/">Get Started</a>
                <a class="dropdown-item" href="/resources/learn-more-about-attack/">Learn More about ATT&CK</a>
                <a class="dropdown-item" href="/resources/attackcon/">ATT&CKcon</a>
                <a class="dropdown-item" href="/resources/attack-data-and-tools/">ATT&CK Data & Tools</a>
                <a class="dropdown-item" href="/resources/faq/">FAQ</a>
                <a class="dropdown-item" href="/resources/engage-with-attack/contact/">Engage with ATT&CK</a>
                <a class="dropdown-item" href="/resources/versions/">Version History</a>
                <a class="dropdown-item" href="/resources/updates/">Updates</a>
                <a class="dropdown-item" href="/resources/legal-and-branding/">Legal & Branding</a>
    </div>


                        </li>
                        <li class="nav-item">
                            <a href="/resources/engage-with-attack/benefactors/"  class="nav-link" ><b>Benefactors</b></a>
                        </li>
                        <li class="nav-item">
                                <a href="https://medium.com/mitre-attack/" target="_blank" class="nav-link">
        <b>Blog</b>&nbsp;
        <img src="/versions/v18/theme/images/external-site.svg" alt="External site" class="external-icon" />
    </a>

                        </li>
                        <li class="nav-item">
                            <button id="search-button" class="btn search-button">Search <div id="search-icon" class="icon-button search-icon"></div></button>
                        </li>
            </ul>
        </div>
    </nav>

            </header>
        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- banner elements -->
            <div class="col px-0">
                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->
                <div class="container-fluid version-banner"><div class="icon-inline baseline mr-1"><img src="/versions/v18/theme/images/icon-warning-24px.svg"></div>Currently viewing <a href="https://github.com/mitre/cti/releases/tag/ATT%26CK-v18.1" target="_blank">ATT&CK v18.1</a> which is the current version of ATT&CK. <a href="/resources/versions/">Learn more about the versioning system</a> or <a href="/">see the live site</a>.</div>
                    <div class="container-fluid d-none">
                        ATT&CK v18 has been released! Check out the <a href='https://medium.com/mitre-attack/attack-v18-8f82d839ee9e'>blog post</a> or <a href='https://attack.mitre.org/resources/updates/'>changelog</a> for more information.

                    </div>
            </div>
        </div>
        <div class="row flex-grow-1 flex-shrink-0">
            <!-- main content elements -->
            <!--start-indexing-for-search-->

 
     
    <div class="sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3" id="v-tab" role="tablist" aria-orientation="vertical">
        <div class="resizer" id="resizer"></div>
<!--stop-indexing-for-search-->
<div id="sidebars"></div>
<!--start-indexing-for-search-->
    </div>

    
     
    <div class="tab-content col-xl-9 pt-4" id="v-tabContent">
        <div class="tab-pane fade show active" id="v-attckmatrix" role="tabpanel" aria-labelledby="v-attckmatrix-tab">
    
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/versions/v18/">Home</a></li>
            <li class="breadcrumb-item"><a href="/versions/v18/techniques/enterprise">Techniques</a></li>
            <li class="breadcrumb-item"><a href="/versions/v18/techniques/enterprise">Enterprise</a></li>
            <li class="breadcrumb-item"><a href="/versions/v18/techniques/T1556">Modify Authentication Process</a></li>
        <li class="breadcrumb-item">Hybrid Identity</li>
    </ol>
    <div class="tab-pane fade show active" id="v-" role="tabpanel" aria-labelledby="v--tab"></div>
    <div class="row">
        <div class="col-xl-12">
            <div class="jumbotron jumbotron-fluid">
                <div class="container-fluid">
                    <h1 id="">
                            <span id="subtechnique-parent-name">Modify Authentication Process:</span>
                        Hybrid Identity
                    </h1>

                        <div class="row">
                            <div class="col-md-8">
                                    <!--stop-indexing-for-search-->
                                    <div class="card-block pb-2">
                                        <div class="card">
                                            <div class="card-header collapsed" id="subtechniques-card-header" data-toggle="collapse" data-target="#subtechniques-card-body" aria-expanded="false" aria-controls="subtechniques-card-body">
                                                    <h5 class="mb-0" id ="sub-techniques">Other sub-techniques of Modify Authentication Process (9)</h5>
                                            </div>
                                            <div id="subtechniques-card-body" class="card-body p-0 collapse" aria-labelledby="subtechniques-card-header">
                                                <table class="table table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">ID</th>
                                                            <th scope="col">Name</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/001/" class="subtechnique-table-item" data-subtechnique_id="T1556.001"> T1556.001 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/001/" class="subtechnique-table-item" data-subtechnique_id="T1556.001"> Domain Controller Authentication </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/002/" class="subtechnique-table-item" data-subtechnique_id="T1556.002"> T1556.002 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/002/" class="subtechnique-table-item" data-subtechnique_id="T1556.002"> Password Filter DLL </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/003/" class="subtechnique-table-item" data-subtechnique_id="T1556.003"> T1556.003 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/003/" class="subtechnique-table-item" data-subtechnique_id="T1556.003"> Pluggable Authentication Modules </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/004/" class="subtechnique-table-item" data-subtechnique_id="T1556.004"> T1556.004 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/004/" class="subtechnique-table-item" data-subtechnique_id="T1556.004"> Network Device Authentication </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/005/" class="subtechnique-table-item" data-subtechnique_id="T1556.005"> T1556.005 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/005/" class="subtechnique-table-item" data-subtechnique_id="T1556.005"> Reversible Encryption </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/006/" class="subtechnique-table-item" data-subtechnique_id="T1556.006"> T1556.006 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/006/" class="subtechnique-table-item" data-subtechnique_id="T1556.006"> Multi-Factor Authentication </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td class="active">
                                                                        T1556.007
                                                                    </td>
                                                                    <td class="active">
                                                                        Hybrid Identity
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/008/" class="subtechnique-table-item" data-subtechnique_id="T1556.008"> T1556.008 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/008/" class="subtechnique-table-item" data-subtechnique_id="T1556.008"> Network Provider DLL </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/009/" class="subtechnique-table-item" data-subtechnique_id="T1556.009"> T1556.009 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v18/techniques/T1556/009/" class="subtechnique-table-item" data-subtechnique_id="T1556.009"> Conditional Access Policies </a>
                                                                    </td>
                                                            </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <!--start-indexing-for-search-->

                                    <div class="description-body">
                                                <p>Adversaries may patch, modify, or otherwise backdoor cloud authentication processes that are tied to on-premises user identities in order to bypass typical authentication mechanisms, access credentials, and enable persistent access to accounts.  </p><p>Many organizations maintain hybrid user and device identities that are shared between on-premises and cloud-based environments. These can be maintained in a number of ways. For example, Microsoft Entra ID includes three options for synchronizing identities between Active Directory and Entra ID<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="Microsoft. (2022, August 26). Choose the right authentication method for your Azure Active Directory hybrid identity solution. Retrieved September 28, 2022."data-reference="Azure AD Hybrid Identity"><sup><a href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/choose-ad-authn" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span>:</p><ul><li>Password Hash Synchronization (PHS), in which a privileged on-premises account synchronizes user password hashes between Active Directory and Entra ID, allowing authentication to Entra ID to take place entirely in the cloud </li><li>Pass Through Authentication (PTA), in which Entra ID authentication attempts are forwarded to an on-premises PTA agent, which validates the credentials against Active Directory </li><li>Active Directory Federation Services (AD FS), in which a trust relationship is established between Active Directory and Entra ID </li></ul><p>AD FS can also be used with other SaaS and cloud platforms such as AWS and GCP, which will hand off the authentication process to AD FS and receive a token containing the hybrid users’ identity and privileges. </p><p>By modifying authentication processes tied to hybrid identities, an adversary may be able to establish persistent privileged access to cloud resources. For example, adversaries who compromise an on-premises server running a PTA agent may inject a malicious DLL into the <code>AzureADConnectAuthenticationAgentService</code> process that authorizes all attempts to authenticate to Entra ID, as well as records user credentials.<span onclick=scrollToRef('scite-2') id="scite-ref-2-a" class="scite-citeref-number" title="Adam Chester. (2019, February 18). Azure AD Connect for Red Teamers. Retrieved September 28, 2022."data-reference="Azure AD Connect for Read Teamers"><sup><a href="https://blog.xpnsec.com/azuread-connect-for-redteam/" target="_blank" data-hasqtip="1" aria-describedby="qtip-1">[2]</a></sup></span><span onclick=scrollToRef('scite-3') id="scite-ref-3-a" class="scite-citeref-number" title="Dr. Nestori Syynimaa. (2020, July 13). Unnoticed sidekick: Getting access to cloud as an on-prem admin. Retrieved September 28, 2022."data-reference="AADInternals Azure AD On-Prem to Cloud"><sup><a href="https://o365blog.com/post/on-prem_admin/" target="_blank" data-hasqtip="2" aria-describedby="qtip-2">[3]</a></sup></span> In environments using AD FS, an adversary may edit the <code>Microsoft.IdentityServer.Servicehost</code> configuration file to load a malicious DLL that generates authentication tokens for any user with any set of claims, thereby bypassing multi-factor authentication and defined AD FS policies.<span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="Microsoft Threat Intelligence Center, Microsoft Detection and Response Team, Microsoft 365 Defender Research Team . (2022, August 24). MagicWeb: NOBELIUM’s post-compromise trick to authenticate as anyone. Retrieved September 28, 2022."data-reference="MagicWeb"><sup><a href="https://www.microsoft.com/security/blog/2022/08/24/magicweb-nobeliums-post-compromise-trick-to-authenticate-as-anyone/" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p><p>In some cases, adversaries may be able to modify the hybrid identity authentication process from the cloud. For example, adversaries who compromise a Global Administrator account in an Entra ID tenant may be able to register a new PTA agent via the web console, similarly allowing them to harvest credentials and log into the Entra ID environment as any user.<span onclick=scrollToRef('scite-5') id="scite-ref-5-a" class="scite-citeref-number" title="Mike Burns. (2020, September 30). Detecting Microsoft 365 and Azure Active Directory Backdoors. Retrieved September 28, 2022."data-reference="Mandiant Azure AD Backdoors"><sup><a href="https://www.mandiant.com/resources/detecting-microsoft-365-azure-active-directory-backdoors" target="_blank" data-hasqtip="4" aria-describedby="qtip-4">[5]</a></sup></span></p>

                                    </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body">
                                            <div class="row card-data" id="card-id">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">ID:&nbsp;</span>T1556.007
                                                </div>
                                            </div>
                                        <!--stop-indexing-for-search-->
                                        <div class="row card-data">
                                            <div class="col-md-1 px-0 text-center"></div>
                                            <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Sub-technique of:&nbsp;</span>
                                                    <a href="/versions/v18/techniques/T1556">T1556</a>
                                            </div>
                                        </div>
                                        <!--start-indexing-for-search-->
                                            <div id="card-tactics" class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="The tactic objectives that the (sub-)technique can be used to accomplish">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Tactics:</span>
                                                        <a href="/versions/v18/tactics/TA0006">Credential Access</a>,                                                        <a href="/versions/v18/tactics/TA0005">Defense Evasion</a>,                                                        <a href="/versions/v18/tactics/TA0003">Persistence</a>                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="The system an adversary is operating within; could be an operating system or application">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Platforms:&nbsp;</span>IaaS, Identity Provider, Office Suite, SaaS, Windows
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Contributors:&nbsp;</span>Praetorian
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Version:&nbsp;</span>1.1
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Created:&nbsp;</span>28 September 2022
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Last Modified:&nbsp;</span>15 April 2025
                                                </div>
                                            </div>
                                    </div>
                                </div>
                                    <div class="text-center pt-2 version-button permalink">
    <div class="live">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Permalink to this version of T1556.007" 
           href="/versions/v18/techniques/T1556/007/" data-test-ignore="true">Version Permalink</a>
    </div>
    <div class="permalink">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Go to the live version of T1556.007" 
           href="/techniques/T1556/007/" data-test-ignore="true">Live Version</a><!--do not change this line without also changing versions.py-->
    </div>
</div>

                            </div>
                        </div>
                            <h2 class="pt-3" id ="examples">Procedure Examples</h2>
                            <div class="tables-mobile">
                            <table class="table table-bordered table-alternate mt-2">
                                <thead>
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">Name</th>
                                        <th scope="col">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                <a href="/versions/v18/software/S0677"> S0677 </a>
                                            </td>
                                            <td>
                                                <a href="/versions/v18/software/S0677"> AADInternals </a>
                                            </td>
                                            <td>
                                                            <p><a href="/versions/v18/software/S0677">AADInternals</a> can inject a malicious DLL (<code>PTASpy</code>) into the <code>AzureADConnectAuthenticationAgentService</code> to backdoor Azure AD Pass-Through Authentication.<span onclick=scrollToRef('scite-3') id="scite-ref-3-a" class="scite-citeref-number" title="Dr. Nestori Syynimaa. (2020, July 13). Unnoticed sidekick: Getting access to cloud as an on-prem admin. Retrieved September 28, 2022."data-reference="AADInternals Azure AD On-Prem to Cloud"><sup><a href="https://o365blog.com/post/on-prem_admin/" target="_blank" data-hasqtip="2" aria-describedby="qtip-2">[3]</a></sup></span></p>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <a href="/versions/v18/groups/G0016"> G0016 </a>
                                            </td>
                                            <td>
                                                <a href="/versions/v18/groups/G0016"> APT29 </a>
                                            </td>
                                            <td>
                                                            <p><a href="/versions/v18/groups/G0016">APT29</a> has edited the <code>Microsoft.IdentityServer.Servicehost.exe.config</code> file to load a malicious DLL into the AD FS process, thereby enabling persistent access to any service federated with AD FS for a user with a specified User Principal Name.<span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="Microsoft Threat Intelligence Center, Microsoft Detection and Response Team, Microsoft 365 Defender Research Team . (2022, August 24). MagicWeb: NOBELIUM’s post-compromise trick to authenticate as anyone. Retrieved September 28, 2022."data-reference="MagicWeb"><sup><a href="https://www.microsoft.com/security/blog/2022/08/24/magicweb-nobeliums-post-compromise-trick-to-authenticate-as-anyone/" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p>

                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                            </div>
                            <h2 class="pt-3" id ="mitigations">Mitigations</h2>
                            <div class="tables-mobile">
                                <table class="table table-bordered table-alternate mt-2">
                                    <thead>
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Mitigation</th>
                                            <th scope="col">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v18/mitigations/M1047"> M1047 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v18/mitigations/M1047"> Audit </a>
                                                </td>
                                                <td>
                                                                <p>Periodically review the hybrid identity solution in use for any discrepancies. For example, review all PTA agents in the Entra ID Management Portal to identify any unwanted or unapproved ones.<span onclick=scrollToRef('scite-5') id="scite-ref-5-a" class="scite-citeref-number" title="Mike Burns. (2020, September 30). Detecting Microsoft 365 and Azure Active Directory Backdoors. Retrieved September 28, 2022."data-reference="Mandiant Azure AD Backdoors"><sup><a href="https://www.mandiant.com/resources/detecting-microsoft-365-azure-active-directory-backdoors" target="_blank" data-hasqtip="4" aria-describedby="qtip-4">[5]</a></sup></span> If ADFS is in use, review DLLs and executable files in the AD FS and Global Assembly Cache directories to ensure that they are signed by Microsoft. Note that in some cases binaries may be catalog-signed, which may cause the file to appear unsigned when viewing file properties.<span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="Microsoft Threat Intelligence Center, Microsoft Detection and Response Team, Microsoft 365 Defender Research Team . (2022, August 24). MagicWeb: NOBELIUM’s post-compromise trick to authenticate as anyone. Retrieved September 28, 2022."data-reference="MagicWeb"><sup><a href="https://www.microsoft.com/security/blog/2022/08/24/magicweb-nobeliums-post-compromise-trick-to-authenticate-as-anyone/" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v18/mitigations/M1032"> M1032 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v18/mitigations/M1032"> Multi-factor Authentication </a>
                                                </td>
                                                <td>
                                                                <p>Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs. </p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v18/mitigations/M1026"> M1026 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v18/mitigations/M1026"> Privileged Account Management </a>
                                                </td>
                                                <td>
                                                                <p>Limit on-premises accounts with access to the hybrid identity solution in place. For example, limit Entra ID Global Administrator accounts to only those required, and ensure that these are dedicated cloud-only accounts rather than hybrid ones.<span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="Microsoft Threat Intelligence Center, Microsoft Detection and Response Team, Microsoft 365 Defender Research Team . (2022, August 24). MagicWeb: NOBELIUM’s post-compromise trick to authenticate as anyone. Retrieved September 28, 2022."data-reference="MagicWeb"><sup><a href="https://www.microsoft.com/security/blog/2022/08/24/magicweb-nobeliums-post-compromise-trick-to-authenticate-as-anyone/" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p>

                                                </td>
                                            </tr>
                                    </tbody>
                                </table>
                                </div>
                                <h2 class="pt-3" id="detection">Detection Strategy</h2>
                                <div class="tables-mobile">
<table class="table datasources-table table-bordered">
    <thead>
        <tr>
            <th class="p-2" scope="col">ID</th>
            <th class="p-2 nowrap" scope="col">Name</th>
            <th class="p-2 nowrap" scope="col">Analytic ID</th>
            <th class="p-2 nowrap" scope="col">Analytic Description</th>
        </tr>
    </thead>
    <tbody>
                <tr class="detection_strategy" id="uses-DET0293">
                        <td rowspan="5">
                            <a href="/versions/v18/detectionstrategies/DET0293">DET0293</a>
                        </td>
                        <td rowspan="5">
                            <a href="/versions/v18/detectionstrategies/DET0293">Detect Hybrid Identity Authentication Process Modification</a>
                        </td>
                    <td>
                        <a href="/versions/v18/detectionstrategies/DET0293#AN0814">AN0814</a>
                    </td>
                    <td>
                                <p>Detects injection or tampering of DLLs in hybrid identity agents (e.g., AzureADConnectAuthenticationAgentService), registry or configuration changes tied to PTA/AD FS, and anomalous LSASS or AD FS module loads correlated with authentication anomalies.</p>
</a>
                    </td>
                </tr>
                <tr class="detection_strategy" id="uses-DET0293">
                    <td>
                        <a href="/versions/v18/detectionstrategies/DET0293#AN0815">AN0815</a>
                    </td>
                    <td>
                                <p>Detects registration of new PTA agents, conditional access changes disabling hybrid MFA enforcement, or suspicious updates to AD FS token-signing configurations.</p>
</a>
                    </td>
                </tr>
                <tr class="detection_strategy" id="uses-DET0293">
                    <td>
                        <a href="/versions/v18/detectionstrategies/DET0293#AN0816">AN0816</a>
                    </td>
                    <td>
                                <p>Detects API calls registering or updating hybrid identity connectors, modification of cloud-to-on-premises federation trust, and unusual token issuance logs.</p>
</a>
                    </td>
                </tr>
                <tr class="detection_strategy" id="uses-DET0293">
                    <td>
                        <a href="/versions/v18/detectionstrategies/DET0293#AN0817">AN0817</a>
                    </td>
                    <td>
                                <p>Detects tenant-wide authentication or conditional access changes that weaken hybrid identity enforcement, including disabling AD FS or bypassing hybrid MFA policies.</p>
</a>
                    </td>
                </tr>
                <tr class="detection_strategy" id="uses-DET0293">
                    <td>
                        <a href="/versions/v18/detectionstrategies/DET0293#AN0818">AN0818</a>
                    </td>
                    <td>
                                <p>Detects suspicious changes to SAML/OAuth federation configurations, such as new signing certificates, altered endpoints, or claims issuance rules granting elevated privileges.</p>
</a>
                    </td>
                </tr>
    </tbody>
</table>
</div>


                            <h2 class="pt-3" id="references">References</h2>

        <div class="row">
            <div class="col">
                <ol>
                            
        <li>
            <span  id="scite-1" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-1" href="https://learn.microsoft.com/en-us/azure/active-directory/hybrid/choose-ad-authn" target="_blank">
                        Microsoft. (2022, August 26). Choose the right authentication method for your Azure Active Directory hybrid identity solution. Retrieved September 28, 2022.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-2" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-2" href="https://blog.xpnsec.com/azuread-connect-for-redteam/" target="_blank">
                        Adam Chester. (2019, February 18). Azure AD Connect for Red Teamers. Retrieved September 28, 2022.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-3" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-3" href="https://o365blog.com/post/on-prem_admin/" target="_blank">
                        Dr. Nestori Syynimaa. (2020, July 13). Unnoticed sidekick: Getting access to cloud as an on-prem admin. Retrieved September 28, 2022.
                    </a>
                </span>
            </span>
        </li>


                </ol>
            </div>
            <div class="col">
                    <ol start="4.0">
                                
        <li>
            <span  id="scite-4" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-4" href="https://www.microsoft.com/security/blog/2022/08/24/magicweb-nobeliums-post-compromise-trick-to-authenticate-as-anyone/" target="_blank">
                        Microsoft Threat Intelligence Center, Microsoft Detection and Response Team, Microsoft 365 Defender Research Team . (2022, August 24). MagicWeb: NOBELIUM’s post-compromise trick to authenticate as anyone. Retrieved September 28, 2022.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-5" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-5" href="https://www.mandiant.com/resources/detecting-microsoft-365-azure-active-directory-backdoors" target="_blank">
                        Mike Burns. (2020, September 30). Detecting Microsoft 365 and Azure Active Directory Backdoors. Retrieved September 28, 2022.
                    </a>
                </span>
            </span>
        </li>


  
                    </ol>
            </div>             
        </div>


                </div>
            </div>
        </div>
    </div>
    
        </div>
    </div>

            <!--stop-indexing-for-search-->
            <!-- search overlay for entire page -- not displayed inline -->
            <div class="overlay search" id="search-overlay" style="display: none;">
    <div class="overlay-inner">
        <!-- text input for searching -->
        <div class="search-header">
            <div class="search-input">
                <input type="text" id="search-input" placeholder="search">
            </div>
            <div class="search-icons">
                <div class="search-parsing-icon spinner-border" style="display: none" id="search-parsing-icon"></div>
                <div class="close-search-icon" id="close-search-icon">&times;</div>
            </div>
        </div>
        <!-- results and controls for loading more results -->
        <div id="search-body" class="search-body">
            <div class="results" id="search-results">
                <!-- content will be appended here on search -->
            </div>
            <div id="load-more-results" class="load-more-results">
                <button class="btn btn-default" id="load-more-results-button">load more results</button>
            </div>
        </div>
    </div>
</div>

        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- footer elements -->
            <footer class="col footer">
                <div class="container-fluid">
                    <div class="row row-footer">
                        <div class="col-2 col-sm-2 col-md-2">
                            <div class="footer-center-responsive my-auto">
                                <a href="https://www.mitre.org" target="_blank" rel="noopener" aria-label="MITRE">
                                    <img src="/versions/v18/theme/images/mitrelogowhiteontrans.gif" class="mitre-logo-wtrans">
                                </a>
                            </div>
                        </div>
                        <div class="col-2 col-sm-2 footer-responsive-break"></div>
                        <div class="footer-link-group">
                            <div class="row row-footer">
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/engage-with-attack/contact" class="footer-link">Contact Us</a></u>
                                </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/legal-and-branding/terms-of-use" class="footer-link">Terms of Use</a></u>
                                </div>
                                    <div class="px-3 col-footer">
                                        <u class="footer-link"><a href="/resources/legal-and-branding/privacy" class="footer-link">Privacy Policy</a></u>
                                    </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/resources/changelog.html" class="footer-link" data-toggle="tooltip" data-placement="top" data-html="true" title="ATT&amp;CK content v18.1&#013;Website  v4.4.1">Website Changelog</a></u>
                                </div>
                                <div class="px-3">
                                    <u class="footer-link"><a href="/resources/legal-and-branding/privacy/#" class="footer-link" onclick="Osano.cm.showDrawer('osano-cm-dom-info-dialog-open')">Cookie Preferences</a></u>
                                </div>
                            </div>
                            <div class="row">
                                <small class="px-3">
                                    &copy;&nbsp;2015&nbsp;-&nbsp;2025, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.
                                </small>
                            </div>
                        </div>
                        <div class="w-100 p-2 footer-responsive-break"></div>
                            <div class="col pr-4">
                                <div class="footer-float-right-responsive-brand">
                                    <div class="row row-footer row-footer-icon">
                                        <div class="mb-1">
                                            <a href="https://x.com/MITREattack" class="btn btn-footer">
                                                <i class="fa-brands fa-x-twitter fa-lg"></i>
                                            </a>
                                            <a href="https://github.com/mitre-attack" class="btn btn-footer">
                                                <i class="fa-brands fa-github fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>


<!--stopindex-->

</div>
    <!--SCRIPTS-->
    <script src="/versions/v18/theme/scripts/jquery-3.5.1.min.js"></script>
    <script src="/versions/v18/theme/scripts/popper.min.js"></script>
    <script src="/versions/v18/theme/scripts/bootstrap-select.min.js"></script>
    <script src="/versions/v18/theme/scripts/bootstrap.bundle.min.js"></script>
    <script src="/versions/v18/theme/scripts/site.js"></script>
    <script src="/versions/v18/theme/scripts/settings.js"></script>
    <script src="/versions/v18/theme/scripts/search_bundle.js"></script>

<!--SCRIPTS-->
<script src="/versions/v18/theme/scripts/resizer.js"></script>

<!--SCRIPTS-->
<script src="/versions/v18/theme/scripts/bootstrap-tourist.js"></script>
<script src="/versions/v18/theme/scripts/settings.js"></script>
    <script src="/versions/v18/theme/scripts/tour/tour-subtechniques.js"></script>
<script src="/versions/v18/theme/scripts/sidebar-load-all.js"></script>
</body>
</html>