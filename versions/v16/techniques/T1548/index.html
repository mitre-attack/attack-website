
<!DOCTYPE html>
<html lang='en'>

<head>
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62667723-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-62667723-1');
        </script>
        <meta name="google-site-verification" content="2oJKLqNN62z6AOCb0A0IXGtbQuj-lev5YPAHFF_cbHQ"/>

        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1,shrink-to-fit=no'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel='shortcut icon' href="/versions/v16/theme/favicon.ico" type='image/x-icon'>
        <title>Abuse Elevation Control Mechanism, Technique T1548 - Enterprise | MITRE ATT&CK&reg;</title>
        <!-- USWDS CSS -->
        <!-- Bootstrap CSS -->
        <link rel='stylesheet' href="/versions/v16/theme/style/bootstrap.min.css" />
        <link rel='stylesheet' href="/versions/v16/theme/style/bootstrap-tourist.css" />
        <link rel='stylesheet' href="/versions/v16/theme/style/bootstrap-select.min.css" />
        <!-- Fontawesome CSS -->
        <link rel="stylesheet" href="/versions/v16/theme/style/fontawesome-6.5.1/css/fontawesome.min.css"/>
        <link rel="stylesheet" href="/versions/v16/theme/style/fontawesome-6.5.1/css/brands.min.css"/>
        <link rel="stylesheet" href="/versions/v16/theme/style/fontawesome-6.5.1/css/solid.min.css"/>
        <link rel="stylesheet" type="text/css" href="/versions/v16/theme/style.min.css?6689c2db">

</head>

<body>

    <div class="container-fluid attack-website-wrapper d-flex flex-column h-100">
        <div class="row sticky-top flex-grow-0 flex-shrink-1">
            <!-- header elements -->
            <header class="col px-0">
                    <nav class='navbar navbar-expand-lg navbar-dark position-static'>
        <a class='navbar-brand' href="/versions/v16/"><img src="/versions/v16/theme/images/mitre_attack_logo.png" class="attack-logo"></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse'
                aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
                <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
            <ul class='nav nav-tabs ml-auto'>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v16/matrices/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Matrices</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v16/matrices/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/versions/v16/matrices/mobile/">Mobile</a>
                <a class="dropdown-item" href="/versions/v16/matrices/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v16/tactics/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Tactics</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v16/tactics/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/versions/v16/tactics/mobile/">Mobile</a>
                <a class="dropdown-item" href="/versions/v16/tactics/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v16/techniques/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Techniques</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v16/techniques/enterprise/">Enterprise</a>
                <a class="dropdown-item" href="/versions/v16/techniques/mobile/">Mobile</a>
                <a class="dropdown-item" href="/versions/v16/techniques/ics/">ICS</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v16/datasources" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Defenses</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v16/datasources">Data Sources</a>
                
<div class="dropright dropdown">
<a class="dropdown-item dropdown-toggle" href="/versions/v16/mitigations/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Mitigations</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/versions/v16/mitigations/enterprise/">Enterprise</a>
            <a class="dropdown-item" href="/versions/v16/mitigations/mobile/">Mobile</a>
            <a class="dropdown-item" href="/versions/v16/mitigations/ics/">ICS</a>
    </div>
</div>

                <a class="dropdown-item" href="/versions/v16/assets">Assets</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v16/groups" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>CTI</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v16/groups">Groups</a>
                <a class="dropdown-item" href="/versions/v16/software">Software</a>
                <a class="dropdown-item" href="/versions/v16/campaigns">Campaigns</a>
    </div>


                        </li>
                        <li class="nav-item dropdown">
                                
    <a class="nav-link dropdown-toggle" href="/versions/v16/resources/" id="navbarDropdown" role="button"
    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <b>Resources</b>
    </a>
    <div class="dropdown-menu " aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="/versions/v16/resources/">Get Started</a>
                <a class="dropdown-item" href="/versions/v16/resources/learn-more-about-attack/">Learn More about ATT&CK</a>
                <a class="dropdown-item" href="/versions/v16/resources/attackcon/">ATT&CKcon</a>
                <a class="dropdown-item" href="/versions/v16/resources/attack-data-and-tools/">ATT&CK Data & Tools</a>
                <a class="dropdown-item" href="/versions/v16/resources/faq/">FAQ</a>
                <a class="dropdown-item" href="/versions/v16/resources/engage-with-attack/contact/">Engage with ATT&CK</a>
                <a class="dropdown-item" href="/resources/versions/">Version History</a>
                <a class="dropdown-item" href="/versions/v16/resources/legal-and-branding/">Legal & Branding</a>
    </div>


                        </li>
                        <li class="nav-item">
                            <a href="/versions/v16/resources/engage-with-attack/benefactors/"  class="nav-link" ><b>Benefactors</b></a>
                        </li>
                        <li class="nav-item">
                                <a href="https://medium.com/mitre-attack/" target="_blank" class="nav-link">
        <b>Blog</b>&nbsp;
        <img src="/versions/v16/theme/images/external-site.svg" alt="External site" class="external-icon" />
    </a>

                        </li>
                        <li class="nav-item">
                            <button id="search-button" class="btn search-button">Search <div id="search-icon" class="icon-button search-icon"></div></button>
                        </li>
            </ul>
        </div>
    </nav>

            </header>
        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- banner elements -->
            <div class="col px-0">
                <!-- don't edit or remove the line below even though it's commented out, it gets parsed and replaced by the versioning feature -->
                <div class="container-fluid version-banner"><div class="icon-inline baseline mr-1"><img src="/versions/v16/theme/images/icon-warning-24px.svg"></div>Currently viewing <a href="https://github.com/mitre/cti/releases/tag/ATT%26CK-v16.1" target="_blank">ATT&CK v16.1</a> which is the current version of ATT&CK. <a href="/resources/versions/">Learn more about the versioning system</a> or <a href="/">see the live site</a>.</div>
                    <div class="container-fluid d-none">
                        Reminder: the TAXII 2.0 server will be <a href='https://medium.com/mitre-attack/introducing-taxii-2-1-and-a-fond-farewell-to-taxii-2-0-d9fca6ce4c58'>retiring on December 18</a>. Please switch to the <a href='https://github.com/mitre-attack/attack-workbench-taxii-server/blob/main/docs/USAGE.md'>TAXII 2.1 server</a> to ensure uninterrupted service.
                    </div>
            </div>
        </div>
        <div class="row flex-grow-1 flex-shrink-0">
            <!-- main content elements -->
            <!--start-indexing-for-search-->

 
     
    <div class="sidebar nav sticky-top flex-column pr-0 pt-4 pb-3 pl-3" id="v-tab" role="tablist" aria-orientation="vertical">
        <div class="resizer" id="resizer"></div>
<!--stop-indexing-for-search-->
<div id="sidebars"></div>
<!--start-indexing-for-search-->
    </div>

    
     
    <div class="tab-content col-xl-9 pt-4" id="v-tabContent">
        <div class="tab-pane fade show active" id="v-attckmatrix" role="tabpanel" aria-labelledby="v-attckmatrix-tab">
    
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/versions/v16/">Home</a></li>
            <li class="breadcrumb-item"><a href="/versions/v16/techniques/enterprise">Techniques</a></li>
            <li class="breadcrumb-item"><a href="/versions/v16/techniques/enterprise">Enterprise</a></li>
        <li class="breadcrumb-item">Abuse Elevation Control Mechanism</li>
    </ol>
    <div class="tab-pane fade show active" id="v-" role="tabpanel" aria-labelledby="v--tab"></div>
    <div class="row">
        <div class="col-xl-12">
            <div class="jumbotron jumbotron-fluid">
                <div class="container-fluid">
                    <h1 id="">
                        Abuse Elevation Control Mechanism
                    </h1>

                        <div class="row">
                            <div class="col-md-8">
                                    <!--stop-indexing-for-search-->
                                    <div class="card-block pb-2">
                                        <div class="card">
                                            <div class="card-header collapsed" id="subtechniques-card-header" data-toggle="collapse" data-target="#subtechniques-card-body" aria-expanded="false" aria-controls="subtechniques-card-body">
                                                    <h5 class="mb-0" id ="sub-techniques">Sub-techniques (6)</h5>
                                            </div>
                                            <div id="subtechniques-card-body" class="card-body p-0 collapse" aria-labelledby="subtechniques-card-header">
                                                <table class="table table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th scope="col">ID</th>
                                                            <th scope="col">Name</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/001/" class="subtechnique-table-item" data-subtechnique_id="T1548.001"> T1548.001 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/001/" class="subtechnique-table-item" data-subtechnique_id="T1548.001"> Setuid and Setgid </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/002/" class="subtechnique-table-item" data-subtechnique_id="T1548.002"> T1548.002 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/002/" class="subtechnique-table-item" data-subtechnique_id="T1548.002"> Bypass User Account Control </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/003/" class="subtechnique-table-item" data-subtechnique_id="T1548.003"> T1548.003 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/003/" class="subtechnique-table-item" data-subtechnique_id="T1548.003"> Sudo and Sudo Caching </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/004/" class="subtechnique-table-item" data-subtechnique_id="T1548.004"> T1548.004 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/004/" class="subtechnique-table-item" data-subtechnique_id="T1548.004"> Elevated Execution with Prompt </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/005/" class="subtechnique-table-item" data-subtechnique_id="T1548.005"> T1548.005 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/005/" class="subtechnique-table-item" data-subtechnique_id="T1548.005"> Temporary Elevated Cloud Access </a>
                                                                    </td>
                                                            </tr>
                                                            <tr>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/006/" class="subtechnique-table-item" data-subtechnique_id="T1548.006"> T1548.006 </a>
                                                                    </td>
                                                                    <td>
                                                                        <a href="/versions/v16/techniques/T1548/006/" class="subtechnique-table-item" data-subtechnique_id="T1548.006"> TCC Manipulation </a>
                                                                    </td>
                                                            </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <!--start-indexing-for-search-->

                                    <div class="description-body">
                                                <p>Adversaries may circumvent mechanisms designed to control elevate privileges to gain higher-level permissions. Most modern systems contain native elevation control mechanisms that are intended to limit privileges that a user can perform on a machine. Authorization has to be granted to specific users in order to perform tasks that can be considered of higher risk.<span onclick=scrollToRef('scite-1') id="scite-ref-1-a" class="scite-citeref-number" title="Lich, B. (2016, May 31). How User Account Control Works. Retrieved June 3, 2016."data-reference="TechNet How UAC Works"><sup><a href="https://technet.microsoft.com/en-us/itpro/windows/keep-secure/how-user-account-control-works" target="_blank" data-hasqtip="0" aria-describedby="qtip-0">[1]</a></sup></span><span onclick=scrollToRef('scite-2') id="scite-ref-2-a" class="scite-citeref-number" title="Todd C. Miller. (2018). Sudo Man Page. Retrieved March 19, 2018."data-reference="sudo man page 2018"><sup><a href="https://www.sudo.ws/" target="_blank" data-hasqtip="1" aria-describedby="qtip-1">[2]</a></sup></span> An adversary can perform several methods to take advantage of built-in control mechanisms in order to escalate privileges on a system.<span onclick=scrollToRef('scite-3') id="scite-ref-3-a" class="scite-citeref-number" title="Marc-Etienne M.Leveille. (2016, July 6). New OSX/Keydnap malware is hungry for credentials. Retrieved July 3, 2017."data-reference="OSX Keydnap malware"><sup><a href="https://www.welivesecurity.com/2016/07/06/new-osxkeydnap-malware-hungry-credentials/" target="_blank" data-hasqtip="2" aria-describedby="qtip-2">[3]</a></sup></span><span onclick=scrollToRef('scite-4') id="scite-ref-4-a" class="scite-citeref-number" title="Salvio, J., Joven, R. (2016, December 16). Malicious Macro Bypasses UAC to Elevate Privilege for Fareit Malware. Retrieved December 27, 2016."data-reference="Fortinet Fareit"><sup><a href="https://blog.fortinet.com/2016/12/16/malicious-macro-bypasses-uac-to-elevate-privilege-for-fareit-malware" target="_blank" data-hasqtip="3" aria-describedby="qtip-3">[4]</a></sup></span></p>

                                    </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body">
                                            <div class="row card-data" id="card-id">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">ID:&nbsp;</span>T1548
                                                </div>
                                            </div>
                                        <!--stop-indexing-for-search-->
                                        <div class="row card-data">
                                            <div class="col-md-1 px-0 text-center"></div>
                                            <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Sub-techniques:&nbsp;</span>
                                                            <a href="/versions/v16/techniques/T1548/001">T1548.001</a>,                                                            <a href="/versions/v16/techniques/T1548/002">T1548.002</a>,                                                            <a href="/versions/v16/techniques/T1548/003">T1548.003</a>,                                                            <a href="/versions/v16/techniques/T1548/004">T1548.004</a>,                                                            <a href="/versions/v16/techniques/T1548/005">T1548.005</a>,                                                            <a href="/versions/v16/techniques/T1548/006">T1548.006</a>                                            </div>
                                        </div>
                                        <!--start-indexing-for-search-->
                                            <div id="card-tactics" class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="The tactic objectives that the (sub-)technique can be used to accomplish">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Tactics:</span>
                                                        <a href="/versions/v16/tactics/TA0004">Privilege Escalation</a>,                                                        <a href="/versions/v16/tactics/TA0005">Defense Evasion</a>                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="The system an adversary is operating within; could be an operating system or application">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Platforms:&nbsp;</span>IaaS, Identity Provider, Linux, Office Suite, Windows, macOS
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center">
                                                    <span data-toggle="tooltip" data-placement="left" title="" data-test-ignore="true" data-original-title="The lowest level of permissions the adversary is required to be operating within to perform the (sub-)technique on a system">&#9432;</span>
                                                </div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Permissions Required:&nbsp;</span>Administrator, User
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Version:&nbsp;</span>1.4
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Created:&nbsp;</span>30 January 2020
                                                </div>
                                            </div>
                                            <div class="row card-data">
                                                <div class="col-md-1 px-0 text-center"></div>
                                                <div class="col-md-11 pl-0">
                                                    <span class="h5 card-title">Last Modified:&nbsp;</span>15 October 2024
                                                </div>
                                            </div>
                                    </div>
                                </div>
                                    <div class="text-center pt-2 version-button permalink">
    <div class="live">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Permalink to this version of T1548" 
           href="/versions/v16/techniques/T1548/" data-test-ignore="true">Version Permalink</a>
    </div>
    <div class="permalink">
        <a data-toggle="tooltip" 
           data-placement="bottom" 
           title="Go to the live version of T1548" 
           href="/techniques/T1548/" data-test-ignore="true">Live Version</a><!--do not change this line without also changing versions.py-->
    </div>
</div>

                            </div>
                        </div>
                            <h2 class="pt-3" id ="examples">Procedure Examples</h2>
                            <div class="tables-mobile">
                            <table class="table table-bordered table-alternate mt-2">
                                <thead>
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">Name</th>
                                        <th scope="col">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                        <tr>
                                            <td>
                                                <a href="/versions/v16/software/S1130"> S1130 </a>
                                            </td>
                                            <td>
                                                <a href="/versions/v16/software/S1130"> Raspberry Robin </a>
                                            </td>
                                            <td>
                                                            <p><a href="/versions/v16/software/S1130">Raspberry Robin</a> implements a variation of the <code>ucmDccwCOMMethod</code> technique abusing the Windows AutoElevate backdoor to bypass UAC while elevating privileges.<span onclick=scrollToRef('scite-5') id="scite-ref-5-a" class="scite-citeref-number" title="Christopher So. (2022, December 20). Raspberry Robin Malware Targets Telecom, Governments. Retrieved May 17, 2024."data-reference="TrendMicro RaspberryRobin 2022"><sup><a href="https://www.trendmicro.com/en_us/research/22/l/raspberry-robin-malware-targets-telecom-governments.html" target="_blank" data-hasqtip="4" aria-describedby="qtip-4">[5]</a></sup></span></p>

                                            </td>
                                        </tr>
                                </tbody>
                            </table>
                            </div>
                            <h2 class="pt-3" id ="mitigations">Mitigations</h2>
                            <div class="tables-mobile">
                                <table class="table table-bordered table-alternate mt-2">
                                    <thead>
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Mitigation</th>
                                            <th scope="col">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1047"> M1047 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1047"> Audit </a>
                                                </td>
                                                <td>
                                                                <p>Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.<span onclick=scrollToRef('scite-6') id="scite-ref-6-a" class="scite-citeref-number" title="UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016."data-reference="Github UACMe"><sup><a href="https://github.com/hfiref0x/UACME" target="_blank" data-hasqtip="5" aria-describedby="qtip-5">[6]</a></sup></span></p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1038"> M1038 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1038"> Execution Prevention </a>
                                                </td>
                                                <td>
                                                                <p>System settings can prevent applications from running that haven't been downloaded from legitimate repositories which may help mitigate some of these issues. Not allowing unsigned applications from being run may also mitigate some risk.</p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1028"> M1028 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1028"> Operating System Configuration </a>
                                                </td>
                                                <td>
                                                                <p>Applications with known vulnerabilities or known shell escapes should not have the setuid or setgid bits set to reduce potential damage if an application is compromised. Additionally, the number of programs with setuid or setgid bits set should be minimized across a system. Ensuring that the sudo tty_tickets setting is enabled will prevent this leakage across tty sessions.</p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1026"> M1026 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1026"> Privileged Account Management </a>
                                                </td>
                                                <td>
                                                                <p>Remove users from the local administrator group on systems.</p><p>By requiring a password, even if an adversary can get terminal access, they must know the password to run anything in the sudoers file. Setting the timestamp_timeout to 0 will require the user to input their password every time sudo is executed.</p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1022"> M1022 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1022"> Restrict File and Directory Permissions </a>
                                                </td>
                                                <td>
                                                                <p>The sudoers file should be strictly edited such that passwords are always required and that users can't spawn risky processes as users with higher privilege.</p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1051"> M1051 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1051"> Update Software </a>
                                                </td>
                                                <td>
                                                                <p>Perform regular software updates to mitigate exploitation risk.</p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1052"> M1052 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1052"> User Account Control </a>
                                                </td>
                                                <td>
                                                                <p>Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as <a href="/versions/v16/techniques/T1574/001">DLL Search Order Hijacking</a>.</p>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1018"> M1018 </a>
                                                </td>
                                                <td>
                                                    <a href="/versions/v16/mitigations/M1018"> User Account Management </a>
                                                </td>
                                                <td>
                                                                <p>Limit the privileges of cloud accounts to assume, create, or impersonate additional roles, policies, and permissions to only those required. Where just-in-time access is enabled, consider requiring manual approval for temporary elevation of privileges.</p>

                                                </td>
                                            </tr>
                                    </tbody>
                                </table>
                                </div>
                            <h2 class="pt-3" id="detection">Detection</h2>
                                <div class="tables-mobile">
<table class="table datasources-table table-bordered">
    <thead>
        <tr>
            <th class="p-2" scope="col">ID</th>
            <th class="p-2 nowrap" scope="col">Data Source</th>
            <th class="p-2 nowrap" scope="col">Data Component</th>
            <th class="p-2" scope="col">Detects</th>
        </tr>
    </thead>
    <tbody>
            <tr class="datasource" id="uses-DS0017">
                <td>
                    <a href="/versions/v16/datasources/DS0017">DS0017</a>
                </td>
                <td class="nowrap">
                    <a href="/versions/v16/datasources/DS0017">Command</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0017/#Command%20Execution">Command Execution</a>
                </td>
                    <td>
                                <p>Monitor executed commands and arguments that may circumvent mechanisms designed to control elevate privileges to gain higher-level permissions.</p>

                    </td>
            </tr>
            <tr class="datasource" id="uses-DS0022">
                <td>
                    <a href="/versions/v16/datasources/DS0022">DS0022</a>
                </td>
                <td class="nowrap">
                    <a href="/versions/v16/datasources/DS0022">File</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0022/#File%20Metadata">File Metadata</a>
                </td>
                    <td>
                                <p>Monitor the file system for files that have the setuid or setgid bits set. On Linux, auditd can alert every time a user's actual ID and effective ID are different (this is what happens when you sudo).</p>

                    </td>
            </tr>
                    <tr class="datacomponent datasource" id="uses-DS0022-File Modification">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/datasources/DS0022/#File%20Modification">File Modification</a>
                        </td>
                            <td>
                                        <p>On Linux, auditd can alert every time a user's actual ID and effective ID are different (this is what happens when you sudo). This technique is abusing normal functionality in macOS and Linux systems, but sudo has the ability to log all input and output based on the <code>LOG_INPUT</code> and <code>LOG_OUTPUT</code> directives in the <code>/etc/sudoers</code> file. Consider monitoring for <code>/usr/libexec/security_authtrampoline</code> executions which may indicate that AuthorizationExecuteWithPrivileges is being executed. MacOS system logs may also indicate when AuthorizationExecuteWithPrivileges is being called.</p>

                            </td>
                    </tr>
            <tr class="datasource" id="uses-DS0009">
                <td>
                    <a href="/versions/v16/datasources/DS0009">DS0009</a>
                </td>
                <td class="nowrap">
                    <a href="/versions/v16/datasources/DS0009">Process</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0009/#OS%20API%20Execution">OS API Execution</a>
                </td>
                    <td>
                                <p>Also look for any process API calls for behavior that may be indicative of <a href="/versions/v16/techniques/T1055">Process Injection</a>. Monitoring OS API callbacks for the execution can also be a way to detect this behavior but requires specialized security tooling.</p>

                    </td>
            </tr>
                    <tr class="datacomponent datasource" id="uses-DS0009-Process Creation">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/datasources/DS0009/#Process%20Creation">Process Creation</a>
                        </td>
                            <td>
                                        <p>Monitor for newly executed processes that may circumvent mechanisms designed to control elevate privileges to gain higher-level permissions. Cyber actors frequently escalate to the SYSTEM account after gaining entry to a Windows host, to enable them to carry out various attacks more effectively. Tools such as Meterpreter, Cobalt Strike, and Empire carry out automated steps to "Get System", which is the same as switching over to the System user account. Most of these tools utilize multiple techniques to try and attain SYSTEM: in the first technique, they create a named pipe and connects an instance of cmd.exe to it, which allows them to impersonate the security context of cmd.exe, which is SYSTEM. In the second technique, a malicious DLL is injected into a process that is running as SYSTEM; the injected DLL steals the SYSTEM token and applies it where necessary to escalate privileges. This analytic looks for both of these techniques.</p><p>Analytic 1 - Get System Elevation</p><p><code>(source="<em>WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="</em>WinEventLog:Security" EventCode="4688")(ParentImage="C:\Windows\System32\services.exe" Image="C:\Windows\System32\cmd.exe"  CommandLine="<em>echo</em>" CommandLine="<em>\pipe*") OR (Image="C:\Windows\System32\rundll32.exe" CommandLine="</em>,a /p:*")</code></p>

                            </td>
                    </tr>
                    <tr class="datacomponent datasource" id="uses-DS0009-Process Metadata">
                        <td></td>
                        <td></td>
                        <td>
                            <a href="/datasources/DS0009/#Process%20Metadata">Process Metadata</a>
                        </td>
                            <td>
                                        <p>Monitor contextual data about a running process, which may include information such as environment variables, image name, user/owner that may circumvent mechanisms designed to control elevate privileges to gain higher-level permissions.</p>

                            </td>
                    </tr>
            <tr class="datasource" id="uses-DS0002">
                <td>
                    <a href="/versions/v16/datasources/DS0002">DS0002</a>
                </td>
                <td class="nowrap">
                    <a href="/versions/v16/datasources/DS0002">User Account</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0002/#User%20Account%20Modification">User Account Modification</a>
                </td>
                    <td>
                                <p>Log cloud API calls to assume, create, or impersonate additional roles, policies, and permissions. Review uses of just-in-time access to ensure that any justifications provided are valid and only expected actions were taken.</p>

                    </td>
            </tr>
            <tr class="datasource" id="uses-DS0024">
                <td>
                    <a href="/versions/v16/datasources/DS0024">DS0024</a>
                </td>
                <td class="nowrap">
                    <a href="/versions/v16/datasources/DS0024">Windows Registry</a>
                </td>
                <!-- Add first data component here -->
                <td> 
                    <a href="/datasources/DS0024/#Windows%20Registry%20Key%20Modification">Windows Registry Key Modification</a>
                </td>
                    <td>
                                <p>There are many ways to perform UAC bypasses when a user is in the local administrator group on a system, so it may be difficult to target detection on all variations. Efforts should likely be placed on mitigation and collecting enough information on process launches and actions that could be performed before and after a UAC bypass is performed. Some UAC bypass methods rely on modifying specific, user-accessible Registry settings. Analysts should monitor Registry settings for unauthorized changes.</p>

                    </td>
            </tr>
    </tbody>
</table>
</div>


                            <h2 class="pt-3" id="references">References</h2>

        <div class="row">
            <div class="col">
                <ol>
                            
        <li>
            <span  id="scite-1" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-1" href="https://technet.microsoft.com/en-us/itpro/windows/keep-secure/how-user-account-control-works" target="_blank">
                        Lich, B. (2016, May 31). How User Account Control Works. Retrieved June 3, 2016.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-2" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-2" href="https://www.sudo.ws/" target="_blank">
                        Todd C. Miller. (2018). Sudo Man Page. Retrieved March 19, 2018.
                    </a>
                </span>
            </span>
        </li>


                            
        <li>
            <span  id="scite-3" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-3" href="https://www.welivesecurity.com/2016/07/06/new-osxkeydnap-malware-hungry-credentials/" target="_blank">
                        Marc-Etienne M.Leveille. (2016, July 6). New OSX/Keydnap malware is hungry for credentials. Retrieved July 3, 2017.
                    </a>
                </span>
            </span>
        </li>


                </ol>
            </div>
            <div class="col">
                    <ol start="4.0">
                                
        <li>
            <span  id="scite-4" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-4" href="https://blog.fortinet.com/2016/12/16/malicious-macro-bypasses-uac-to-elevate-privilege-for-fareit-malware" target="_blank">
                        Salvio, J., Joven, R. (2016, December 16). Malicious Macro Bypasses UAC to Elevate Privilege for Fareit Malware. Retrieved December 27, 2016.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-5" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-5" href="https://www.trendmicro.com/en_us/research/22/l/raspberry-robin-malware-targets-telecom-governments.html" target="_blank">
                        Christopher So. (2022, December 20). Raspberry Robin Malware Targets Telecom, Governments. Retrieved May 17, 2024.
                    </a>
                </span>
            </span>
        </li>


                                
        <li>
            <span  id="scite-6" class="scite-citation">
                <span class="scite-citation-text">
                    <a rel="nofollow" class="external text" name="scite-6" href="https://github.com/hfiref0x/UACME" target="_blank">
                        UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016.
                    </a>
                </span>
            </span>
        </li>


  
                    </ol>
            </div>             
        </div>


                </div>
            </div>
        </div>
    </div>
    
        </div>
    </div>

            <!--stop-indexing-for-search-->
            <!-- search overlay for entire page -- not displayed inline -->
            <div class="overlay search" id="search-overlay" style="display: none;">
    <div class="overlay-inner">
        <!-- text input for searching -->
        <div class="search-header">
            <div class="search-input">
                <input type="text" id="search-input" placeholder="search">
            </div>
            <div class="search-icons">
                <div class="search-parsing-icon spinner-border" style="display: none" id="search-parsing-icon"></div>
                <div class="close-search-icon" id="close-search-icon">&times;</div>
            </div>
        </div>
        <!-- results and controls for loading more results -->
        <div id="search-body" class="search-body">
            <div class="results" id="search-results">
                <!-- content will be appended here on search -->
            </div>
            <div id="load-more-results" class="load-more-results">
                <button class="btn btn-default" id="load-more-results-button">load more results</button>
            </div>
        </div>
    </div>
</div>

        </div>
        <div class="row flex-grow-0 flex-shrink-1">
            <!-- footer elements -->
            <footer class="col footer">
                <div class="container-fluid">
                    <div class="row row-footer">
                        <div class="col-2 col-sm-2 col-md-2">
                            <div class="footer-center-responsive my-auto">
                                <a href="https://www.mitre.org" target="_blank" rel="noopener" aria-label="MITRE">
                                    <img src="/versions/v16/theme/images/mitrelogowhiteontrans.gif" class="mitre-logo-wtrans">
                                </a>
                            </div>
                        </div>
                        <div class="col-2 col-sm-2 footer-responsive-break"></div>
                        <div class="footer-link-group">
                            <div class="row row-footer">
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/versions/v16/resources/engage-with-attack/contact" class="footer-link">Contact Us</a></u>
                                </div>
                                <div class="px-3 col-footer">
                                    <u class="footer-link"><a href="/versions/v16/resources/legal-and-branding/terms-of-use" class="footer-link">Terms of Use</a></u>
                                </div>
                                    <div class="px-3 col-footer">
                                        <u class="footer-link"><a href="/versions/v16/resources/legal-and-branding/privacy" class="footer-link">Privacy Policy</a></u>
                                    </div>
                                <div class="px-3">
                                    <u class="footer-link"><a href="/versions/v16/resources/changelog.html" class="footer-link" data-toggle="tooltip" data-placement="top" data-html="true" title="ATT&amp;CK content v16.1&#013;Website  v4.2.1">Website Changelog</a></u>
                                </div>
                            </div>
                            <div class="row">
                                <small class="px-3">
                                    &copy;&nbsp;2015&nbsp;-&nbsp;2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.
                                </small>
                            </div>
                        </div>
                        <div class="w-100 p-2 footer-responsive-break"></div>
                            <div class="col pr-4">
                                <div class="footer-float-right-responsive-brand">
                                    <div class="row row-footer row-footer-icon">
                                        <div class="mb-1">
                                            <a href="https://twitter.com/MITREattack" class="btn btn-footer">
                                                <i class="fa-brands fa-x-twitter fa-lg"></i>
                                            </a>
                                            <a href="https://github.com/mitre-attack" class="btn btn-footer">
                                                <i class="fa-brands fa-github fa-lg"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>


<!--stopindex-->

</div>
    <!--SCRIPTS-->
    <script src="/versions/v16/theme/scripts/jquery-3.5.1.min.js"></script>
    <script src="/versions/v16/theme/scripts/popper.min.js"></script>
    <script src="/versions/v16/theme/scripts/bootstrap-select.min.js"></script>
    <script src="/versions/v16/theme/scripts/bootstrap.bundle.min.js"></script>
    <script src="/versions/v16/theme/scripts/site.js"></script>
    <script src="/versions/v16/theme/scripts/settings.js"></script>
    <script src="/versions/v16/theme/scripts/search_bundle.js"></script>

<!--SCRIPTS-->
<script src="/versions/v16/theme/scripts/resizer.js"></script>

<!--SCRIPTS-->
<script src="/versions/v16/theme/scripts/bootstrap-tourist.js"></script>
<script src="/versions/v16/theme/scripts/settings.js"></script>
    <script src="/versions/v16/theme/scripts/tour/tour-techniques.js"></script>
<script src="/versions/v16/theme/scripts/sidebar-load-all.js"></script>
</body>
</html>